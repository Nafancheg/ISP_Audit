# –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ISP_Audit v2

**–î–∞—Ç–∞**: 09.12.2025 (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 10.12.2025, 17.12.2025)  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞**: .NET 9, WPF  
**–†–µ–∂–∏–º**: GUI-only (WinExe)  

---

## 1. –ö–∞—Ä—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞

### 1.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –¢–û–ß–ö–ê –í–•–û–î–ê                               ‚îÇ
‚îÇ                       Program.cs                                 ‚îÇ
‚îÇ              ‚Üì Config.SetActiveProfile("Default")               ‚îÇ
‚îÇ              ‚Üì new App().Run()                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     UI LAYER (WPF)                              ‚îÇ
‚îÇ  App.xaml ‚Üí MainWindow.xaml ‚Üí MainViewModelRefactored           ‚îÇ
‚îÇ                              ‚Üì                                  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BypassController (–ø—Ä–æ–∫—Å–∏ –∫ BypassStateManager)            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ DiagnosticOrchestrator (–∑–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)               ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ TestResultsManager (UI –∫–æ–ª–ª–µ–∫—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   ORCHESTRATION LAYER                           ‚îÇ
‚îÇ              DiagnosticOrchestrator                             ‚îÇ
‚îÇ                              ‚Üì                                  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ TrafficCollector (—Å–±–æ—Ä —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ LiveTestingPipeline (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö–æ—Å—Ç–æ–≤)                 ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BypassStateManager (SSoT –¥–ª—è bypass/engine)               ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ TrafficEngine (WinDivert bypass)                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     CORE LAYER                                  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/Modules/StandardHostTester                            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/IntelligenceV2/Diagnosis/StandardDiagnosisEngineV2     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/Modules/InMemoryBlockageStateStore                    ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/Modules/TcpRetransmissionTracker                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/Modules/HttpRedirectDetector                         ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/Modules/RstInspectionService                         ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Core/Modules/UdpInspectionService                         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Core/Traffic/TrafficEngine + Filters                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    SERVICES LAYER                               ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ ConnectionMonitorService (WinDivert Socket/Polling)       ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ DnsParserService (SNI/DNS –ø–∞—Ä—Å–∏–Ω–≥; –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–µ—à–∏ DNS/SNI; SNI —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–µ–∞—Å—Å–µ–º–±–ª–∏–Ω–≥–æ–º ClientHello) ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ PidTrackerService (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ PID)                      ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ TcpConnectionWatcher (IP Helper API polling)              ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ NoiseHostFilter (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —à—É–º–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤)                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ FixService (DNS fix —á–µ—Ä–µ–∑ netsh)                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    BYPASS LAYER                                 ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BypassCoordinator (–≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)                       ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ TlsBypassService (–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ü–∏–π/–ø—Ä–µ—Å–µ—Ç–æ–≤, —Å–æ–±—ã—Ç–∏—è –º–µ—Ç—Ä–∏–∫)‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BypassFilter (TLS fragment/disorder/fake, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ–º—ã–µ ‚îÇ
‚îÇ      —Ä–∞–∑–º–µ—Ä—ã)                                                  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BypassProfile (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)                              ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ StrategyMapping (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Üí —Å—Ç—Ä–∞—Ç–µ–≥–∏—è)                  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ WinDivertNative (P/Invoke)                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
* –ü–∞–Ω–µ–ª—å Bypass Control –≤ UI: —Ç—É–º–±–ª–µ—Ä—ã Fragment/Disorder/Fake/Drop RST/DoH, –±–µ–π–¥–∂ —Å—Ç–∞—Ç—É—Å–∞/latency, –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø—Ä–µ—Å–µ—Ç–æ–≤ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç/—É–º–µ—Ä–µ–Ω–Ω—ã–π/–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π) –∏ –º–µ—Ç—Ä–∏–∫–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏/RST.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Runtime, 26.12.2025): –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–∫–∞—Ç —Å QUIC –Ω–∞ TCP –¥–ª—è v2
- TLS-–æ–±—Ö–æ–¥ –≤ `BypassFilter` –ø—Ä–∏–º–µ–Ω–∏–º —Ç–æ–ª—å–∫–æ –∫ TCP-—Ç—Ä–∞—Ñ–∏–∫—É (ClientHello –Ω–∞ 443). YouTube –∏ –º–Ω–æ–≥–∏–µ —Å–∞–π—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç QUIC/HTTP3 (UDP/443), –ø–æ—ç—Ç–æ–º—É ¬´TLS —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã, –∞ —Å–∞–π—Ç –Ω–µ –æ–∂–∏–≤–∞–µ—Ç¬ª –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ç–æ —Ç–µ–º, —á—Ç–æ —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ TCP. –î–ª—è —ç—Ç–æ–≥–æ –µ—Å—Ç—å —è–≤–Ω—ã–π —Ñ–ª–∞–≥ `DropUdp443` (—Ç—É–º–±–ª–µ—Ä `QUIC‚ÜíTCP`), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∫–ª–∏–µ–Ω—Ç –Ω–∞ TCP/HTTPS.
- –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º `DropUdp443` UDP/443 –ø–æ–¥–∞–≤–ª—è–µ—Ç—Å—è **—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ** (–ø–æ observed IPv4 –∞–¥—Ä–µ—Å–∞–º —Ü–µ–ª–∏): `BypassStateManager` –¥–µ—Ä–∂–∏—Ç –∫—ç—à IP —Ü–µ–ª–∏ —Å TTL/cap (cold-start —á–µ—Ä–µ–∑ DNS resolve host) –∏ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç –µ–≥–æ –≤ `TlsBypassService`, –∞ `BypassFilter` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç `Udp443Dropped++` –∏ –¥—Ä–æ–ø–∞–µ—Ç —Ç–æ–ª—å–∫–æ UDP/443 –∫ —ç—Ç–∏–º IP. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –Ω–∞–∑–≤–∞–Ω–∏—é –ø—Ä–µ—Å–µ—Ç–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.
- –ú–µ—Ç—Ä–∏–∫–∞ `Udp443Dropped` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ bypass-–ø–∞–Ω–µ–ª–∏ –∏ –ø–æ–º–æ–≥–∞–µ—Ç –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ QUIC –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≥–ª—É—à–∏—Ç—Å—è.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å —è–≤–Ω—ã–π assist-—Ñ–ª–∞–≥ `AllowNoSni` (—Ç—É–º–±–ª–µ—Ä `No SNI`): —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å TLS-–æ–±—Ö–æ–¥ –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ SNI (ECH/ESNI/—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è ClientHello).
- –í v2 –∫–æ–Ω—Ç—É—Ä–µ —ç—Ç–∏ assist-—Ñ–ª–∞–≥–∏ –º–æ–≥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –∫–∞–∫ —Ç–æ–∫–µ–Ω—ã `DROP_UDP_443` / `ALLOW_NO_SNI` –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Ä—É—á–Ω–æ–º `ApplyV2PlanAsync`.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Design Phase, 16.12.2025):
- –í–≤–µ–¥—ë–Ω –¥–∏–∑–∞–π–Ω-–ø–ª–∞–Ω ‚ÄúDPI Intelligence v2‚Äù –≤ docs/phase2_plan.md: —Å–ª–æ–π –º–µ–∂–¥—É –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π –∏ –æ–±—Ö–æ–¥–æ–º.
- –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ: —Å–∏–≥–Ω–∞–ª—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ **—Ü–µ–ø–æ—á–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏** (–Ω–µ —Ä–∞–∑–æ–≤—ã–π —Å–Ω–∏–º–æ–∫), –ø—Ä–∞–≤–∏–ª–∞ –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω–æ (—Å–Ω–∞—á–∞–ª–∞ —Ç–æ–ª—å–∫–æ –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–∞–Ω–Ω—ã–º).
- –í MVP –∑–∞–ø—Ä–µ—â—ë–Ω auto-apply: –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Runtime, 16.12.2025):
- Step 1 v2 Signals —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–∫–ª—é—á—ë–Ω: `SignalsAdapterV2` –ø–∏—à–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ `InMemorySignalSequenceStore` –Ω–∞ —ç—Ç–∞–ø–µ Classification –≤ `LiveTestingPipeline`. –î–ª—è v2-–≤–µ—Ç–∫–∏ –∏–Ω—Å–ø–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç—ã –±–µ—Ä—É—Ç—Å—è —á–µ—Ä–µ–∑ `IInspectionSignalsProvider` –≤ –≤–∏–¥–µ `InspectionSignalsSnapshot` (–±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç legacy `BlockageSignals`).
    - –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π: legacy-–æ–≤–µ—Ä–ª–æ–∞–¥—ã `SignalsAdapterV2` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `BlockageSignals` –∑–∞–ø—Ä–µ—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (`[Obsolete(..., error: true)]`).
    - –ï—Å—Ç—å –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–æ—Å—Ç–∞ –ø–∞–º—è—Ç–∏: debounce –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –∏ cap —á–∏—Å–ª–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞ HostKey (in-memory store).
    - –ü–æ–ª–∏—Ç–∏–∫–∞ DoH –≤ v2 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è: DoH –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–∏ "—á–∏—Å—Ç–æ–º DNS" –¥–∏–∞–≥–Ω–æ–∑–µ, –∞ —Ç–æ–ª—å–∫–æ –≤ multi-layer —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.
- Step 2 v2 Diagnosis –ø–æ–¥–∫–ª—é—á—ë–Ω: `StandardDiagnosisEngineV2` —Å—Ç–∞–≤–∏—Ç –¥–∏–∞–≥–Ω–æ–∑ –ø–æ `BlockageSignalsV2` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—è—Å–Ω–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Ñ–∞–∫—Ç–∞—Ö (DNS fail, TCP/TLS timeout, TLS auth failure, retx-rate, HTTP redirect, RST TTL/IPID delta + latency) –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º/–æ–±—Ö–æ–¥—É. –î–ª—è RST-–∫–µ–π—Å–æ–≤ DPI-id (`ActiveDpiEdge/StatefulDpi`) –≤—ã–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ —É–ª–∏–∫ (`SuspiciousRstCount >= 2`), —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª–æ–∂–Ω—É—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –µ–¥–∏–Ω–∏—á–Ω–æ–º—É —Å–æ–±—ã—Ç–∏—é. –î–ª—è TLS-only –∫–µ–π—Å–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –¥–∏–∞–≥–Ω–æ–∑ `TlsInterference`, —á—Ç–æ–±—ã —Å–µ–ª–µ–∫—Ç–æ—Ä –º–æ–≥ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞–Ω TLS-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π.
- Step 3 v2 Selector –ø–æ–¥–∫–ª—é—á—ë–Ω: `StandardStrategySelectorV2` —Å—Ç—Ä–æ–∏—Ç `BypassPlan` —Å—Ç—Ä–æ–≥–æ –ø–æ `DiagnosisResult` (id + confidence) –∏ –æ—Ç–¥–∞—ë—Ç –∫—Ä–∞—Ç–∫—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –¥–ª—è UI-–ª–æ–≥–∞ (–±–µ–∑ auto-apply).
- Step 4 v2 Executor (MVP) –ø–æ–¥–∫–ª—é—á—ë–Ω: `BypassExecutorMvp` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, —á–∏—Ç–∞–µ–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—ã–≤–æ–¥ (–¥–∏–∞–≥–Ω–æ–∑ + —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å + 1 –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ + —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π) –∏ **–Ω–µ** –ø—Ä–∏–º–µ–Ω—è–µ—Ç –æ–±—Ö–æ–¥.
- –†–µ–∞–ª—å–Ω—ã–π executor v2 (—Ä—É—á–Ω–æ–π apply, –±–µ–∑ auto-apply): `LiveTestingPipeline` –ø—É–±–ª–∏–∫—É–µ—Ç –æ–±—ä–µ–∫—Ç–Ω—ã–π `BypassPlan` —á–µ—Ä–µ–∑ `OnV2PlanBuilt`, `DiagnosticOrchestrator` —Ö—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–ª–∞–Ω –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –µ–≥–æ —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `BypassController.ApplyV2PlanAsync(...)` (—Ç–∞–π–º–∞—É—Ç/–æ—Ç–º–µ–Ω–∞/–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ—Ç–∫–∞—Ç).

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Runtime, 29.12.2025): Bypass State Manager (2.V2.12)
- –í–≤–µ–¥—ë–Ω `BypassStateManager` –∫–∞–∫ single source of truth –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è `TrafficEngine` –∏ `TlsBypassService`.
- –î–æ–±–∞–≤–ª–µ–Ω fail-safe —Å–ª–æ–π (Lite Watchdog + crash recovery): –∂—É—Ä–Ω–∞–ª —Å–µ—Å—Å–∏–∏ bypass + –∞–≤—Ç–æ-Disable –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏/–ø—Ä–æ–ø–∞–∂–µ heartbeat.
- –î–æ–±–∞–≤–ª–µ–Ω–∞ Activation Detection (–ø–æ –º–µ—Ç—Ä–∏–∫–∞–º): —Å—Ç–∞—Ç—É—Å `ENGINE_DEAD/NOT_ACTIVATED/ACTIVATED/NO_TRAFFIC/UNKNOWN` –¥–ª—è –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏.
- –î–æ–±–∞–≤–ª–µ–Ω Outcome Check –¥–ª—è HTTPS: `SUCCESS/FAILED/UNKNOWN` —á–µ—Ä–µ–∑ tagged outcome-probe (–∞–∫—Ç–∏–≤–Ω–∞—è TCP+TLS+HTTP –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–∏), probe –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫ (smoke gate: `DPI2-029`).
- P0.6 –°–º–µ–Ω–∞ —Å–µ—Ç–∏: –ø—Ä–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏ —Å–º–µ–Ω—ã —Å–µ—Ç–∏ UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å/–û—Ç–∫–ª—é—á–∏—Ç—å/–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å¬ª. ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç staged revalidation (Activation ‚Üí Outcome) –∏ –∑–∞—Ç–µ–º –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É (–±–µ–∑ auto-apply; smoke gate: `UI-013`).
- `BypassController` –∏ `DiagnosticOrchestrator` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –≥–æ–Ω–∫–∏ Apply/Disable –∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–æ–≤/engine.
- –î–æ–±–∞–≤–ª–µ–Ω guard: –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –º–µ—Ç–æ–¥–æ–≤ `TrafficEngine`/`TlsBypassService` –≤–Ω–µ manager-scope –ª–æ–≥–∏—Ä—É—é—Ç—Å—è (–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã smoke-–≥–µ–π—Ç–∞–º–∏).


–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Runtime, 23.12.2025): –∫–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è v2
- `Cancel` –æ—Ç–º–µ–Ω—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É, –Ω–æ –∏ —Ä—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–æ—Ç–¥–µ–ª—å–Ω—ã–π CTS –¥–ª—è apply).
- –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ –ø–ª–∞–Ω–∞: apply –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –µ—Å–ª–∏ `planHostKey` –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π v2‚Äë—Ü–µ–ª—å—é, –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–π –∏–∑ —Ç–µ–∫—Å—Ç–∞ v2‚Äë–¥–∏–∞–≥–Ω–æ–∑–∞ –≤ UI.
- UX-–≥–µ–π—Ç –∫–Ω–æ–ø–∫–∏ apply: –±–ª–æ–∫ ¬´–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ `HasAnyRecommendations`, –Ω–æ –∫–æ–º–∞–Ω–¥–∞ apply –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `HasRecommendations` (–µ—Å—Ç—å –ø–ª–∞–Ω –∏ –µ—Å—Ç—å —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å). –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≤–∫–ª—é—á–∏–ª —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—Ä—É—á–Ω—É—é, –æ–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ ¬´—Ä—É—á–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ¬ª, —á—Ç–æ–±—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–µ –∏—Å—á–µ–∑–∞–ª–∏.
- –í–∞–∂–Ω–æ: bypass-–ø–∞–Ω–µ–ª—å –≤ UI —Å–∫—Ä—ã—Ç–∞ –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –ø–æ—ç—Ç–æ–º—É –∫–Ω–æ–ø–∫–∞ apply —Ç–∞–∫–∂–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –±–µ–∑ elevation.
- –†—É—á–Ω–æ–π apply –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `AggressiveFragment`: –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–µ—Å–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ ¬´–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π¬ª –∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è `AutoAdjustAggressive`.
- –†—É—á–Ω–æ–π apply –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `TlsFragment` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `TlsFragmentSizes`, `PresetName`, `AutoAdjustAggressive`); –ø–∞—Ä—Å–∏–Ω–≥ –≤—ã–Ω–µ—Å–µ–Ω –≤ `Core/IntelligenceV2/Execution/TlsFragmentPlanParamsParser.cs`.
- –î–æ–±–∞–≤–ª–µ–Ω smoke-—Ç–µ—Å—Ç `DPI2-022`: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `TlsFragment` –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–µ—Å–µ—Ç –∏ —Ñ–ª–∞–≥ `AutoAdjustAggressive`.
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º: `StandardStrategySelectorV2` –∑–∞–¥–∞—ë—Ç `TlsFragmentSizes` –≤ `BypassPlan` (–∏–Ω–∞—á–µ executor –∑–∞–≤–∏—Å–µ–ª –±—ã –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ—Å–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
- –î–æ–±–∞–≤–ª–µ–Ω smoke-—Ç–µ—Å—Ç `DPI2-023`: —Å–µ–ª–µ–∫—Ç–æ—Ä v2 –∫–ª–∞–¥—ë—Ç `TlsFragmentSizes` –≤ –ø–ª–∞–Ω.
- –î–æ–±–∞–≤–ª–µ–Ω smoke-—Ç–µ—Å—Ç `DPI2-024`: e2e –ø—Ä–æ–≤–µ—Ä–∫–∞ `selector ‚Üí plan ‚Üí ApplyV2PlanAsync` (manual apply –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞–Ω–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ).
- –î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è Gate 1‚Üí2 –≤ UI-–ª–æ–≥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[V2][GATE1]` (–Ω–µ —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ HostKey).

---

## –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é v2 (As‚ÄëIs / Target / Roadmap)

–ß—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ç—Ä–∏ –≤–µ—â–∏:

### As‚ÄëIs (—Ä–µ–∞–ª—å–Ω–æ –µ—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
- v2 –∫–æ–Ω—Ç—É—Ä –ø–æ–¥–∫–ª—é—á—ë–Ω –≤ —Ä–∞–Ω—Ç–∞–π–º: Signals ‚Üí Diagnosis ‚Üí Selector ‚Üí Plan.
- Auto-apply –∑–∞–ø—Ä–µ—â—ë–Ω: –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ —Ä—É—á–Ω–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (manual apply).
- –†–µ–∞–ª—å–Ω—ã–π apply v2 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `BypassController.ApplyV2PlanAsync(...)`: —Ç–∞–π–º–∞—É—Ç/–æ—Ç–º–µ–Ω–∞ + –±–µ–∑–æ–ø–∞—Å–Ω—ã–π rollback.
- Feedback store (MVP) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `StandardStrategySelectorV2`.

### Target (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ü–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–µ–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã –∏ –∏—Å–ø–æ–ª–Ω–∏–º—ã: –æ–¥–∏–Ω —Ä–µ–∂–∏–º TLS-–æ–±—Ö–æ–¥–∞ –∑–∞ —Ä–∞–∑.
- –ü–æ–Ω—è—Ç–Ω—ã–π UX: ¬´—á—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ ‚Üí –ø–æ—á–µ–º—É ‚Üí —á—Ç–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è ‚Üí —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –ø–æ—Å–ª–µ apply¬ª.
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –Ω–∏–∫–∞–∫–æ–≥–æ —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö/–æ—Ç–º–µ–Ω–µ.

### Roadmap (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–µ —à–∞–≥–∏)
1) –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å UX-—Å–º—ã—Å–ª —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤ (Fragment vs Disorder –∏ —Ç.–¥.).
2) –£—Å–∏–ª–∏—Ç—å UI-–æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –ø–æ—Å–ª–µ apply/rollback (–ª–æ–≥ + –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤).
3) –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω—ã –≤ –¥–≤–∏–∂–∫–µ (–±–µ–∑ "–º–∞–≥–∏—á–µ—Å–∫–æ–π" –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ñ–ª–∞–≥–æ–≤).

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 12.01.2026): –±–∞–∑–æ–≤—ã–µ analyzers/–ª–∏–Ω—Ç –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã `Directory.Build.props` –∏ `.editorconfig`.
- –í–∫–ª—é—á–µ–Ω—ã –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ .NET analyzers (`EnableNETAnalyzers=true`) –±–µ–∑ —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–∏—è `AnalysisMode/AnalysisLevel` (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç—ã SDK, —á—Ç–æ–±—ã –Ω–µ —Ä–∞–∑–¥—É–≤–∞—Ç—å —à—É–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π).
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é analyzers –≤—ã—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ `suggestion` (–º–∏–Ω–∏–º—É–º —à—É–º–∞).
- –î–ª—è non-UI —Å–ª–æ—ë–≤ –ø–æ–¥–Ω—è—Ç—ã –¥–æ `warning` –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏: `CA2000` (dispose) –∏ `CA2200` (rethrow). `CA2007` (ConfigureAwait) –æ—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ `suggestion`.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Runtime, 17.12.2025):
- –î–æ–±–∞–≤–ª–µ–Ω `Core/Diagnostics/BlockageCode.cs` ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–æ–≤ –ø—Ä–æ–±–ª–µ–º (`BlockageType`) –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ legacy –∞–ª–∏–∞—Å–æ–≤.
- –í –º–µ—Å—Ç–∞—Ö, –≥–¥–µ —Ä–∞–Ω—å—à–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å —Å—Ç—Ä–æ–∫–∏ (`TLS_DPI`, `TCP_TIMEOUT`, `TCP_RST`, `TLS_TIMEOUT` –∏ –¥—Ä.), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `BlockageCode.Normalize/ContainsCode`, —á—Ç–æ–±—ã –∞–ª–∏–∞—Å—ã –Ω–µ —Ä–∞—Å–ø–æ–ª–∑–∞–ª–∏—Å—å –ø–æ —Å–ª–æ—è–º (UI/legacy/v2).
- –î–æ–±–∞–≤–ª–µ–Ω `Core/Diagnostics/PipelineContract.cs` ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞ (`BypassNone`/`BypassUnknown`) –≤–º–µ—Å—Ç–æ ¬´–º–∞–≥–∏—á–µ—Å–∫–∏—Ö¬ª `"NONE"`/`"UNKNOWN"` –≤ —Å–ª–æ—è—Ö legacy/v2/UI.
- –î–æ–±–∞–≤–ª–µ–Ω –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π health-–ª–æ–≥ –ø–∞–π–ø–ª–∞–π–Ω–∞ (`[PipelineHealth] ...`) —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—á—ë—Ç—á–∏–∫–∞–º–∏ —ç—Ç–∞–ø–æ–≤ (enqueue/test/classify/ui) –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–æ—Ç–µ—Ä—å –¥–∞–Ω–Ω—ã—Ö –∏ —É–∑–∫–∏—Ö –º–µ—Å—Ç (—Ä–æ—Å—Ç –æ—á–µ—Ä–µ–¥–µ–π, drop –≤ bounded channels, –Ω–µ—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å enq/deq).
- –£—Ç–æ—á–Ω–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ noise-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: `NoiseHostFilter` –Ω–µ –¥–æ–ª–∂–µ–Ω –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–≤–∫–ª—é—á–∞—è SNI) –¥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏; ¬´noise¬ª –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö (OK) —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–∞–∂–Ω—ã–µ —Ñ–∞–∫—Ç—ã.

–ú–∞—Ä–∫–µ—Ä (–∫–∞–∫ –æ—Ç–ª–∏—á–∏—Ç—å v2-–≤—ã–≤–æ–¥ –æ—Ç legacy): —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π v2 –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞ `[V2]`.

–ñ—ë—Å—Ç–∫–∏–µ –∑–∞—â–∏—Ç—ã —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ (MVP):
- `confidence < 50` ‚Üí –ø—É—Å—Ç–æ–π –ø–ª–∞–Ω.
- `RiskLevel.High` –∑–∞–ø—Ä–µ—â—ë–Ω –ø—Ä–∏ `confidence < 70`.
- –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: warning + skip (–±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π), –±–µ–∑ –ø–∞–¥–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 22.12.2025): feedback store + —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ StrategySelector
- –î–æ–±–∞–≤–ª–µ–Ω `Core/IntelligenceV2/Feedback/*`: MVP-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (in-memory) + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `JsonFileFeedbackStoreV2`.
- `StandardStrategySelectorV2` —É–º–µ–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–æ–±–∞–≤–ª—è—Ç—å –≤–µ—Å –ø–æ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ **–ø–æ–≤–µ—Ä—Ö** hardcoded `BasePriority`.
- Gate: –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–∞–∫ —Ä–∞–Ω—å—à–µ; –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤—Ö–æ–¥ + –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π feedback ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–ª–∞–Ω.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (UI/–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ö–æ—Å—Ç–æ–≤): –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ **—á–µ–ª–æ–≤–µ–∫–æ‚Äë–ø–æ–Ω—è—Ç–Ω–æ–º—É –∫–ª—é—á—É** (–≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å SNI/hostname, –µ—Å–ª–∏ –æ–Ω –∏–∑–≤–µ—Å—Ç–µ–Ω). IP —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—Ç—Ä–∏–±—É—Ç (`FallbackIp`) –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, –Ω–æ –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–ª–∞–≤–Ω—ã–º ¬´–ª–∏—Ü–æ–º¬ª –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 18.12.2025): –¥–æ–±–∞–≤–ª–µ–Ω smoke-—Ç–µ—Å—Ç UI-—Ä–µ–¥—å—é—Å–µ—Ä–∞ (–±–µ–∑ –∑–∞–ø—É—Å–∫–∞ GUI)
- –¶–µ–ª—å: –±—ã—Å—Ç—Ä–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ UI –≤–µ–¥—ë—Ç —Å–µ–±—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ `IP ‚Üí hostname/SNI` –∏ —á—Ç–æ –ø—Ä–∞–≤–∏–ª–æ ‚Äú—Å–º–µ—à–∞–Ω–Ω—ã–µ –∏—Å—Ö–æ–¥—ã ‚Üí –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ‚Äù –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –∏–∑‚Äë–∑–∞ —Å–º–µ–Ω—ã –∫–ª—é—á–∞.
- –ö–æ–º–∞–Ω–¥–∞:
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --ui-reducer-smoke`
- –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
    - –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—é `[Collector] Hostname –æ–±–Ω–æ–≤–ª–µ–Ω: <ip> ‚Üí <hostname>`;
    - –∫–ª—é—á –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ `[SNI] Detected: <ip> -> <host>`;
    - –ø—Ä–∞–≤–∏–ª–æ `UnstableWindow`: –µ—Å–ª–∏ –≤ –æ–∫–Ω–µ –µ—Å—Ç—å –∏ —É—Å–ø–µ—Ö, –∏ –ø—Ä–æ–±–ª–µ–º–∞ ‚Üí —Å—Ç–∞—Ç—É—Å `Warn` (‚Äú–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ‚Äù).
    - gate B5: legacy —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–µ –º–µ–Ω—è—é—Ç `BypassStrategy`, v2 —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[V2]` ‚Äî –º–µ–Ω—è—é—Ç.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 18.12.2025): –¥–æ–±–∞–≤–ª–µ–Ω CLI smoke-—Ä–∞–Ω–Ω–µ—Ä (–≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–µ—Å—å –ø–ª–∞–Ω)
- –ö–æ–º–∞–Ω–¥–∞:
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke`
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke infra`
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke pipe`
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke insp`
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke ui`
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke bypass`
- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: smoke runner —á–∏—Ç–∞–µ—Ç `TestNetworkApp/smoke_tests_plan.md` –∏ –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –≤—Å–µ Test ID –∏–∑ –ø–ª–∞–Ω–∞; –µ—Å–ª–∏ —Ç–µ—Å—Ç –∏–∑ –ø–ª–∞–Ω–∞ –µ—â—ë –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `FAIL` —Å –ø—Ä–∏—á–∏–Ω–æ–π (—ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, —á—Ç–æ–±—ã –±—ã–ª–æ 97/97 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –±–µ–∑ "–ø—Ä–æ–ø—É—Å–∫–æ–≤"). –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤ —Ä–∞–∑–Ω–µ—Å–µ–Ω—ã –ø–æ —Ñ–∞–π–ª–∞–º `TestNetworkApp/Smoke/SmokeTests.*.cs`, –∞ –∫–∞—Ä–∫–∞—Å —Ä–∞–Ω–Ω–µ—Ä–∞/–ø–ª–∞–Ω–∞ ‚Äî –≤ `TestNetworkApp/Smoke/SmokeRunner.cs`.
- –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º (–±–µ–∑ `SKIP`):
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke --strict`
    - –∞–ª–∏–∞—Å: `--no-skip` (–ª—é–±—ã–µ `SKIP` —Å—á–∏—Ç–∞—é—Ç—Å—è `FAIL`).

- JSON-–æ—Ç—á—ë—Ç:
    - `dotnet run -c Debug --project TestNetworkApp/TestNetworkApp.csproj -- --smoke --strict --json artifacts/smoke.json`

- –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Å–∞–º –∑–∞–ø—Ä–æ—Å–∏—Ç UAC, —Å–æ—Ö—Ä–∞–Ω–∏—Ç JSON):
    - `dotnet run -c Debug --project SmokeLauncher/SmokeLauncher.csproj`
    - (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–æ–±—Ä–∞—Ç—å EXE: `dotnet publish -c Release -r win-x64 -p:PublishSingleFile=true -p:SelfContained=false --project SmokeLauncher/SmokeLauncher.csproj`

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 18.12.2025): —Ä–∞—Å—à–∏—Ä–µ–Ω–æ –ø–æ–∫—Ä—ã—Ç–∏–µ PIPE –≤ smoke
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã `PIPE-001..004` (ConnectionMonitor, PID filtering, SNI parsing, endpoint‚ÜîPID gating) –∏ `PIPE-017` (health-–ª–æ–≥).
- `PIPE-007` –ø—Ä–∏–≤–µ–¥—ë–Ω –∫ –ø–ª–∞–Ω—É: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–µ–π—Ç–∏–Ω–≥ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ —Ü–µ–ª–∏ (–∫—É–ª–¥–∞—É–Ω + –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫) –≤ `InMemoryBlockageStateStore`.
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–∞–∫—Ç `IBlockageStateStore.TryBeginHostTest(...)`: `LiveTestingPipeline` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –∫–∞–∫ –≥–µ–π—Ç–∏–Ω–≥ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–∫—É–ª–¥–∞—É–Ω + –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫) –¥–æ –≤—ã–∑–æ–≤–∞ —Ç–µ—Å—Ç–µ—Ä–∞.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –≤ runtime `TrafficCollector` –¥–µ–¥—É–ø–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ –∫–ª—é—á—É `RemoteIp:RemotePort:Protocol`, –Ω–æ –¥–æ–ø—É—Å–∫–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ ¬´–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è¬ª —Ç–æ–π –∂–µ —Ü–µ–ª–∏ —Å –∫—É–ª–¥–∞—É–Ω–æ–º/–ª–∏–º–∏—Ç–æ–º ‚Äî –∏–Ω–∞—á–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –ø–æ–ø–∞–¥—É—Ç –≤ pipeline.
- –î–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö smoke-—Ç–µ—Å—Ç–æ–≤ SNI –¥–æ–±–∞–≤–ª–µ–Ω—ã API –≤ `DnsParserService`:
    - `TryExtractSniFromTlsClientHelloPayload(...)`
    - `TryFeedTlsClientHelloFragmentForSmoke(...)`

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 18.12.2025): —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã smoke-—Ç–µ—Å—Ç—ã DPI Intelligence v2 (–∫–∞—Ç–µ–≥–æ—Ä–∏—è `dpi2`)
- –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∞–π–ª `TestNetworkApp/Smoke/SmokeTests.Dpi2.cs` –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–µ—Å—Ç—Ä–µ.
- –ü–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç—ã `DPI2-001..013`: –∞–¥–∞–ø—Ç–∞—Ü–∏—è legacy —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ TTL-store, TTL-–æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ `Append`, –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –æ–∫–Ω–∞–º 30/60 —Å–µ–∫—É–Ω–¥, DiagnosisEngine (—Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π), Gate-–º–∞—Ä–∫–µ—Ä—ã `[V2][GATE1]`, –ø—Ä–∞–≤–∏–ª–∞ StrategySelector (confidence/risk/unimplemented warning+skip), Executor MVP (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–π 1-—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[V2]` –∏ –±–µ–∑ auto-apply).

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 18.12.2025): —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã smoke-—Ç–µ—Å—Ç—ã Inspection Services (–∫–∞—Ç–µ–≥–æ—Ä–∏—è `insp`)
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã `TestNetworkApp/Smoke/SmokeTests.Insp.cs` –∏ `TestNetworkApp/Smoke/SmokeTests.Packets.cs`, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ `INSP-001..005` –≤–Ω–µ—Å–µ–Ω—ã –≤ —Ä–µ–µ—Å—Ç—Ä.
- `INSP-001`: –¥–µ—Ç–µ–∫—Ç RST-–∏–Ω–∂–µ–∫—Ü–∏–∏ –ø–æ TTL (–Ω–∞ –±–∞–∑–µ 3+ ¬´–æ–±—ã—á–Ω—ã—Ö¬ª –ø–∞–∫–µ—Ç–æ–≤).
- `INSP-002`: –¥–æ–±–∞–≤–ª–µ–Ω–∞ —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ –ø–æ IPv4 Identification (IPID) –≤ `RstInspectionService` (–∞–Ω–æ–º–∞–ª—å–Ω—ã–π IPID –≤ RST —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π; –¥–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω—ã).
- `INSP-003`: QUIC Initial (>=1200 –±–∞–π—Ç, long header) —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `UdpInspectionService`; –ø—Ä–∏ 5+ –±–µ–∑–æ—Ç–≤–µ—Ç–Ω—ã—Ö —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è—Ö —ç–º–∏—Ç–∏—Ç—Å—è —Å–∏–≥–Ω–∞–ª.
- `INSP-004`: `TcpRetransmissionTracker` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π TCP –ø–∞–∫–µ—Ç (40 –±–∞–π—Ç) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `TryGetSuspiciousDrop(...)` (—Å–∏–≥–Ω–∞–ª –ø—Ä–∏ –¥–æ–ª–µ —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–π >=10% –Ω–∞ –≤—ã–±–æ—Ä–∫–µ >=20 –ø–∞–∫–µ—Ç–æ–≤).
- `INSP-005`: `HttpRedirectDetector` –∏–∑–≤–ª–µ–∫–∞–µ—Ç host –∏–∑ `Location:` –¥–ª—è HTTP 3xx.

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 19.12.2025): —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã smoke-—Ç–µ—Å—Ç—ã TLS bypass (—á–∞—Å—Ç–∏—á–Ω–æ, –∫–∞—Ç–µ–≥–æ—Ä–∏—è `bypass`)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã `BYPASS-003..004` –≤ `TestNetworkApp/Smoke/SmokeTests.Bypass.cs`, –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä.
- `BYPASS-003`: –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ `MetricsUpdated` (2+ –≤—ã–∑–æ–≤–∞) –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª–µ–π –º–µ—Ç—Ä–∏–∫ (`ClientHellosObserved`, `ClientHellosFragmented`, `RstDropped`) –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ.
- `BYPASS-004`: –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ –≤–µ—Ä–¥–∏–∫—Ç–∞ –ø–æ ratio RST/—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (`Red > 4`, `Yellow > 1.5`, –∏–Ω–∞—á–µ `Green`) —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏–µ `VerdictChanged`.
- –î–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinDivert: `BypassFilter` –∫–æ—Ä–º–∏—Ç—Å—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ TCP –ø–∞–∫–µ—Ç–∞–º–∏ (TLS ClientHello + RST), –∞ `TlsBypassService` –ø–æ–ª—É—á–∞–µ—Ç internal-—Ö—É–∫–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (–±–µ–∑ —Ç–∞–π–º–µ—Ä–∞ –∏ –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ `TrafficEngine.StartAsync`).

–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Dev, 19.12.2025): —Ä–∞—Å—à–∏—Ä–µ–Ω–æ smoke-–ø–æ–∫—Ä—ã—Ç–∏–µ TLS bypass (–∫–∞—Ç–µ–≥–æ—Ä–∏—è `bypass`)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã `BYPASS-006..015` (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ) –≤ `TestNetworkApp/Smoke/SmokeTests.Bypass.cs`, –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä.
- `BYPASS-006`: —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è ClientHello –ø–æ –ø—Ä–µ—Å–µ—Ç—É `[80,220]` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ 2 TCP-—Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ `seq/len` –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ä–µ–∞—Å—Å–µ–º–±–ª–∏–Ω–≥–µ.
- `BYPASS-007`: disorder ‚Äî —Å–µ–≥–º–µ–Ω—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –Ω–æ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º–∏ –ø—Ä–∏ —Ä–µ–∞—Å—Å–µ–º–±–ª–∏–Ω–≥–µ –ø–æ `seq`.
- `BYPASS-008`: TTL Trick ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–µ–π–∫–æ–≤—ã–π –ø–∞–∫–µ—Ç —Å TTL –Ω–∏–∂–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ (–≤ smoke-—Ä–∞–Ω–Ω–µ—Ä–µ ¬´real¬ª –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ –∫–∞–∫ –∏—Å—Ö–æ–¥–Ω—ã–π –ø–∞–∫–µ—Ç; —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è —Ñ–∞–∫—Ç fake-–æ—Ç–ø—Ä–∞–≤–∫–∏).
- `BYPASS-009`: Drop RST ‚Äî –≤—Ö–æ–¥—è—â–∏–π RST –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è (`Process=false`) –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∞ `RstDropped`.
- `BYPASS-010`: –≥–µ–π—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ 443 –∏ –Ω–∞–ª–∏—á–∏—é SNI ‚Äî non-443 –∏ 443 –±–µ–∑ SNI –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏ `Non443++/NoSni++` –±–µ–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.
- `BYPASS-011`: –ø–æ—Ä–æ–≥ `TlsFragmentThreshold` ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π ClientHello (< threshold) –Ω–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç `ShortClientHello++`.
- `BYPASS-012`: —Å–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ TTL Trick (manual) + —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ 1 fake-–æ—Ç–ø—Ä–∞–≤–∫–∏ (TTL=10) –∏ 2 —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä–µ—Å–µ—Ç—É `[80,220]` —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ä–µ–∞—Å—Å–µ–º–±–ª–∏–Ω–≥–æ–º –¥–∞–Ω–Ω—ã—Ö.
- `BYPASS-013`: AutoTTL ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä ¬´–ª—É—á—à–µ–≥–æ¬ª TTL –ø–æ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º –º–µ—Ç—Ä–∏–∫–∞–º –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä—Å–∏—Å—Ç–∞ –≤ `bypass_profile.json` (—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞).
- `BYPASS-014`: AutoAdjustAggressive ‚Äî —Ä–∞–Ω–Ω–∏–π burst RST –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø—Ä–µ—Å–µ—Ç –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π chunk (–æ–∂–∏–¥–∞–µ–º–æ –¥–æ 4).
- `BYPASS-015`: AutoAdjustAggressive ‚Äî –ø—Ä–∏ —É—Å—Ç–æ–π—á–∏–≤–æ–º `Green` > 30s –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø—Ä–µ—Å–µ—Ç ¬´—Ä–∞—Å—Å–ª–∞–±–ª—è–µ—Ç—Å—è¬ª (—É–º–µ–Ω—å—à–µ–Ω–∏–µ min chunk, –æ–∂–∏–¥–∞–µ–º–æ 16‚Üí12).
- –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –±–∏–ª–¥–µ—Ä—ã –º–∏–Ω–∏–º–∞–ª—å–Ω–æ-–≤–∞–ª–∏–¥–Ω–æ–≥–æ TLS ClientHello (—Å SNI/–±–µ–∑ SNI) –≤ `TestNetworkApp/Smoke/SmokeTests.Packets.cs`, —á—Ç–æ–±—ã smoke-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –ø—Ä–∏ –≥–µ–π—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–±—Ö–æ–¥–∞ –ø–æ –Ω–∞–ª–∏—á–∏—é SNI.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –±—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–µ—Ä–µ–¥/–ø–æ—Å–ª–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞):
- ‚Äú–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç‚Äù: —Å–æ–±—ã—Ç–∏–µ `[NOISE]`/noise-hostname –Ω–µ –¥–æ–ª–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `Fail/Warn`.
- ‚ÄúSNI –ø–æ–∑–∂–µ IP‚Äù: —Å–Ω–∞—á–∞–ª–∞ `‚ùå <ip>...`, –ø–æ—Ç–æ–º `[SNI] Detected...` ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–µ—Ö–∞—Ç—å –Ω–∞ hostname –∏ –æ—Å—Ç–∞—Ç—å—Å—è `Warn/Fail`.
- ‚ÄúDNS vs rDNS‚Äù: –µ—Å–ª–∏ PTR/rDNS —à—É–º–æ–≤–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä `*.1e100.net`), –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –æ—Ç–º–µ–Ω—è—Ç—å –¥–∏–∞–≥–Ω–æ–∑/—Å–∫—Ä—ã–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É.

–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è (runtime):
- `Program.cs` —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç `CodePagesEncodingProvider`, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ OEM-–∫–æ–¥–∏—Ä–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, CP866 –¥–ª—è `ipconfig /flushdns` –∏ `tracert` –Ω–∞ —Ä—É—Å—Å–∫–æ–π Windows).
- `TrafficCollector` –Ω–µ —Å–æ–∑–¥–∞—ë—Ç UI-—Å–æ–±—ã—Ç–∏—è –¥–ª—è loopback –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç `UnifiedTrafficFilter` –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏; —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è ¬´—à—É–º–Ω—ã—Ö¬ª —Ö–æ—Å—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö (OK) —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å —Å–∏–≥–Ω–∞–ª –Ω–∞ –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö/CDN —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.

### 1.2 –ö–ª—é—á–µ–≤—ã–µ —É–∑–ª—ã —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º —Å–≤—è–∑–µ–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í—Ö–æ–¥—è—â–∏—Ö | –ò—Å—Ö–æ–¥—è—â–∏—Ö | –†–æ–ª—å |
|-----------|----------|-----------|------|
| `MainViewModelRefactored` | 1 (MainWindow) | 3 (Bypass, Orchestrator, Results) | **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä UI** |
| `DiagnosticOrchestrator` | 1 | 12+ | **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä** |
| `TrafficEngine` | 4 | 3 | **WinDivert –º–µ–Ω–µ–¥–∂–µ—Ä** |
| `LiveTestingPipeline` | 1 | 6 | **Pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏** |
| `Config` | 10+ | 2 | **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** |
| `NoiseHostFilter` | 5 | 0 | **Singleton —Ñ–∏–ª—å—Ç—Ä** |

### 1.3 –°–∫—Ä—ã—Ç—ã–µ/–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ | –†–∏—Å–∫ |
|-------------------|----------------|------|
| `NoiseHostFilter.Instance` | TrafficCollector, TestResultsManager, LiveTestingPipeline | Singleton, —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å |
| `Program.Targets` | Config.SetActiveProfile | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ª–æ–≤–∞—Ä—å —Ü–µ–ª–µ–π |
| `FixService` (—Ñ–∞–π–ª—ã –±—ç–∫–∞–ø–∞) | BypassController | –°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫–µ |
| `Config.ActiveProfile` | –ú–Ω–æ–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ |

### 1.4 –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:** –ù–ï–¢ —è–≤–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–æ–≤.

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:** `DiagnosticOrchestrator` ‚Üî `TestResultsManager` ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç—å retest —á–µ—Ä–µ–∑ BypassController.

---

## 2. –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥

### 2.1 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã (–∫–ª–∞—Å—Å—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –º—ë—Ä—Ç–≤—ã–µ)

| –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è |
|------|---------|----------------------|
| `TargetCatalog.cs` | –ü—É—Å—Ç–æ–π —Ñ–∞–π–ª (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π "—É–¥–∞–ª—ë–Ω") | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Wpf/ServiceItemViewModel.cs` | 0 usages –≤ –∫–æ–¥–µ, —Ç–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Windows/CapturedTargetsWindow.xaml(.cs)` | –ù–∏–≥–¥–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Utils/GuiProfileStorage.cs` | 0 usages | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Utils/DnsFixApplicator.cs` | –î—É–±–ª–∏—Ä—É–µ—Ç FixService, 0 usages | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Utils/BypassStrategyPlanner.cs` | 0 usages, –∑–∞–º–µ–Ω—ë–Ω StrategyMapping | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Utils/NetworkMonitorService.cs` | –ó–∞–º–µ–Ω—ë–Ω TrafficEngine, 0 usages | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| `Utils/ProblemClassifier.cs` | 0 usages, –∑–∞–º–µ–Ω—ë–Ω StandardBlockageClassifier | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |

### 2.2 –ú—ë—Ä—Ç–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã (Tests/)

**–ö–†–ò–¢–ò–ß–ù–û:** –í—Å–µ –∫–ª–∞—Å—Å—ã –≤ `Tests/` –ù–ï –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –∏–∑ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥–∞!

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|------|--------|-------------|
| `Tests/DnsTest.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new DnsTest()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/TcpTest.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new TcpTest()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/HttpTest.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new HttpTest()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/TracerouteTest.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new TracerouteTest()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/UdpProbeRunner.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new UdpProbeRunner()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/RstHeuristic.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new RstHeuristic()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/FirewallTest.cs` | ‚ùå –ú–Å–†–¢–í–´–ô | `new FirewallTest()` –Ω–∏–≥–¥–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è |
| `Tests/TestProgress.cs` | ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û | `TestKind` enum –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–µ |

**–í—ã–≤–æ–¥:** –õ–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ `Core/Modules/StandardHostTester.cs`. –°—Ç–∞—Ä—ã–µ —Ç–µ—Å—Ç—ã ‚Äî legacy.

### 2.3 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ JSON-—Ñ–∞–π–ª—ã

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|------|--------|--------------|
| `game_targets.json` | –ü—É—Å—Ç–æ–π (`"targets": []`) | ‚ùå –£–¥–∞–ª–∏—Ç—å |
| `bypass_profile_fshud_google.json` | 0 usages | ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å |

### 2.4 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã –∏ —Å–≤–æ–π—Å—Ç–≤–∞

| –ö–ª–∞—Å—Å | –ú–µ—Ç–æ–¥/–°–≤–æ–π—Å—Ç–≤–æ | –ü—Ä–∏—á–∏–Ω–∞ |
|-------|---------------|---------|
| `Config` | `NoTrace` | Legacy, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è |
| `Config` | `Ports` | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–ø–æ—Ä—Ç—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ) |
| `Config` | `UdpProbes` | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| `TargetDefinition` | `Ports`, `Protocols` | –û–±—ä—è–≤–ª–µ–Ω—ã, –Ω–æ –Ω–µ —á–∏—Ç–∞—é—Ç—Å—è |
| `TestKind` (enum) | `FIREWALL, ISP, ROUTER, SOFTWARE` | –ó–Ω–∞—á–µ–Ω–∏—è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è |

### 2.5 Unreachable –∫–æ–¥

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `FirewallTest.cs` | 450+ | Unit-—Ç–µ—Å—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è) |

---

## 3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

### 3.1 –î—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞

| –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª—ã | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|----------|-------|--------------|
| DNS —Ä–µ–∑–æ–ª–≤ | `StandardHostTester`, `DnsTest`, `NetUtils` | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤ `NetUtils` |
| TLS handshake | `StandardHostTester`, `HttpTest` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `StandardHostTester` |
| –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ | `StandardBlockageClassifier`, `ProblemClassifier` | –£–¥–∞–ª–∏—Ç—å `ProblemClassifier` |
| DNS fix | `FixService`, `DnsFixApplicator` | –£–¥–∞–ª–∏—Ç—å `DnsFixApplicator` |

### 3.2 –ù–∞—Ä—É—à–µ–Ω–∏—è SRP (Single Responsibility)

| –ö–ª–∞—Å—Å | –ü—Ä–æ–±–ª–µ–º–∞ | –†–∞–∑–º–µ—Ä |
|-------|----------|--------|
| `DiagnosticOrchestrator` | –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π: UI, overlay, –ø—Ä–æ—Ü–µ—Å—Å—ã, WinDivert | 824 —Å—Ç—Ä–æ–∫–∏ |
| `TestResultsManager` | –ü–∞—Ä—Å–∏–Ω–≥ + —Ö—Ä–∞–Ω–µ–Ω–∏–µ + –∑–¥–æ—Ä–æ–≤—å–µ + UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | 717 —Å—Ç—Ä–æ–∫ |
| `BypassController` | Bypass + DoH + VPN –¥–µ—Ç–µ–∫—Ç + —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | 647 —Å—Ç—Ä–æ–∫ |

### 3.3 –•–∞–æ—Ç–∏—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ü—Ä–æ–±–ª–µ–º–∞ | –î–µ—Ç–∞–ª–∏ |
|----------|--------|
| Namespace —Å–º–µ—à–∏–≤–∞–Ω–∏–µ | `IspAudit`, `ISPAudit`, `ISPAudit.ViewModels`, `IspAudit.Utils` |
| –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ | `Program.Targets`, `Config.ActiveProfile`, `NoiseHostFilter.Instance` |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π | `Target` (Models/), `TargetDefinition` (root), `Target` (ISPAudit.Models) |

### 3.4 –¢—Ä–µ–±—É—é—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

| –§–∞–π–ª | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ü—Ä–∏—á–∏–Ω–∞ |
|------|-----------|---------|
| `DiagnosticOrchestrator.cs` | üî¥ –í—ã—Å–æ–∫–∏–π | –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ StartupManager, OverlayManager, ProcessMonitor |
| `TestResultsManager.cs` | üî¥ –í—ã—Å–æ–∫–∏–π | –í—ã–¥–µ–ª–∏—Ç—å –ø–∞—Ä—Å–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å |
| –í–µ—Å—å `Tests/` | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ unit-tests |
| `Config.cs` | üü° –°—Ä–µ–¥–Ω–∏–π | –£–±—Ä–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ |

---

## 4. –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã (Legacy)

### 4.1 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
|----------|------|--------|
| `Config.NoTrace` | Config.cs | Legacy, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| `Config.EnableRst` | Config.cs | –û—Ç–∫–ª—é—á–µ–Ω–æ, RST —á–µ—Ä–µ–∑ TrafficEngine |
| `TestKind.FIREWALL/ISP/ROUTER/SOFTWARE` | TestProgress.cs | –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è |

### 4.2 –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ API/–ø–∞—Ç—Ç–µ—Ä–Ω—ã

| –ü–∞—Ç—Ç–µ—Ä–Ω | –ì–¥–µ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---------|-----|--------------|
| `.Result` / `.Wait()` –Ω–∞ async | UdpProbeRunner.cs | –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `await` |
| –°–º–µ—à–∏–≤–∞–Ω–∏–µ sync/async | FixService | –ü–æ–ª–Ω–æ—Å—Ç—å—é async |
| WMI –¥–ª—è Firewall | FirewallTest | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ |

### 4.3 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è vs —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å

| –î–æ–∫—É–º–µ–Ω—Ç | –ü—Ä–æ–±–ª–µ–º–∞ |
|----------|----------|
| `CLAUDE.md` | –£–ø–æ–º–∏–Ω–∞–µ—Ç `DnsTest`, `TcpTest` –∏ –¥—Ä. –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–µ |
| `.github/copilot-instructions.md` | –°—Å—ã–ª–∫–∏ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `AuditRunner`, `ReportWriter` |

> ‚úÖ `ARCHITECTURE_V2.md` —É–¥–∞–ª—ë–Ω (10.12.2025), –∞–∫—Ç—É–∞–ª—å–Ω—ã–π ‚Äî `ARCHITECTURE_CURRENT.md`

---

## 5. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏

### 5.1 üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ runtime –ø—Ä–æ–±–ª–µ–º—ã (–ü–†–û–í–ï–†–ï–ù–û)

#### 5.1.1 `dnsOk=true` –≤—Å–µ–≥–¥–∞ –≤ StandardHostTester

**–§–∞–π–ª:** `Core/Modules/StandardHostTester.cs:24-25`

```csharp
bool dnsOk = true;
string dnsStatus = "OK";
// –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ù–ò–ö–û–ì–î–ê –Ω–µ –º–µ–Ω—è—é—Ç—Å—è!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –æ—à–∏–±–∫–µ DNS (—Å—Ç—Ä–æ–∫–∏ 44-60) –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `catch { }` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è `dnsOk`. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç `dnsOk=true`, –¥–∞–∂–µ –µ—Å–ª–∏ DNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–í–ª–∏—è–Ω–∏–µ:** DNS –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è.

---

#### 5.1.2 `async void` –≤ InitializeOnStartupAsync

**–§–∞–π–ª:** `ViewModels/BypassController.cs:291`

```csharp
public async void InitializeOnStartupAsync()
{
    // –í–∫–ª—é—á–∞–µ—Ç Disorder + DROP_RST –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å—Ç—Ä–æ–∫–∏ 307-310)
    _isDisorderEnabled = true;
    _isDropRstEnabled = true;
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è (–ø—Ä–æ–≥–ª–∞—Ç—ã–≤–∞—é—Ç—Å—è runtime)
- –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ –Ω–µ –º–æ–∂–µ—Ç `await`
- Bypass –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

#### 5.1.3 –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ª–æ–≥–∏ –Ω–∞ Desktop

**–§–∞–π–ª:** `App.xaml.cs:7-8, 12, 16, 22, 31, 33-34, 42, 46, 49, 53`

```csharp
var logPath = Path.Combine(Environment.GetFolderPath(SpecialFolder.Desktop), "isp_audit_debug.txt");
File.AppendAllText(logPath, "...");  // –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, 10+ –≤—ã–∑–æ–≤–æ–≤!
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ UI –ø–æ—Ç–æ–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ä—Ç–µ
- –ú—É—Å–æ—Ä –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`isp_audit_debug.txt`)
- –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ (Desktop –Ω–∞ —Å–µ—Ç–µ–≤–æ–º –¥–∏—Å–∫–µ, –ø—Ä–∞–≤–∞)

---

### 5.2 üü° –°—Ä–µ–¥–Ω–∏–µ runtime –ø—Ä–æ–±–ª–µ–º—ã

#### 5.2.1 Unbounded channels –±–µ–∑ back-pressure

**–§–∞–π–ª—ã:** `Utils/LiveTestingPipeline.cs:97-99`, `Utils/TrafficCollector.cs:102`

```csharp
_snifferQueue = Channel.CreateUnbounded<HostDiscovered>();
_testerQueue = Channel.CreateUnbounded<HostTested>();
_bypassQueue = Channel.CreateUnbounded<HostBlocked>();
// + TrafficCollector.cs:102
```

**–†–∏—Å–∫:** –ü—Ä–∏ –≤—Å–ø–ª–µ—Å–∫–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (—Ç—ã—Å—è—á–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π) –≤–æ–∑–º–æ–∂–µ–Ω OOM.  
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Ä–µ–¥–∫–æ –±–æ–ª—å—à–µ 100-200 —Ö–æ—Å—Ç–æ–≤, –Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `BoundedChannel`.

---

#### 5.2.2 TLS –±–µ–∑ hostname —Å—á–∏—Ç–∞–µ—Ç—Å—è OK

**–§–∞–π–ª:** `Core/Modules/StandardHostTester.cs:148-150`

```csharp
else if (host.RemotePort == 443)
{
    // –ù–µ –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å TLS –±–µ–∑ hostname
    tlsOk = tcpOk;
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** TLS DPI –¥–ª—è IP-only —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è.  
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –ë–µ–∑ SNI –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å TLS ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ –æ–ø—Ä–∞–≤–¥–∞–Ω–æ.

---

### 5.3 Silent failures

| –†–∏—Å–∫ | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| DNS timeout –±–µ–∑ –ª–æ–≥–∞ | StandardHostTester.cs:48 | `GetHostEntryAsync` –º–æ–∂–µ—Ç –º–æ–ª—á–∞ timeout |
| WinDivert errors | TrafficEngine.cs | –û—à–∏–±–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è handle –ø—Ä–æ–≥–ª–∞—Ç—ã–≤–∞—é—Ç—Å—è |
| Backup file corruption | FixService | –ù–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è JSON –±—ç–∫–∞–ø |
| –§–æ–Ω–æ–≤—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è | DiagnosticOrchestrator, LiveTestingPipeline | `DispatcherUnhandledException` –ª–æ–≤–∏—Ç —Ç–æ–ª—å–∫–æ UI-–ø–æ—Ç–æ–∫ |

### 5.4 –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤—ã–∑–æ–≤—É—Ç—Å—è

| Handler | –ü—Ä–∏—á–∏–Ω–∞ |
|---------|---------|
| `OnDnsLookupFailed` –≤ DnsParserService | –ü–æ–¥–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è, –Ω–æ UI –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç |
| `OnHostnameResolved` –≤ TrafficCollector | –°–æ–±—ã—Ç–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–æ, –Ω–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –Ω–µ—Ç |

### 5.5 –ò—Å–∫–ª—é—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å

| Exception | –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ |
|-----------|------|---------|
| `UnauthorizedAccessException` –≤ FirewallTest | –ö–ª–∞—Å—Å –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è |
| –í—Å–µ try/catch –≤ Tests/*.cs | –ö–æ–¥ –º—ë—Ä—Ç–≤—ã–π |

### 5.6 –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤

| –ü—Ä–æ–±–ª–µ–º–∞ | –î–µ—Ç–∞–ª–∏ |
|----------|--------|
| `Target` vs `TargetDefinition` | –î–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ |
| `TransportProtocol` –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ | `Utils/NetworkConnection.cs` –∏ `Bypass/BypassRedirectRule.cs` |
| `BlockageType` –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ | `ProblemClassifier` –∏ `Core/Models` |

---

## 6. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—á–∏—Å—Ç–∫–µ

### 6.1 –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (–Ω–∏–∑–∫–∏–π —Ä–∏—Å–∫)

```
–£–¥–∞–ª–∏—Ç—å:
‚îú‚îÄ‚îÄ TargetCatalog.cs (–ø—É—Å—Ç–æ–π)
‚îú‚îÄ‚îÄ Wpf/ServiceItemViewModel.cs
‚îú‚îÄ‚îÄ Windows/CapturedTargetsWindow.xaml(.cs)
‚îú‚îÄ‚îÄ Utils/GuiProfileStorage.cs
‚îú‚îÄ‚îÄ Utils/DnsFixApplicator.cs
‚îú‚îÄ‚îÄ Utils/BypassStrategyPlanner.cs
‚îú‚îÄ‚îÄ Utils/NetworkMonitorService.cs
‚îú‚îÄ‚îÄ Utils/ProblemClassifier.cs
‚îú‚îÄ‚îÄ game_targets.json
‚îî‚îÄ‚îÄ bypass_profile_fshud_google.json
```

**–í–ª–∏—è–Ω–∏–µ:** –ù—É–ª–µ–≤–æ–µ ‚Äî –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

### 6.2 –ú–∏–≥—Ä–∞—Ü–∏—è Tests/ (—Å—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫)

```
Tests/ ‚Üí –í–∞—Ä–∏–∞–Ω—Ç—ã:
1. –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é (–ª–æ–≥–∏–∫–∞ –≤ Core/Modules)
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ ISP_Audit.Tests/ –∫–∞–∫ unit-—Ç–µ—Å—Ç—ã
3. –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ "—Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã" –≤ docs/legacy/
```

**–í–ª–∏—è–Ω–∏–µ:** –ü–æ—Ç–µ—Ä—è "—Å–ø—Ä–∞–≤–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞", –Ω–æ –æ–Ω —É–∂–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

### 6.3 –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ Config (–Ω–∏–∑–∫–∏–π —Ä–∏—Å–∫)

```csharp
// –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ:
- NoTrace
- UdpProbes (–µ—Å–ª–∏ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- Ports (–ø–æ—Ä—Ç—ã –≤ –ø—Ä–æ—Ñ–∏–ª—è—Ö)
```

### 6.4 Namespace —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫)

```
–¢–µ–∫—É—â–µ–µ:
IspAudit, ISPAudit, ISPAudit.ViewModels, IspAudit.Utils

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:
IspAudit.* –≤–µ–∑–¥–µ (–µ–¥–∏–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä)
```

**–†–∏—Å–∫:** –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤.

### 6.5 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

```
–û–±–Ω–æ–≤–∏—Ç—å:
- CLAUDE.md ‚Äî —É–±—Ä–∞—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥
- [x] .github/copilot-instructions.md ‚Äî –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (–í—ã–ø–æ–ª–Ω–µ–Ω–æ 10.12.2025)
- [x] –î–æ–±–∞–≤–∏—Ç—å ARCHITECTURE_ACTUAL.md —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (–°–æ–∑–¥–∞–Ω ARCHITECTURE_CURRENT.md 10.12.2025)
```

---

## 7. –ö–∞—Ä—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Ç–µ–∫—Å—Ç–æ–≤–∞—è)

```
Program.cs
‚îî‚îÄ‚îÄ Config.SetActiveProfile
    ‚îî‚îÄ‚îÄ DiagnosticProfile (Profiles/Default.json)
‚îî‚îÄ‚îÄ App.xaml
    ‚îî‚îÄ‚îÄ MainWindow.xaml
        ‚îî‚îÄ‚îÄ MainViewModelRefactored
            ‚îú‚îÄ‚îÄ BypassController
            ‚îÇ   ‚îú‚îÄ‚îÄ TlsBypassService
            ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TrafficEngine
            ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BypassFilter
            ‚îÇ   ‚îî‚îÄ‚îÄ FixService
            ‚îú‚îÄ‚îÄ DiagnosticOrchestrator
            ‚îÇ   ‚îú‚îÄ‚îÄ TrafficCollector
            ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ConnectionMonitorService
            ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TcpConnectionWatcher
            ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PidTrackerService
            ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DnsParserService
            ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ TrafficMonitorFilter
            ‚îÇ   ‚îú‚îÄ‚îÄ LiveTestingPipeline
            ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StandardHostTester
            ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StandardBlockageClassifier
            ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ InMemoryBlockageStateStore
            ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ TcpRetransmissionTracker
            ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ HttpRedirectDetector
            ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RstInspectionService
            ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ UdpInspectionService
            ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UnifiedTrafficFilter
            ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ NoiseHostFilter
            ‚îÇ   ‚îî‚îÄ‚îÄ TrafficEngine (shared)
            ‚îî‚îÄ‚îÄ TestResultsManager
                ‚îî‚îÄ‚îÄ NoiseHostFilter.Instance

–ì–õ–û–ë–ê–õ–¨–ù–´–ï:
- Config.ActiveProfile (static)
- Program.Targets (static)
- NoiseHostFilter.Instance (singleton)

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (16.12.2025):
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã–π —Å–ª–æ–π DPI Intelligence v2: `Core/IntelligenceV2/Contracts` (–º–æ–¥–µ–ª–∏ Signals/Diagnosis/Strategy).
- –≠—Ç–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã (DTO/enum/–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã), –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ UI/Bypass/WinDivert; –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ runtime –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–∞—Ö (SignalsAdapter ‚Üí Diagnosis ‚Üí Selector ‚Üí Executor).
```

---

## 8. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –í—Å–µ–≥–æ .cs —Ñ–∞–π–ª–æ–≤ | ~86 |
| –ú—ë—Ä—Ç–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ | **15** (17%) |
| –ú—ë—Ä—Ç–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤ | **18+** |
| –î—É–±–ª–∏—Ä—É—é—â–µ–π—Å—è –ª–æ–≥–∏–∫–∏ | **4 –æ–±–ª–∞—Å—Ç–∏** |
| Legacy –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | **6+** |
| Runtime –ø—Ä–æ–±–ª–µ–º | **5** (3 –∫—Ä–∏—Ç–∏—á–Ω—ã–µ) |
| –†–∏—Å–∫–æ–≤ silent failure | **3** |

---

## 9. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üî¥ –ù–ï–ú–ï–î–õ–ï–ù–ù–û (–±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
|---|----------|------|-------------|
| 1 | `dnsOk=true` –≤—Å–µ–≥–¥–∞ | StandardHostTester.cs:24-60 | –î–æ–±–∞–≤–∏—Ç—å `dnsOk=false` –≤ catch-–±–ª–æ–∫ |
| 2 | `async void` | BypassController.cs:291 | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ `async Task`, —É–±—Ä–∞—Ç—å –∞–≤—Ç–æ–≤–∫–ª—é—á–µ–Ω–∏–µ |
| 3 | –õ–æ–≥–∏ –Ω–∞ Desktop | App.xaml.cs | –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ %TEMP%/logs |

### üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (1-2 –¥–Ω—è)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
|---|----------|------|-------------|
| 4 | Unbounded channels | LiveTestingPipeline.cs | –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `BoundedChannel` (capacity: 1000) |
| 5 | TLS –±–µ–∑ hostname | StandardHostTester.cs:148 | –î–æ–±–∞–≤–∏—Ç—å `tlsStatus = "SKIPPED (no hostname)"` |

### –§–∞–∑–∞ 1 (2-3 –¥–Ω—è): –û—á–∏—Å—Ç–∫–∞ –º—ë—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞
1. –£–¥–∞–ª–∏—Ç—å 100% –º—ë—Ä—Ç–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 6.1
2. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ `Config`
3. –û–±–Ω–æ–≤–∏—Ç—å `CLAUDE.md`

### –§–∞–∑–∞ 2 (3-5 –¥–Ω–µ–π): –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
1. –†–∞–∑–¥–µ–ª–∏—Ç—å `DiagnosticOrchestrator` –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
2. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å namespace (`IspAudit` vs `ISPAudit`)
3. –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ `Tests/`

### –§–∞–∑–∞ 3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
1. –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–∏–Ω–≥–ª—Ç–æ–Ω—ã
2. –î–æ–±–∞–≤–∏—Ç—å DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
3. –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ unit-—Ç–µ—Å—Ç–∞–º–∏

---

**–°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞:** –ê–∫—Ç—É–∞–ª–µ–Ω –Ω–∞ 12.12.2025 (TLS bypass Phase2)
**–û—á–∏—Å—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** –í—ã–ø–æ–ª–Ω–µ–Ω–∞ (79 ‚Üí 25 .md —Ñ–∞–π–ª–æ–≤)

---

## 10. –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (10.12.2025)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Phase 1)
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ DNS –≤ `StandardHostTester.cs` (—Ç–µ–ø–µ—Ä—å `dnsOk=false` –ø—Ä–∏ –æ—à–∏–±–∫–µ).
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `async void` –≤ `BypassController.cs` (–∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `async Task`).
- [x] –£–¥–∞–ª–µ–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª –≤ `App.xaml.cs`.
- [x] –û–≥—Ä–∞–Ω–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä –∫–∞–Ω–∞–ª–æ–≤ (Channels) –≤ `LiveTestingPipeline.cs` –∏ `TrafficCollector.cs` (BoundedChannel).

### –û—á–∏—Å—Ç–∫–∞ –º—ë—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞ (Phase 2)
- [x] –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã: `TargetCatalog.cs`, `Wpf/ServiceItemViewModel.cs`, `Windows/CapturedTargetsWindow.xaml`, `Utils/GuiProfileStorage.cs`, `Utils/DnsFixApplicator.cs`, `Utils/BypassStrategyPlanner.cs`, `Utils/NetworkMonitorService.cs`, `Utils/ProblemClassifier.cs`.
- [x] –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã: `game_targets.json`, `bypass_profile_fshud_google.json`.
- [x] –û—á–∏—â–µ–Ω `Config.cs` (—É–¥–∞–ª–µ–Ω—ã `NoTrace`, `Ports`, `UdpProbes`).
- [x] –£–¥–∞–ª–µ–Ω–∞ –ø–∞–ø–∫–∞ `Tests/` (–ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ `Core/Modules`).

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Phase 3)
- [x] –°–æ–∑–¥–∞–Ω `ARCHITECTURE_CURRENT.md` (v3.0 Extended) ‚Äî –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.
- [x] –û–±–Ω–æ–≤–ª–µ–Ω `README.md`:
    - –ó–∞–º–µ–Ω–µ–Ω–∞ ASCII —Å—Ö–µ–º–∞ –Ω–∞ Mermaid –¥–∏–∞–≥—Ä–∞–º–º—É.
    - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
    - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑—å `BypassController` (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –∏–∑ Network Layer –≤ UI Layer).
- [x] –û–±–Ω–æ–≤–ª–µ–Ω `.github/copilot-instructions.md`:
    - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω —è–∑—ã–∫ (—Ä—É—Å—Å–∫–∏–π).
    - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫—Ä–∞—Ç–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.
    - –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ä–∞–∑–¥–µ–ª—ã.
- [x] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
    - –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∫–æ–¥—É (`MainViewModelRefactored`, `DiagnosticOrchestrator`, `LiveTestingPipeline`).
- [x] –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω (Namespaces):
    - –ü—Ä–∏–≤–µ–¥–µ–Ω–æ –∫ –µ–¥–∏–Ω–æ–º—É —Å—Ç–∏–ª—é (–≤—ã–±—Ä–∞–Ω `IspAudit`).

---

## 11. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è TLS bypass (12.12.2025)

- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: `TlsBypassService` ‚Äî –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–ø—Ü–∏–π/–ø—Ä–µ—Å–µ—Ç–æ–≤, —Å–∞–º —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç `BypassFilter`, –ø—É–±–ª–∏–∫—É–µ—Ç `MetricsUpdated/VerdictChanged/StateChanged`; `BypassController` —Å—Ç–∞–ª –ø—Ä–æ–∫—Å–∏ –±–µ–∑ —Ç–∞–π–º–µ—Ä–∞ (—Ç—É–º–±–ª–µ—Ä—ã + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞/–∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏).
- **–ü—Ä–æ—Ñ–∏–ª—å**: `bypass_profile.json` —Ä–∞—Å—à–∏—Ä–µ–Ω TTL-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (`ttlTrick`/`ttlTrickValue`) –∏ —Ñ–ª–∞–≥–æ–º `autoTtl`; —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞ –≤ UI –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (—á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—Ç–∏—Ä–∞—Ç—å TTL/redirect rules).
- **AutoTTL**: –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º `autoTtl` —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä TTL (2..8) –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º bypass –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à–∏–π TTL –æ–±—Ä–∞—Ç–Ω–æ –≤ `bypass_profile.json`.
- **Auto-hostlist (–∫–∞–Ω–¥–∏–¥–∞—Ç—ã)**: –¥–æ–±–∞–≤–ª–µ–Ω `AutoHostlistService`; `LiveTestingPipeline` –Ω–∞ —ç—Ç–∞–ø–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç `InspectionSignalsSnapshot` (—Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏/HTTP-—Ä–µ–¥–∏—Ä–µ–∫—Ç—ã/RST/UDP) —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ Auto-hostlist –≤–∫–ª—é—á—ë–Ω, –∏ –ø–æ–ø–æ–ª–Ω—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ UI (–≤–∫–ª—é—á–∞–µ—Ç—Å—è/–≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è —Ç—É–º–±–ª–µ—Ä–æ–º). Legacy `BlockageSignals` –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —á–∏—Ç–∞—é—Ç—Å—è.
- **–ú–µ—Ç—Ä–∏–∫–∏**: —Å–µ—Ä–≤–∏—Å —Å—á–∏—Ç–∞–µ—Ç ClientHello (–≤—Å–µ/–∫–æ—Ä–æ—Ç–∫–∏–µ/–Ω–µ 443), —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ RST, –ø–ª–∞–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–µ—Å–µ—Ç, –ø–æ—Ä–æ–≥ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —á–∞–Ω–∫, –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞; UI —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è —Å–µ—Ä–≤–∏—Å–∞ (–ø–ª–∞–Ω + —Ç–∞–π–º—Å—Ç–∞–º–ø –≤ badge).
- **–í–µ—Ä–¥–∏–∫—Ç—ã/UX**: –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã ¬´–Ω–µ—Ç TLS 443¬ª, ¬´TLS –Ω–µ –Ω–∞ 443¬ª, ¬´ClientHello –∫–æ—Ä–æ—á–µ threshold¬ª, ¬´–æ–±—Ö–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—ë–Ω¬ª, ¬´–º–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö¬ª; –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ —à—É–º–∏—Ç –Ω–∞ —Å–µ—Ä—ã–µ —Å—Ç–∞—Ç—É—Å—ã, tooltip –¥–∞—ë—Ç next steps (—Å–Ω–∏–∑–∏—Ç—å threshold/—Å–º–µ–Ω–∏—Ç—å –ø—Ä–µ—Å–µ—Ç/–≤–∫–ª—é—á–∏—Ç—å Drop RST).
- **–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏—è**: —Ñ–ª–∞–≥ `AutoAdjustAggressive` (—Ç–æ–ª—å–∫–æ –ø—Ä–µ—Å–µ—Ç ¬´–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π¬ª); —Ä–∞–Ω–Ω–∏–π –≤—Å–ø–ª–µ—Å–∫ RST -> –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —á–∞–Ω–∫=4; –∑–µ–ª—ë–Ω—ã–π >30—Å -> –ª—ë–≥–∫–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ (–Ω–µ –Ω–∏–∂–µ 4); –ø–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ü–∏–π –¥–µ–ª–∞–µ—Ç —Å–µ—Ä–≤–∏—Å.
- **–†–∏—Å–∫–∏/–ø—Ä–æ–±–µ–ª—ã**: –Ω–µ—Ç unit-—Ç–µ—Å—Ç–æ–≤ –Ω–∞ `TlsBypassService`/–≤–µ—Ä–¥–∏–∫—Ç—ã; —Ç–∞–π–º–µ—Ä –º–µ—Ç—Ä–∏–∫ 2—Å –º–æ–∂–µ—Ç –ª–∞–≥–∞—Ç—å –≤ UI; –∞–≤—Ç–æ-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ñ–ª–∞–≥ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø—Ä–µ—Å–µ—Ç–∞ (–ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç); –æ–±—Ö–æ–¥ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ ClientHello –±–µ–∑ SNI –∏–ª–∏ –Ω–µ –Ω–∞ 443; preemptive —Ä–µ–∂–∏–º –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ `TrafficEngine`.
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (SNI vs bypass)**: `TrafficMonitorFilter` –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–∞–∫–µ—Ç –¥–æ `BypassFilter`, —á—Ç–æ–±—ã –ø–∞—Ä—Å–µ—Ä SNI –≤–∏–¥–µ–ª –∏—Å—Ö–æ–¥–Ω—ã–π (–Ω–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π/–Ω–µ–ø–µ—Ä–µ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π) ClientHello; –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π TCP-—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ ClientHello –≤ `DnsParserService` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∞—Å—Å–µ–º–±–ª–∏–Ω–≥ –ø–µ—Ä–≤—ã—Ö –±–∞–π—Ç –ø–æ—Ç–æ–∫–∞.
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (SNI vs PID)**: WinDivert Network Layer –Ω–µ –¥–∞—ë—Ç PID, –ø–æ—ç—Ç–æ–º—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≥–µ–π—Ç–∏—Ç SNI-—Ç—Ä–∏–≥–≥–µ—Ä—ã —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é remote endpoint ‚Üí PID –ø–æ —Å–æ–±—ã—Ç–∏—è–º `ConnectionMonitorService` –∏ —Å–ø–∏—Å–∫—É `PidTrackerService.TrackedPids`. –î–ª—è Steam/attach –µ—Å—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π –±—É—Ñ–µ—Ä (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥), —á—Ç–æ–±—ã SNI, –ø—Ä–∏—à–µ–¥—à–∏–π –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è PID, –º–æ–≥ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –ø–æ–∑–∂–µ.
- **UX-—Ñ–∏–¥–±–µ–∫**: —Å—Ç–∞—Ç—É—Å auto-bypass –∏ –≤–µ—Ä–¥–∏–∫—Ç —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ; –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø–æ —Ü–≤–µ—Ç—É –≤–µ—Ä–¥–∏–∫—Ç–∞ (–∑–µ–ª—ë–Ω—ã–π –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π); badge –≤–∫–ª—é—á–∞–µ—Ç –ø–ª–∞–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ + –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–µ—Å–µ—Ç.
