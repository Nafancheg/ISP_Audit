# Анализ текущего состояния ISP Audit и рекомендации

## Назначение приложения

ISP Audit — настольное приложение для диагностики сетевых ограничений. Оно помогает пользователю определить, блокирует ли провайдер доступ к выбранным ресурсам, и подсказывает возможные пути обхода. Утилита запускает серию тестов (DNS, TCP/HTTP(S), traceroute, UDP, эвристику RST) для заданных адресов и формирует подробный отчёт с рекомендациями.

## Текущие возможности

- Сравнение результатов обычного DNS и шифрованного DNS (DoH) для выявления подмены записей или отсутствия ответа.
- TCP-проверка портов 80 и 443, чтобы оценить доступность HTTP(S)-сервисов.
- Выполнение HTTP(S)-запросов, включая анализ TLS-сертификатов и кодов ответа.
- Traceroute до целевого хоста без DNS-имен для определения точки обрыва маршрута.
- UDP-проверка DNS-запросом на 1.1.1.1:53 (Cloudflare) для диагностики блокировок UDP-трафика.
- Эвристика обнаружения RST-инъекций DPI-системами по времени закрытия соединения.
- Формирование текстового отчёта с детальными логами и сводными рекомендациями.

## Ключевые проблемы

1. **Неполное соответствие целевому сценарию Star Citizen.** Встроенный список целей включает популярные сервисы (YouTube, Discord и т.д.), но не охватывает домены, необходимые для запуска и обновления Star Citizen.
2. **Недостаточное покрытие протоколов и портов игры.** Тесты ориентированы на веб-порты 80/443 и не проверяют возможные нестандартные TCP/UDP-порты Star Citizen.
3. **Сложный для новичков интерфейс.** Технические логи и многочисленные элементы отвлекают от ключевого результата — выводов и рекомендаций.
4. **Малозаметность отчёта и советов.** Итоговый блок `txtAnalysis` слишком мал и располагается внизу окна, из-за чего пользователь может пропустить важную информацию.
5. **Отсутствие автоматизации обхода блокировок.** Приложение диагностирует проблему, но не предлагает встроенных инструментов обхода (VPN, DPI-bypass и т.д.).

## Рекомендации по UX

- Перестроить интерфейс так, чтобы результаты и советы занимали центральное место и были заметны сразу после завершения теста.
- Скрыть или упростить технические элементы (таблицы шагов, подробный лог), оставив их в «режиме эксперта» либо на отдельной вкладке.
- Сделать статусы тестов максимально наглядными: использовать цветовую маркировку, простые формулировки и иконки (например, «ОК», «Ошибка», «Требует внимания»).
- Переработать тексты рекомендаций, избегая жаргона и добавляя краткие пояснения и примеры сервисов.
- Убедиться в полной русификации интерфейса, предоставить подсказки по назначению настроек.
- Предложить готовый сценарий «Star Citizen» с преднастроенными тестами и скрыть продвинутые опции по умолчанию.

## Расширение тестов для Star Citizen

- Добавить в список целей домены Star Citizen: основной сайт, сервера авторизации, обновлений и, по возможности, игровые шлюзы.
- Проверять характерные для игры порты (TCP и UDP), дополнительно к 80/443, чтобы выявлять блокировки нестандартных портов.
- Улучшить диагностику DNS именно для игровых доменов, подчёркивая случаи подмены или отсутствия записей.
- Обновить экспорт отчёта, добавив быстрые кнопки «Скопировать итог» или генерацию удобного для поддержки отчёта.
- Рассмотреть автоматический сбор адресов, используемых установленной игрой (через конфиги/логи лаунчера).

## Этап 2: автоматический обход блокировок

- Интегрировать WinDivert для реализации стратегий обхода DPI (например, блокировка RST-пакетов, фрагментация TLS ClientHello), аналогичных GoodbyeDPI.
- Добавить опциональное перенаправление трафика через прокси/VPN для адресов Star Citizen.
- Оснастить интерфейс кнопкой «Включить обход блокировок», отображать статус и запрашивать права администратора с понятным пояснением.
- Рассмотреть перенос GUI на веб-технологии (локальный веб-интерфейс или Electron) для ускорения UX-рефакторинга и упрощения обновлений.
- Ограничить область действия WinDivert-трафика только нужными адресами и портами, протестировать производительность и стабильность.

## Ожидаемый эффект

Реализация предложенных шагов превратит ISP Audit из диагностического инструмента в полноценного помощника для игроков Star Citizen: пользователь сразу получит ясный ответ о наличии блокировок, увидит понятные инструкции и сможет активировать автоматический обход без установки сторонних утилит.
