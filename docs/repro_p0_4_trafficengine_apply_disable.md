# P0.4 — сценарий воспроизведения: TrafficEngine Apply/Disable (GUI)

Цель: воспроизводимо нагрузить цепочку Apply/Disable (WinDivert/TrafficEngine) в GUI, чтобы поймать редкие зависания/краши.

## Предусловия

- Запуск **от имени администратора** (WinDivert требует admin).
- В качестве цели удобно использовать браузер: `msedge.exe` или `chrome.exe`.

## Шаги

1. Запустите ISP Audit **от имени администратора**.
2. В GUI нажмите **Обзор** и выберите `msedge.exe` или `chrome.exe`.
3. Нажмите **Запустить диагностику**.
4. В браузере откройте 3–5 вкладок с HTTPS-сайтами и обновите их несколько раз (нужен активный TLS-трафик).
5. Откройте панель оптимизации/обхода (bypass) в ISP Audit.
6. Выполняйте циклы **Apply → Disable** (или включение/выключение обхода) с частотой **~3–5 циклов/сек** в течение **30–60 секунд**.

## Что сохранить при зависании/краше

- Лог: `Logs/isp_audit_vm_*.log` (желательно целиком) и минимум ±100 строк вокруг последних сообщений `[Bypass]`/`[TrafficEngine]`/`Loop crashed`.
- Транзакции Apply/Disable: `state\\apply_transactions.json`.
- Crash-reports (если появились): `state\\crash_reports\\`.
- Любые экспортированные артефакты из `artifacts/`.

## Автоматизация (без GUI)

- Для автоматизированного стресс‑прогона используйте strict smoke `INFRA-010` (запуск через `SmokeLauncher`, чтобы избежать SKIP в strict при отсутствии admin).
