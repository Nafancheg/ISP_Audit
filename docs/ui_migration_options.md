# Перспективы миграции интерфейса на веб-технологии

## Цели миграции

- Объединить диагностику, рекомендации и управление обходом блокировок в едином современном интерфейсе.
- Упростить выпуск обновлений оформления без перекомпиляции основной логики.
- Разделить визуальный слой и сетевую диагностику для дальнейшего расширения (плагины, удалённый доступ).

## Варианты

### 1. Встроенный WebView2 (WinUI/WebView)
- **Плюсы:**
  - Минимальный размер дистрибутива (используется системный Edge WebView2).
  - Можно постепенно внедрять — размещать новые панели (обход, рекомендации) в веб-вью внутри WinForms.
  - Доступ к нативным API .NET (обновления отчётов, запуск проверок) через `postMessage`/`WebView2`-хост.
- **Минусы:**
  - Требуется наличие Edge WebView2 Runtime (начиная с Win10 1803 ставится автоматически, но нужно предусмотреть установщик).
  - Стилизация ограничена одной WebView-панелью — при желании поддерживать несколько окон придётся продумывать маршрутизацию.

### 2. Electron (или аналог Chromium + Node.js)
- **Плюсы:**
  - Полная автономность, одна кодовая база UI, можно переиспользовать на Linux/macOS.
  - Богатая экосистема, удобная разработка фронтенда (React/Vue/Svelte).
- **Минусы:**
  - Значительное увеличение размера (70–100 МБ).
  - Потребуется обвязка для вызова .NET (через gRPC/IPC), удорожание поддержки.
  - Для Windows-приложения «на месте» избыточно.

### 3. Гибрид: WinForms-хост + встроенный локальный веб-сервер
- **Плюсы:**
  - Сохраняется существующий exe, WebView загружает локальный SPA (HTML/JS) из ресурсов.
  - Можно использовать тот же интерфейс в CLI-режиме через локальный сервер (например, открыть в браузере).
- **Минусы:**
  - Необходимо управлять жизненным циклом сервера, безопасности (ограничить доступ только локальному хосту).
  - Дополнительная сложность деплоя (подпись, firewall-исключения).

## Рекомендации

1. **Краткосрочно:**
   - Внедрить панель обхода в WebView2 как отдельный SPA-компонент. Остальная форма остаётся WinForms. Это даст гибкость в дизайне и позволит протестировать веб-стек без полной миграции.
   - Вынести выдачу рекомендаций/советов в тот же WebView (одно окно), чтобы упростить редактирование контента.

2. **Среднесрочно:**
   - Подготовить API-слой (например, `IDiagnosticsService`), возвращающий JSON отчёты для UI. Это позволит подключать альтернативные оболочки (Electron, веб-интерфейс).
   - Сформировать дизайн-систему (компоненты/цвета) в виде фронтенд-проекта, собирать статические ресурсы и встраивать в exe.

3. **Долгосрочно:**
   - Рассмотреть полноценный гибрид (WinForms-host + локальный WebView) или Electron, если появится требование к кроссплатформенности и насыщенному UI.
   - Автоматизировать генерацию документации и обучающих подсказок прямо в веб-интерфейсе.

## Технические шаги для WebView2

1. Добавить зависимость `Microsoft.Web.WebView2` в проект.
2. Создать отдельный модуль `WebUiHost`, который:
   - Загружает статические файлы (HTML/JS/CSS) из ресурсов.
   - Связывает события (`RunChecks`, `ToggleBypass`) через `CoreWebView2.WebMessageReceived`.
3. Перенести блок рекомендаций и «Обход блокировок» в веб-шаблон.
4. Настроить hot-reload для фронтенда (например, Vite) и скрипт сборки, который кладёт бандл в `Resources`.

Такой подход позволит последовательно перейти к более гибкому UI без резкого переписывания WinForms-части.
