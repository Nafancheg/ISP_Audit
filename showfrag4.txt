    private void ShowResults(RunReport report)
    {
        // Анализируем результаты
        var summary = ReportWriter.BuildSummary(report);

        bool hasProblems = summary.dns == "WARN" ||
                          summary.dns == "DNS_FILTERED" ||
                          summary.dns == "DNS_BOGUS" ||
                          summary.tcp == "FAIL" ||
                          summary.tcp_portal == "FAIL" ||
                          summary.tcp_launcher == "FAIL" ||
                          summary.tcp_portal == "WARN" ||
                          summary.tcp_launcher == "WARN" ||
                          summary.tls == "MITM_SUSPECT" ||
                          summary.tls == "SUSPECT" ||
                          summary.tls == "FAIL";

        if (hasProblems)
        {
            WarningCard.Visibility = Visibility.Visible;
            SuccessCard.Visibility = Visibility.Collapsed;

            // Формируем текст предупреждения
            var warnings = new System.Collections.Generic.List<string>();

            if (summary.dns == "DNS_FILTERED" || summary.dns == "DNS_BOGUS")
            {
                warnings.Add("• DNS провайдера возвращает неправильные адреса серверов");
            }
            if (summary.tcp_portal == "FAIL")
            {
                warnings.Add("• RSI Portal (80/443) недоступен — не удастся скачать лаунчер");
            }
            else if (summary.tcp_portal == "WARN")
            {
                warnings.Add("• RSI Portal (80/443) частично доступен — возможны проблемы");
            }
            if (summary.tcp_launcher == "FAIL")
            {
                warnings.Add("• Лаунчер (8000-8020) заблокирован — игра не обновится");
            }
            else if (summary.tcp_launcher == "WARN")
            {
                warnings.Add("• Лаунчер (8000-8020) частично доступен — обновления могут зависать");
            }
            if (summary.tls == "MITM_SUSPECT")
            {
                warnings.Add("• ⚠ КРИТИЧНО: Обнаружена MITM-атака (подмена сертификатов)!");
            }
            else if (summary.tls == "SUSPECT" || summary.tls == "FAIL")
            {
                warnings.Add("• HTTPS-соединения блокируются или изменяются");
            }

            WarningText.Text = string.Join("\n", warnings) +
                "\n\nРекомендация: используйте VPN или включите защищённый DNS (DoH).";
        }
        else
        {
            SuccessCard.Visibility = Visibility.Visible;
            WarningCard.Visibility = Visibility.Collapsed;
        }

        StatusText.Text = hasProblems
            ? "Проверка завершена — обнаружены проблемы"
            : "Проверка завершена — всё работает!";
    }
}
