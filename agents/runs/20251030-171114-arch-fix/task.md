# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º ISP_Audit

–î–∞—Ç–∞: 2025-10-30
ID: 20251030-171114-arch-fix

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

QA Agent –æ–±–Ω–∞—Ä—É–∂–∏–ª 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã. –ü–æ—Å–ª–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ Angel vs Demon review –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ï –ø—Ä–æ–±–ª–µ–º—ã:

**–ü–†–û–ë–õ–ï–ú–ê #1: –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ—Ä—Ç–∞–ª –≤–º–µ—Å—Ç–æ –∏–≥—Ä—ã**
- `star_citizen_targets.json` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `robertsspaceindustries.com` (–ø–æ—Ä—Ç–∞–ª –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
- –ü–æ—Ä—Ç–∞–ª –ù–ï –Ω—É–∂–µ–Ω –¥–ª—è –∏–≥—Ä—ã (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 1 —Ä–∞–∑ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
- –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã: Launcher CDN, AWS game servers, Vivox voice chat

**–ü–†–û–ë–õ–ï–ú–ê #2: DNS - –∫–æ—Ä–µ–Ω—å 80% –ø—Ä–æ–±–ª–µ–º**
- `DnsTest.cs` —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–π (DoH comparison –¥–∞—ë—Ç false positives –∏–∑-–∑–∞ CDN)
- –ù–µ—Ç –∫–Ω–æ–ø–∫–∏ "FIX DNS" (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ —Å–∞–º–æ–º—É –∏—Å–∫–∞—Ç—å –∫–∞–∫ —Å–º–µ–Ω–∏—Ç—å DNS)
- VPN —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ü–ï–†–í–´–ú —Å—Ä–µ–¥—Å—Ç–≤–æ–º (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–û–°–õ–ï–î–ù–ò–ú)

**–ü–†–û–ë–õ–ï–ú–ê #3: –ë–µ—Å–ø–æ–ª–µ–∑–Ω—ã–µ —Ç–µ—Å—Ç—ã**
- `FirewallTest.cs`, `IspTest.cs`, `RouterTest.cs`, `SoftwareTest.cs` - –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–µ —Ç–æ

**–ü–†–û–ë–õ–ï–ú–ê #4: –•–∞—Ä–¥–∫–æ–¥ endpoints —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç**
- Star Citizen –º–µ–Ω—è–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É ‚Üí targets.json —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–º
- –ù—É–∂–µ–Ω WinDivert —Å–Ω–∏—Ñ—Ñ–µ—Ä –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è endpoints

**–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å**: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –†–ï–ê–õ–¨–ù–û –ø–æ–º–æ–≥–∞—Ç—å –∏–≥—Ä–æ–∫–∞–º Star Citizen –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.

## –¶–µ–ª—å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –®–ê–ì 1: DNS Fix (–ü–†–ò–û–†–ò–¢–ï–¢ 1, 2-3 —á–∞—Å–∞)
1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å `DnsTest.cs` (System DNS empty = DNS_FILTERED, DoH —Ç–æ–ª—å–∫–æ –¥–ª—è display)
2. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ "üîß FIX DNS" –∏ "‚Ü©Ô∏è ROLLBACK DNS" –≤ GUI
3. Fix DNS —Ä–∞–±–æ—Ç–∞–µ—Ç 1 –∫–ª–∏–∫–æ–º (PowerShell ‚Üí Cloudflare 1.1.1.1)
4. VPN —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ü–û–°–õ–ï–î–ù–ò–ú —Å—Ä–µ–¥—Å—Ç–≤–æ–º

### –®–ê–ì 2: –£–¥–∞–ª–µ–Ω–∏–µ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–ü–†–ò–û–†–ò–¢–ï–¢ 2, 1-2 —á–∞—Å–∞)
1. –£–¥–∞–ª–∏—Ç—å: `FirewallTest.cs`, `IspTest.cs`, `RouterTest.cs`, `SoftwareTest.cs`
2. –£–±—Ä–∞—Ç—å –∏–∑ `AuditRunner.cs` –∏ GUI

### –®–ê–ì 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TcpTest (–ü–†–ò–û–†–ò–¢–ï–¢ 3, 2-3 —á–∞—Å–∞)
1. –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å `star_citizen_targets.json`:
   - –£–±—Ä–∞—Ç—å `robertsspaceindustries.com` (–ø–æ—Ä—Ç–∞–ª)
   - –î–æ–±–∞–≤–∏—Ç—å `install.robertsspaceindustries.com` (Launcher CDN)
   - –î–æ–±–∞–≤–∏—Ç—å AWS game servers, Vivox voice chat
2. –î–æ–±–∞–≤–∏—Ç—å `critical: bool` –≤ `TargetModels.cs`
3. –£–±—Ä–∞—Ç—å early-exit –¥–ª—è critical –≤ `AuditRunner.cs` (fallback IPs)
4. –£—á–∏—Ç—ã–≤–∞—Ç—å `critical` –≤ `ReportWriter.cs` (verdict)

### –®–ê–ì 4: WinDivert —Å–Ω–∏—Ñ—Ñ–µ—Ä (–ü–†–ò–û–†–ò–¢–ï–¢ 4, 8-10 —á–∞—Å–æ–≤)
1. –°–æ–∑–¥–∞—Ç—å `Utils/TrafficSniffer.cs` (WinDivert wrapper)
2. –°–æ–∑–¥–∞—Ç—å `Utils/EndpointClassifier.cs` (CDN/Game/Voice/API)
3. –°–æ–∑–¥–∞—Ç—å `Utils/ProfileManager.cs` (save/load JSON profiles)
4. –°–æ–∑–¥–∞—Ç—å `Wpf/SnifferWindow.xaml` (GUI "–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è")
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `MainWindow`
6. Disclaimer –æ WinDivert/–∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞—Ö

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:
- `dotnet build` —É—Å–ø–µ—à–µ–Ω
- GUI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –ö–Ω–æ–ø–∫–∞ "FIX DNS" —Ä–∞–±–æ—Ç–∞–µ—Ç (UAC, –º–µ–Ω—è–µ—Ç DNS –Ω–∞ 1.1.1.1)
- –ö–Ω–æ–ø–∫–∞ "ROLLBACK DNS" –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ DNS
- –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç launcher/AWS/Vivox (–ù–ï –ø–æ—Ä—Ç–∞–ª)
- –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
- –°–Ω–∏—Ñ—Ñ–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç endpoints –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π (UdpProbeRunner, TracerouteTest, RstHeuristic —Ä–∞–±–æ—Ç–∞—é—Ç)

## –û–±—ä—ë–º –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –í scope:
- –£–ø—Ä–æ—â–µ–Ω–∏–µ DnsTest (–ª–æ–≥–∏–∫–∞ + GUI –∫–Ω–æ–ø–∫–∏)
- –£–¥–∞–ª–µ–Ω–∏–µ 4 –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ–¥–µ–ª–∫–∞ targets.json (—É–±—Ä–∞—Ç—å –ø–æ—Ä—Ç–∞–ª, –¥–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ critical —Ñ–ª–∞–≥–∞ –∏ fallback IPs
- WinDivert —Å–Ω–∏—Ñ—Ñ–µ—Ä (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)

### –í–Ω–µ scope:
- HttpTest review (–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å)
- Community profiles / GitHub integration (–±—É–¥—É—â–µ–µ)
- –ü—Ä–µ—Å–µ—Ç—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏–≥—Ä (–±—É–¥—É—â–µ–µ)
- Code signing —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: .NET 9.0, WPF, MaterialDesign, WinDivert 2.x
- **Async/await**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å CancellationToken
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è (breaking changes)
- **WinDivert**: –¢—Ä–µ–±—É–µ—Ç –∞–¥–º–∏–Ω–∞, –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –º–æ–≥—É—Ç —Ä—É–≥–∞—Ç—å—Å—è
- **–í—Ä–µ–º—è**: ~13-18 —á–∞—Å–æ–≤

### –†–∏—Å–∫–∏:
1. WinDivert –∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã ‚Üí Disclaimer + README
2. PowerShell UAC prompt ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ + fallback
3. AWS endpoints geo-block ‚Üí `critical: false` –¥–ª—è –Ω–µ-EU
4. Launcher CDN –∞–¥—Ä–µ—Å–∞ –º–µ–Ω—è—é—Ç—Å—è ‚Üí Fallback IPs + —Å–Ω–∏—Ñ—Ñ–µ—Ä

### –û—Ü–µ–Ω–∫–∞: LARGE (13-18 —á–∞—Å–æ–≤)

## –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: research.md
- –ü–ª–∞–Ω: plan.md
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: implementation.md
- –†–µ–≤—å—é: review.md
- –¢–µ—Å—Ç-–ø–ª–∞–Ω: qa_test_plan.md
- –¢–µ—Å—Ç-–æ—Ç—á—ë—Ç: qa_report.md
- Changelog: changelog.md
- –†–µ—à–µ–Ω–∏—è: ../../qa_agent/improvements_discussed.md (107K tokens, –£–ñ–ï –°–£–©–ï–°–¢–í–£–ï–¢)

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

**–í–°–ï —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏** –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤:
üìÑ `agents/qa_agent/improvements_discussed.md`

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
- Angel vs Demon debate (–ø–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)
- –í—Å–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ DnsTest (–∫–æ–¥ Fix/Rollback –∫–Ω–æ–ø–æ–∫)
- –í—Å–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ TcpTest (targets.json —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- WinDivert —Åniffer –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (TrafficSniffer.cs, EndpointClassifier.cs, ProfileManager.cs)
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (–®–ê–ì 1-4 —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏)

**–ê–≥–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã —á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª!**
