# Агентная методология разработки ISP_Audit

Этот каталог содержит результаты работы специализированных агентов на каждом этапе разработки.

## Схема работы

```
[1] Task Owner      → Постановка задачи (1 раз в начале сессии)
[2] Research Agent  → Исследование кода и проблем (1 раз, тяжёлый)
[3] Planning Agent  → Детальный план реализации (1 раз, тяжёлый)
[4] Coding Agent    → Реализация по плану (N раз, ЛЁГКИЕ агенты)
[5] Review Agent    → Код-ревью (опционально, можно объединить с Coding)
[6] QA Agent        → Функциональное тестирование (перед коммитом)
[7] Delivery Agent  → Коммит и релиз (в конце сессии)
```

## Принципы экономии Plan Usage Limits

**ВАЖНО**: Цель методологии - экономия **Plan Usage Limits** (лимит запросов/час в Claude), а не токенов контекста!

### Проблема линейной работы
- Claude держит весь контекст проекта (~80k+ токенов)
- Каждый ответ = полный контекст × стоимость запроса
- 10 ответов подряд = 10 × весь контекст = **быстрое исчерпание лимита**

### Решение: Агентная работа

#### Этап 1: Тяжёлые агенты (1 раз в начале)
- **Research Agent** (Explore, "very thorough"): полный аудит проекта → `findings.md`
- **Planning Agent** (Plan): приоритизация задач → `plan.md`
- **Стоимость**: ~20-30% лимита, но делается 1 раз

#### Этап 2: Лёгкие Coding агенты (основная работа)
- **Узкая задача**: "исправь файл X по плану Y"
- **Минимальный контекст**: агент читает только 1-2 файла
- **Быстрый результат**: patch или новый код
- **Стоимость**: ~2-5% лимита за задачу
- **Количество**: можно выполнить 10-15 задач за сессию

#### Этап 3: Финализация
- **Review/QA** (опционально): быстрая проверка
- **Delivery**: changelog + коммит

### Экономия
- **Без агентов**: 10 задач = 10 × 80k контекста = 70-80% лимита
- **С агентами**: 2 тяжёлых (30%) + 10 лёгких (30%) = 60% лимита + больше работы выполнено

## Правила использования агентов

1. **Research/Planning - СТРОГО 1 раз** в начале сессии
2. **Coding Agent - много раз**, каждый с узкой задачей:
   - ✅ "Исправь DNS Test: добавь retry для DoH (файл Tests/DnsTest.cs, строки 51-96)"
   - ❌ "Исправь все тесты" (слишком широко)
3. **Сохранять в файлы** только важные результаты (findings, plan, changelog)
4. **Не создавать** промежуточные файлы для каждой мелкой задачи

## Текущая задача

См. [task_owner/current_task.md](task_owner/current_task.md)

## История задач

См. [delivery_agent/changelog.md](delivery_agent/changelog.md)
