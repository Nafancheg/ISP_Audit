# –û–±—Å—É–∂–¥–µ–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π —Ç–µ—Å—Ç–æ–≤ (–ê–Ω–≥–µ–ª vs –î–µ–º–æ–Ω)

**–î–∞—Ç–∞**: 2025-10-30  
**–£—á–∞—Å—Ç–Ω–∏–∫–∏**: User (–î–µ–º–æ–Ω) + AI (–ê–Ω–≥–µ–ª)

---

## –¢–ï–°–¢ 1: DnsTest - –î–û–ì–û–í–û–†–Å–ù–ù–û–°–¢–ò

### –ü—Ä–æ–±–ª–µ–º—ã (–Ω–∞–π–¥–µ–Ω–Ω—ã–µ –î–µ–º–æ–Ω–æ–º):
1. ‚ùå **Cloudflare –Ω–µ —Å–≤—è–∑–∞–Ω —Å –∏–≥—Ä–æ–π** - DoH –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–º–µ–Ω—ã
2. ‚ùå **Cloudflare –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω** –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
3. ‚ùå **–†–∞–∑–Ω—ã–µ IP CDN** (99.84.91.103 vs 99.84.91.100) - —ç—Ç–æ –ù–û–†–ú–ê, –Ω–µ –ø–æ–¥–º–µ–Ω–∞
4. ‚ùå **–ü–ª–æ–¥–∏–º —Å—É—â–Ω–æ—Å—Ç–∏** - –∑–∞—á–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å DoH –µ—Å–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ System DNS?

### –†–ï–®–ï–ù–ò–ï:
**–£–ø—Ä–æ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É:**
```csharp
// –ï—Å–ª–∏ System DNS –ø—É—Å—Ç ‚Üí –ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç
if (system_dns.Count == 0)
    return DnsStatus.DNS_FILTERED;

// –ï—Å–ª–∏ System DNS –≤–µ—Ä–Ω—É–ª –º—É—Å–æ—Ä (0.0.0.0, 127.x) ‚Üí —è–≤–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
if (system_dns.Any(ip => ip == "0.0.0.0" || ip.StartsWith("127.")))
    return DnsStatus.DNS_BOGUS;

// –ï—Å–ª–∏ System DNS –≤–µ—Ä–Ω—É–ª –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ ‚Üí OK
return DnsStatus.OK;
```

**DoH –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** (–ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é "–Ω–∞—Å—Ç–æ—è—â–∏–π –∞–¥—Ä–µ—Å"), –Ω–æ –ù–ï –¥–ª—è –ª–æ–≥–∏–∫–∏.

---

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø—Ä–∏ DNS_FILTERED:

**–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Å—Ç–∞—Ä–æ–µ):**
```
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–π VPN –∏–ª–∏ —Å–º–µ–Ω–∏ DNS
```

**–ü–†–ê–í–ò–õ–¨–ù–û (–Ω–æ–≤–æ–µ):**
```
DNS_FILTERED –æ–±–Ω–∞—Ä—É–∂–µ–Ω
–ü—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç DNS –∑–∞–ø—Ä–æ—Å—ã

–†–ï–®–ï–ù–ò–ï:
[–ö–Ω–æ–ø–∫–∞: üîß –ò–°–ü–†–ê–í–ò–¢–¨ DNS (1 –∫–ª–∏–∫)]

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏:
1. –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (UAC)
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å PowerShell:
   Set-DnsClientServerAddress -InterfaceAlias 'Wi-Fi' -ServerAddresses ('1.1.1.1','8.8.8.8')
3. –ü–æ–∫–∞–∑–∞—Ç—å "DNS –∏–∑–º–µ–Ω—ë–Ω. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç."

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞):
–°—Å—ã–ª–∫–∞: https://www.howtogeek.com/765940/how-to-enable-dns-over-https-on-windows-11/

–ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≥–ª—É–±–∂–µ (DPI), –Ω—É–∂–µ–Ω VPN.
```

**–ö–õ–Æ–ß–ï–í–û–ï:** VPN - —ç—Ç–æ **–ü–û–°–õ–ï–î–ù–ï–ï** —Å—Ä–µ–¥—Å—Ç–≤–æ, –Ω–µ –ø–µ—Ä–≤–æ–µ!

---

## –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### 1. Tests/DnsTest.cs
**–£–ø—Ä–æ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É** (—É–±—Ä–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç DoH –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞)

### 2. MainWindow.xaml
**–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ "–ò–°–ü–†–ê–í–ò–¢–¨ DNS" –∏ "–í–ï–†–ù–£–¢–¨ DNS"** –≤ –∫–∞—Ä—Ç–æ—á–∫—É DNS_FILTERED

```xml
<!-- –ü—Ä–∏ DNS_FILTERED –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫–∏ -->
<StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,12,0,0">
    <Button x:Name="FixDnsButton"
            Content="üîß –ò–°–ü–†–ê–í–ò–¢–¨ DNS (1 –∫–ª–∏–∫)"
            Click="FixDnsButton_Click"
            Background="#4CAF50"
            Foreground="White"
            Padding="12,8"
            FontSize="14"
            FontWeight="Bold"
            Margin="0,0,12,0"/>
    
    <Button x:Name="ResetDnsButton"
            Content="‚Ü©Ô∏è –í–ï–†–ù–£–¢–¨ –ö–ê–ö –ë–´–õ–û"
            Click="ResetDnsButton_Click"
            Background="#FF9800"
            Foreground="White"
            Padding="12,8"
            FontSize="14"
            FontWeight="Bold"
            Visibility="Collapsed"/>
</StackPanel>
```

**–õ–æ–≥–∏–∫–∞:**
1. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ "–ò–°–ü–†–ê–í–ò–¢–¨ DNS"
2. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è DNS ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–í–ï–†–ù–£–¢–¨ –ö–ê–ö –ë–´–õ–û"
3. –ü–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞ ‚Üí –∫–Ω–æ–ø–∫–∞ "–í–ï–†–ù–£–¢–¨" —Å–Ω–æ–≤–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

### 3. MainWindow.xaml.cs
**–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã `FixDnsButton_Click` –∏ `ResetDnsButton_Click`**:

```csharp
// –ü–ï–†–ï–î –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ DNS
private List<string>? _originalDnsServers = null;
private string? _adapterName = null;

private async void FixDnsButton_Click(object sender, RoutedEventArgs e)
{
    try
    {
        // 1. –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ã–π –∞–¥–∞–ø—Ç–µ—Ä
        var adapter = NetworkInterface.GetAllNetworkInterfaces()
            .FirstOrDefault(n => n.OperationalStatus == OperationalStatus.Up 
                              && n.NetworkInterfaceType != NetworkInterfaceType.Loopback);
        
        if (adapter == null)
        {
            MessageBox.Show("–ê–∫—Ç–∏–≤–Ω—ã–π –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω");
            return;
        }
        
        _adapterName = adapter.Name;
        
        // 2. –°–û–•–†–ê–ù–ò–¢–¨ —Ç–µ–∫—É—â–∏–µ DNS (–¥–ª—è –æ—Ç–∫–∞—Ç–∞)
        var ipProps = adapter.GetIPProperties();
        _originalDnsServers = ipProps.DnsAddresses
            .Where(ip => ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork)
            .Select(ip => ip.ToString())
            .ToList();
        
        if (_originalDnsServers.Count == 0)
        {
            _originalDnsServers = new List<string> { "DHCP" }; // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        }
        
        // 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å PowerShell –¥–ª—è —Å–º–µ–Ω—ã DNS
        var psi = new ProcessStartInfo
        {
            FileName = "powershell.exe",
            Arguments = $"-Command \"Set-DnsClientServerAddress -InterfaceAlias '{adapter.Name}' -ServerAddresses ('1.1.1.1','8.8.8.8')\"",
            Verb = "runas", // UAC prompt
            UseShellExecute = true
        };
        
        var process = Process.Start(psi);
        await process.WaitForExitAsync();
        
        if (process.ExitCode == 0)
        {
            MessageBox.Show(
                "DNS –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ Cloudflare (1.1.1.1).\n\n" +
                "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.\n\n" +
                "–î–ª—è –æ—Ç–∫–∞—Ç–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É '–í–µ—Ä–Ω—É—Ç—å DNS'.", 
                "–ì–æ—Ç–æ–≤–æ", MessageBoxButton.OK, MessageBoxImage.Information);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É "–í–ï–†–ù–£–¢–¨ DNS"
            ResetDnsButton.Visibility = Visibility.Visible;
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show($"–û—à–∏–±–∫–∞: {ex.Message}", "–û—à–∏–±–∫–∞", MessageBoxButton.OK, MessageBoxImage.Error);
    }
}

private async void ResetDnsButton_Click(object sender, RoutedEventArgs e)
{
    if (_originalDnsServers == null || _adapterName == null)
    {
        MessageBox.Show("–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –æ—Ç–∫–∞—Ç–∞");
        return;
    }
    
    try
    {
        string command;
        
        if (_originalDnsServers.Contains("DHCP"))
        {
            // –í–µ—Ä–Ω—É—Ç—å –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ (DHCP)
            command = $"-Command \"Set-DnsClientServerAddress -InterfaceAlias '{_adapterName}' -ResetServerAddresses\"";
        }
        else
        {
            // –í–µ—Ä–Ω—É—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ DNS
            var dnsString = string.Join("','", _originalDnsServers);
            command = $"-Command \"Set-DnsClientServerAddress -InterfaceAlias '{_adapterName}' -ServerAddresses ('{dnsString}')\"";
        }
        
        var psi = new ProcessStartInfo
        {
            FileName = "powershell.exe",
            Arguments = command,
            Verb = "runas",
            UseShellExecute = true
        };
        
        var process = Process.Start(psi);
        await process.WaitForExitAsync();
        
        if (process.ExitCode == 0)
        {
            MessageBox.Show("DNS –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.", "–ì–æ—Ç–æ–≤–æ", MessageBoxButton.OK, MessageBoxImage.Information);
            ResetDnsButton.Visibility = Visibility.Collapsed;
            _originalDnsServers = null;
            _adapterName = null;
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show($"–û—à–∏–±–∫–∞: {ex.Message}", "–û—à–∏–±–∫–∞", MessageBoxButton.OK, MessageBoxImage.Error);
    }
}
```

---

## –°–¢–ê–¢–£–°: ‚è≥ –í –û–ë–°–£–ñ–î–ï–ù–ò–ò

---

## –¢–ï–°–¢ 2: TcpTest - –î–û–ì–û–í–û–†–Å–ù–ù–û–°–¢–ò

### –ü—Ä–æ–±–ª–µ–º—ã (–Ω–∞–π–¥–µ–Ω–Ω—ã–µ –î–µ–º–æ–Ω–æ–º):
1. ‚ùå **–ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Ä—Ç–∞–ª, –∞ –Ω–µ –∏–≥—Ä—É** - robertsspaceindustries.com –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. ‚ùå **–ü–æ—Ä—Ç—ã 8000-8003 –Ω–∞ –ø–æ—Ä—Ç–∞–ª–µ –ù–ï —Å—É—â–µ—Å—Ç–≤—É—é—Ç** - —ç—Ç–æ –≤–µ–±-—Å–∞–π—Ç, –∞ –Ω–µ –∏–≥—Ä–æ–≤–æ–π —Å–µ—Ä–≤–µ—Ä
3. ‚ùå **–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ–º launcher** - install.robertsspaceindustries.com (–æ—Ç–∫—É–¥–∞ –ø–∞—Ç—á–∏?)
4. ‚ùå **–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–≥—Ä–æ–≤—ã–µ —Å–µ—Ä–≤–µ—Ä—ã** - AWS endpoints (eu-central-1, us-east-1)
5. ‚ùå **–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ–º Vivox** - voice chat (viv.vivox.com)
6. ‚ùå **Early-exit –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–æ—Ä—Ç—ã** - –µ—Å–ª–∏ DNS –ø—É—Å—Ç ‚Üí TCP –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

### –†–ï–®–ï–ù–ò–ï:

**–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å star_citizen_targets.json:**

**–£–ë–†–ê–¢–¨:**
```json
{
  "name": "RSI –ü–æ—Ä—Ç–∞–ª (–ü–æ—Ä—Ç–∞–ª)",
  "host": "robertsspaceindustries.com",
  "service": "–ü–æ—Ä—Ç–∞–ª"  // ‚Üê –ù–ï –ù–£–ñ–ï–ù –î–õ–Ø –ò–ì–†–´!
}
```

**–î–û–ë–ê–í–ò–¢–¨:**
```json
{
  "name": "Launcher CDN",
  "host": "install.robertsspaceindustries.com",
  "service": "Launcher",
  "description": "–û—Ç–∫—É–¥–∞ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –ø–∞—Ç—á–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è",
  "tcp_ports_checked": [80, 443],
  "critical": true
},
{
  "name": "AWS EU Central (Game Servers)",
  "host": "ec2.eu-central-1.amazonaws.com",
  "service": "Game Servers",
  "description": "–ò–≥—Ä–æ–≤—ã–µ —Å–µ—Ä–≤–µ—Ä—ã EU —Ä–µ–≥–∏–æ–Ω–∞",
  "tcp_ports_checked": [8000, 8001, 8002, 8003],
  "critical": true
},
{
  "name": "AWS US East (Game Servers)",
  "host": "ec2.us-east-1.amazonaws.com",
  "service": "Game Servers",
  "tcp_ports_checked": [8000, 8001, 8002, 8003],
  "critical": false
},
{
  "name": "Vivox Voice Chat",
  "host": "viv.vivox.com",
  "service": "Voice Chat",
  "description": "–ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç –≤ –∏–≥—Ä–µ",
  "tcp_ports_checked": [443, 5060, 5061],
  "udp_ports_checked": [3478, 5060, 5061],
  "critical": true
}
```

**–õ–æ–≥–∏–∫–∞ critical:**
- `critical: true` ‚Üí –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí playable = "NO"
- `critical: false` ‚Üí –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí playable = "MAYBE" (–º–æ–∂–Ω–æ –∏–≥—Ä–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–∏—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö)

---

### –£–±—Ä–∞—Ç—å Early-Exit –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ü–µ–ª–µ–π

**–ü–†–û–ë–õ–ï–ú–ê (AuditRunner.cs —Å—Ç—Ä–æ–∫–∏ 67-82):**
```csharp
bool dnsCompleteFail = targetReport.dns_enabled &&
    targetReport.system_dns.Count == 0 &&
    targetReport.doh.Count == 0;

if (dnsCompleteFail)
{
    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º TCP/HTTP/Trace
    targetReport.tcp_enabled = false;
    targetReport.http_enabled = false;
    targetReport.trace_enabled = false;
}
```

**–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
```csharp
bool dnsCompleteFail = targetReport.dns_enabled &&
    targetReport.system_dns.Count == 0 &&
    targetReport.doh.Count == 0;

if (dnsCompleteFail)
{
    // –ï—Å–ª–∏ —Ü–µ–ª—å –∫—Ä–∏—Ç–∏—á–Ω–∞ ‚Üí –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º TCP –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º IP
    if (def.critical)
    {
        // –ü—Ä–æ–±—É–µ–º –∏–∑–≤–µ—Å—Ç–Ω—ã–µ IP (–∏–∑ –∫—ç—à–∞, hardcoded, –∏–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤)
        var fallbackIPs = GetKnownIPsForHost(def.Host);
        if (fallbackIPs.Count > 0)
        {
            targetReport.system_dns = fallbackIPs;
            // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º TCP/HTTP —Ç–µ—Å—Ç—ã
        }
        else
        {
            // DNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –Ω–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö IP ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            targetReport.tcp_enabled = false;
            targetReport.http_enabled = false;
        }
    }
    else
    {
        // –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–∞—è —Ü–µ–ª—å ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
        targetReport.tcp_enabled = false;
        targetReport.http_enabled = false;
    }
}
```

---

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **star_citizen_targets.json** - –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–π (—É–±—Ä–∞—Ç—å –ø–æ—Ä—Ç–∞–ª, –¥–æ–±–∞–≤–∏—Ç—å launcher/AWS/Vivox)
2. **TargetModels.cs** - –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `critical: bool`
3. **AuditRunner.cs** - —É–±—Ä–∞—Ç—å early-exit –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ü–µ–ª–µ–π, –¥–æ–±–∞–≤–∏—Ç—å fallback IP
4. **ReportWriter.cs** - —É—á–∏—Ç—ã–≤–∞—Ç—å `critical` —Ñ–ª–∞–≥ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ playable

---

## –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–û–ï –û–¢–ö–†–´–¢–ò–ï: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç! üéØ

### –ü—Ä–æ–±–ª–µ–º–∞ —Ö–∞—Ä–¥–∫–æ–¥–∞ —Ü–µ–ª–µ–π:
1. ‚ùå **–•–∞—Ä–¥–∫–æ–¥ —Ö–æ—Å—Ç–æ–≤** —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
2. ‚ùå **–ù–µ –æ—Ç–ª–∏—á–∞–µ–º provider block –æ—Ç geo-block** (AWS –±–ª–æ–∫–∏—Ä—É–µ—Ç –†–§ vs –ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç AWS)
3. ‚ùå **–†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è Star Citizen** - –∞ —á—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–≥—Ä–∞–µ—Ç –≤ MSFS, Warzone, Battlefield?

### –†–ï–®–ï–ù–ò–ï: –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

---

## –†–ï–ñ–ò–ú 1: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–Ω–∏—Ñ—Ñ–µ—Ä "–ê–Ω–∞–ª–∏–∑ –∏–≥—Ä—ã" üéÆ

**GUI:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üéÆ –†–ï–ñ–ò–ú: –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –í—ã–±–µ—Ä–∏—Ç–µ EXE —Ñ–∞–π–ª –∏–≥—Ä—ã/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:             ‚îÇ
‚îÇ  [üìÅ –í—ã–±—Ä–∞—Ç—å...] –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞           ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Ö–æ—Å—Ç –≤—Ä—É—á–Ω—É—é:                      ‚îÇ
‚îÇ  [youtube.com          ] [+ –î–æ–±–∞–≤–∏—Ç—å]          ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ üöÄ Star Citizen (–ø—Ä–µ—Å–µ—Ç)                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úàÔ∏è  Microsoft Flight Simulator (–ø—Ä–µ—Å–µ—Ç)  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ üéØ Call of Duty: Warzone (–ø—Ä–µ—Å–µ—Ç)       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ üì∫ YouTube (–ø—Ä–µ—Å–µ—Ç)                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ üé¨ Netflix (–ø—Ä–µ—Å–µ—Ç)                     ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  [üîç –ù–ê–ß–ê–¢–¨ –ê–ù–ê–õ–ò–ó –¢–†–ê–§–ò–ö–ê]                    ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:                                    ‚îÇ
‚îÇ  1. –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∏–ª–∏ –≤—ã      ‚îÇ
‚îÇ     –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –≤—Ä—É—á–Ω—É—é)                        ‚îÇ
‚îÇ  2. –°–Ω–∏—Ñ–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ 60 —Å–µ–∫—É–Ω–¥                   ‚îÇ
‚îÇ  3. –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ endpoints (IP:Port)            ‚îÇ
‚îÇ  4. –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç (CDN, Game, Voice, API)    ‚îÇ
‚îÇ  5. –¢–ï–°–¢–ò–†–£–ï–¢ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ endpoint     ‚îÇ
‚îÇ  6. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ß–¢–û –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ              ‚îÇ
‚îÇ  7. –î–∞—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (Fix DNS, VPN, etc)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è **–ª—é–±–æ–π** –∏–≥—Ä—ã/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ - –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –†–ï–ê–õ–¨–ù–´–ï –ø—Ä–æ–±–ª–µ–º—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ú–æ–∂–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–§–∞–π–ª—ã:**
- `Utils/TrafficSniffer.cs` - WinDivert sniffer
- `Utils/EndpointClassifier.cs` - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–æ—Ä—Ç–∞–º/SNI
- `Utils/ProfileExporter.cs` - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å endpoints –≤ JSON

---

## –†–ï–ñ–ò–ú 2: –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Ö–æ—Å—Ç–∞ üåê

**GUI:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üåê –†–ï–ñ–ò–ú: –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Ö–æ—Å—Ç–∞                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –í–≤–µ–¥–∏—Ç–µ hostname –∏–ª–∏ IP:                       ‚îÇ
‚îÇ  [youtube.com          ]                        ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –ü–æ—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):                           ‚îÇ
‚îÇ  [80, 443              ] (–∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç–æ)  ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  [üß™ –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨]                            ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:                                     ‚îÇ
‚îÇ  ‚úÖ DNS —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ (System DNS vs DoH)          ‚îÇ
‚îÇ  ‚úÖ TCP –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (—É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã)          ‚îÇ
‚îÇ  ‚úÖ HTTPS (–µ—Å–ª–∏ –ø–æ—Ä—Ç 443)                      ‚îÇ
‚îÇ  ‚úÖ UDP (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã UDP –ø–æ—Ä—Ç—ã)               ‚îÇ
‚îÇ  ‚úÖ Traceroute (–ø—É—Ç—å –¥–æ —Ö–æ—Å—Ç–∞)                 ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –†–µ–∑—É–ª—å—Ç–∞—Ç:                                     ‚îÇ
‚îÇ  ‚úÖ youtube.com ‚Üí 142.250.185.46               ‚îÇ
‚îÇ  ‚úÖ TCP:443 ‚Üí OK (24ms)                        ‚îÇ
‚îÇ  ‚úÖ HTTPS ‚Üí OK (certificate valid)             ‚îÇ
‚îÇ  ‚úÖ Traceroute ‚Üí 8 hops, no packet loss        ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –í–µ—Ä–¥–∏–∫—Ç: ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç "–Ω–∞ –∫–æ–ª–µ–Ω–∫–µ"
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ü–æ–Ω—è—Ç–µ–Ω –ª—é–±–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (—Å–∫–∞–∂–∏ –∫–ª–∏–µ–Ω—Ç—É: "–≤–≤–µ–¥–∏ youtube.com –∏ –Ω–∞–∂–º–∏ —Ç–µ—Å—Ç")

---

## –†–ï–ñ–ò–ú 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ—Å–µ—Ç–∞ üìã

**GUI:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìã –†–ï–ñ–ò–ú: –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å:                              ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  üöÄ Star Citizen (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)                  ‚îÇ
‚îÇ     - Launcher CDN                             ‚îÇ
‚îÇ     - AWS Game Servers (EU/US)                 ‚îÇ
‚îÇ     - Vivox Voice Chat                         ‚îÇ
‚îÇ     –û–±–Ω–æ–≤–ª—ë–Ω: 2025-10-25                       ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚úàÔ∏è  Microsoft Flight Simulator (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)   ‚îÇ
‚îÇ     - Azure CDN                                ‚îÇ
‚îÇ     - Azure Traffic Manager                    ‚îÇ
‚îÇ     - Bing Maps API                            ‚îÇ
‚îÇ     –û–±–Ω–æ–≤–ª—ë–Ω: 2025-10-20                       ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å (.json)             ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  üåç –°–∫–∞—á–∞—Ç—å —Å GitHub (community profiles)      ‚îÇ
‚îÇ     - Star Citizen (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π)                ‚îÇ
‚îÇ     - Call of Duty: Warzone                    ‚îÇ
‚îÇ     - Battlefield 2042                         ‚îÇ
‚îÇ     - PUBG                                     ‚îÇ
‚îÇ     - Apex Legends                             ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  [üì• –ó–ê–ì–†–£–ó–ò–¢–¨ –ò –¢–ï–°–¢–ò–†–û–í–ê–¢–¨]                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–æ—Ñ–∏–ª—å —Ñ–æ—Ä–º–∞—Ç:**
```json
{
  "name": "Star Citizen",
  "version": "3.21.0",
  "updated": "2025-10-25",
  "author": "community",
  "targets": [
    {
      "name": "Launcher CDN",
      "host": "install.robertsspaceindustries.com",
      "ips": ["151.101.2.3"], // fallback –µ—Å–ª–∏ DNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
      "tcp_ports": [443],
      "critical": true,
      "type": "CDN"
    },
    {
      "name": "AWS Game Server (EU)",
      "ips": ["3.21.45.67", "3.21.45.68"],
      "tcp_ports": [8000, 8001, 8002, 8003],
      "critical": true,
      "type": "GameServer",
      "note": "May be geo-blocked outside EU"
    }
  ]
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ Community-driven –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–Ω–∏—Ñ–∏–Ω–≥–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å)
- ‚úÖ –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –î–û –ø–æ–∫—É–ø–∫–∏ –∏–≥—Ä—ã ("–∫—É–ø–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç?")
- ‚úÖ GitHub Releases ‚Üí –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π

---

## –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

```
ISP_Audit
‚îú‚îÄ‚îÄ –†–µ–∂–∏–º 1: –°–Ω–∏—Ñ—Ñ–µ—Ä (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ª—é–±–æ–π EXE ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å
‚îÇ
‚îú‚îÄ‚îÄ –†–µ–∂–∏–º 2: –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
‚îÇ   ‚îî‚îÄ‚îÄ –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–¥–∏–Ω —Ö–æ—Å—Ç/IP
‚îÇ
‚îî‚îÄ‚îÄ –†–µ–∂–∏–º 3: –ü—Ä–µ—Å–µ—Ç—ã
    ‚îú‚îÄ‚îÄ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ (Star Citizen, MSFS)
    ‚îî‚îÄ‚îÄ Community (GitHub, import JSON)
```

**–§–∞–π–ª—ã:**

1. **Utils/TrafficSniffer.cs** - WinDivert sniffer –¥–ª—è –†–µ–∂–∏–º–∞ 1
2. **Utils/EndpointClassifier.cs** - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è endpoints
3. **Utils/ProfileManager.cs** - –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π
4. **Utils/GitHubProfileLoader.cs** - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ community profiles
5. **Config/BuiltinProfiles.cs** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã (Star Citizen, MSFS)

**star_citizen_targets.json ‚Üí –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—Ä–µ—Å–µ—Ç:**
- `Profiles/StarCitizen.json`
- `Profiles/MSFS.json`
- `Profiles/YouTube.json`

---

## –í–æ–ø—Ä–æ—Å –∫ —Ç–µ–±–µ:

**–î–µ–ª–∞–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç?**

**–ó–ê:**
- ‚úÖ –ë–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ —Ç–æ–ª—å–∫–æ Star Citizen –∏–≥—Ä–æ–∫–∏)
- ‚úÖ –ë–æ–ª—å—à–µ contributors (community profiles)
- ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å (—Å–Ω–∏—Ñ—Ñ–µ—Ä –≤—Å–µ–≥–¥–∞ –¥–∞—ë—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ –ü–æ–ª–µ–∑–µ–Ω –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ª—é–±–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

**–ü–†–û–¢–ò–í:**
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- ‚ùå –ù—É–∂–µ–Ω UI —Ä–µ–¥–∏–∑–∞–π–Ω (—Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã)
- ‚ùå WinDivert —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞
- ‚ùå **WinDivert –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω ‚Üí –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –æ—Ä—É—Ç** (Windows Defender, Kaspersky, etc)
  - –ù—É–∂–Ω–æ –ª–∏–±–æ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä (–¥–æ—Ä–æ–≥–æ, EV Certificate ~$300/–≥–æ–¥)
  - –õ–∏–±–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è "–¥–æ–±–∞–≤—å—Ç–µ –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è"
  - –õ–∏–±–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –±–µ–∑ –¥—Ä–∞–π–≤–µ—Ä–∞

**–ò–ª–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º Star Citizen-only?**

---

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã WinDivert (–±–µ–∑ –¥—Ä–∞–π–≤–µ—Ä–∞):

**1. Npcap/WinPcap** - —Ç–æ–∂–µ –¥—Ä–∞–π–≤–µ—Ä, —Ç–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞

**2. ETW (Event Tracing for Windows)** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ Windows
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
- ‚úÖ –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏
- ‚ùå –¢–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (IP:Port), –Ω–µ—Ç payload
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- ‚ùå **–†–∞–±–æ—Ç–∞–µ—Ç –í–´–®–ï —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–∫–∞** (Transport Layer)
  - –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ **—É—Å–ø–µ—à–Ω—ã–µ** —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ Windows Firewall
  - –ù–ï –≤–∏–¥–∏—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã/–ø–æ—Ä—Ç—ã
  - –ù–ï –≤–∏–¥–∏—Ç low-level –ø—Ä–æ–±–ª–µ–º—ã (RST injection, DPI)
- ‚ö†Ô∏è **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫!**

**3. Process Monitor (Procmon) –ø–æ–¥—Ö–æ–¥**
- –ü–∞—Ä—Å–∏–º network connections —á–µ—Ä–µ–∑ `netstat` –∏–ª–∏ `Get-NetTCPConnection`
- ‚úÖ –ù–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
- ‚ùå –í–∏–¥–∏–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–º–æ–∂–µ–º –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å UDP)
- ‚ùå –ù–µ –≤–∏–¥–∏–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

**4. Windows Firewall API**
- –õ–æ–≥–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Windows Firewall
- ‚úÖ –ù–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ùå –ù–µ—É–¥–æ–±–Ω–æ –ø–∞—Ä—Å–∏—Ç—å –ª–æ–≥–∏

---

### –ü–†–ï–î–õ–ê–ì–ê–ï–ú–û–ï –†–ï–®–ï–ù–ò–ï:

**–ü–†–û–ë–õ–ï–ú–ê –° ETW:**
ETW —Ä–∞–±–æ—Ç–∞–µ—Ç **–í–´–®–ï —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–∫–∞** ‚Üí –Ω–µ –≤–∏–¥–∏—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞!

```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Star Citizen)
    ‚Üì
Socket API (connect, send, recv)
    ‚Üì
[ETW –∑–¥–µ—Å—å] ‚Üê –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è!
    ‚Üì
TCP/IP Stack (Windows)
    ‚Üì
Network Driver
    ‚Üì
[WinDivert –∑–¥–µ—Å—å] ‚Üê –í–∏–¥–∏—Ç –í–°–Å (–¥–∞–∂–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ)!
    ‚Üì
–ü—Ä–æ–≤–∞–π–¥–µ—Ä (DPI, RST injection)
    ‚Üì
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç
```

**–í—ã–≤–æ–¥:** ETW –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫. –ù—É–∂–µ–Ω WinDivert –∏–ª–∏ –∞–Ω–∞–ª–æ–≥ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥—Ä–∞–π–≤–µ—Ä–∞.

---

### –†–ï–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï:

**–í–∞—Ä–∏–∞–Ω—Ç 1: WinDivert + –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞**

**–í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ WinDivert**

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π WinDivert (https://github.com/basil00/WinDivert):
- ‚úÖ **–î—Ä–∞–π–≤–µ—Ä (.sys) –ü–û–î–ü–ò–°–ê–ù** Microsoft-compatible —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
- ‚úÖ Windows –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
- ‚ö†Ô∏è **DLL –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∞** (–Ω–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- ‚ö†Ô∏è **ISP_Audit.exe –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω** (–Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø—Ä–æ–¥—É–∫—Ç, –ø–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ —Å–∞–º–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–ß—Ç–æ –º–æ–∂–µ—Ç —Ä—É–≥–∞—Ç—å—Å—è:**
1. ‚ö†Ô∏è –ê–Ω—Ç–∏–≤–∏—Ä—É—Å—ã (Kaspersky, ESET, Avast) - –¥–µ—Ç–µ–∫—Ç—è—Ç –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é (packet interception)
2. ‚ö†Ô∏è Windows Defender SmartScreen - –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
3. ‚ùå –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã - –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å kernel drivers –ø–æ –ø–æ–ª–∏—Ç–∏–∫–µ

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å ISP_Audit –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞
- ‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ SmartScreen ‚Üí "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" ‚Üí "–í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ"
- ‚úÖ –ó–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (WinDivert —Ç—Ä–µ–±—É–µ—Ç)

**Disclaimer:**
```
‚ö†Ô∏è ISP_Audit –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WinDivert –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤.
   –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
   
   –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫.
   –ê–≤—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏.
   
   –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –æ—Ç–∫—Ä—ã—Ç: github.com/Nafancheg/ISP_Audit
```

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚ö†Ô∏è  –ü–ï–†–í–´–ô –ó–ê–ü–£–°–ö                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ISP_Audit –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WinDivert –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞      ‚îÇ
‚îÇ  —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤. –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å. ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  –≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û - –º—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫.  ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  üìã –ï—Å–ª–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç:                    ‚îÇ
‚îÇ  1. –î–æ–±–∞–≤—å—Ç–µ ISP_Audit –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è              ‚îÇ
‚îÇ  2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫         ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  ‚ÑπÔ∏è  –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –æ—Ç–∫—Ä—ã—Ç –Ω–∞ GitHub               ‚îÇ
‚îÇ     github.com/Nafancheg/ISP_Audit               ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  ‚ö†Ô∏è  –ê–≤—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞          ‚îÇ
‚îÇ     –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏                     ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  [‚úÖ –ü–û–ù–Ø–¢–ù–û, –ü–†–û–î–û–õ–ñ–ò–¢–¨]  [‚ùå –í—ã—Ö–æ–¥]           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–î–µ–π—Å—Ç–≤–∏—è:**
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å WARNING –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ (–æ–¥–∏–Ω —Ä–∞–∑)
- ‚úÖ README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ "–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è"
- ‚úÖ Disclaimer –≤ About: "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫"
- ‚úÖ GitHub badges: "Open Source", "WinDivert-based"
- ‚ùå –ù–ï –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º (–Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç, –Ω–µ –Ω–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞)

---

**–í–∞—Ä–∏–∞–Ω—Ç 2: Netstat –ø–æ–¥—Ö–æ–¥ (–±–µ–∑ deep inspection)**

**–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ WinDivert:**

1. –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º)
2. –û–ø—Ä–∞—à–∏–≤–∞–µ–º `Get-NetTCPConnection` –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
3. –°–æ–±–∏—Ä–∞–µ–º endpoints –∫–æ—Ç–æ—Ä—ã–µ –∏–≥—Ä–∞ –†–ï–ê–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
4. **–¢–µ—Å—Ç–∏—Ä—É–µ–º —ç—Ç–∏ endpoints –æ–±—ã—á–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏** (DNS, TCP connect, traceroute)

**–ö–æ–¥:**
```csharp
var process = Process.GetProcessesByName("StarCitizen").FirstOrDefault();
if (process == null) return;

// PowerShell: Get-NetTCPConnection -OwningProcess PID
var psi = new ProcessStartInfo
{
    FileName = "powershell.exe",
    Arguments = $"-Command \"Get-NetTCPConnection -OwningProcess {process.Id} | Select RemoteAddress, RemotePort\"",
    RedirectStandardOutput = true
};

// –ü–∞—Ä—Å–∏–º –≤—ã–≤–æ–¥ ‚Üí –ø–æ–ª—É—á–∞–µ–º endpoints
// –ó–∞—Ç–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∏—Ö –æ–±—ã—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ (–±–µ–∑ WinDivert)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
- ‚úÖ –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º
- ‚úÖ –í–∏–¥–∏–º –†–ï–ê–õ–¨–ù–´–ï endpoints –∏–≥—Ä—ã

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ –≤–∏–¥–∏–º **–Ω–µ—É–¥–∞—á–Ω—ã–µ** –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚ùå –ù–µ –≤–∏–¥–∏–º UDP (–Ω—É–∂–µ–Ω `Get-NetUDPEndpoint`)
- ‚ùå –í–∏–¥–∏–º —Ç–æ–ª—å–∫–æ **–∞–∫—Ç–∏–≤–Ω—ã–µ** —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–º–æ–∂–µ–º –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ)

**–ù–æ –¥–ª—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ –î–û–°–¢–ê–¢–û–ß–ù–û:**
- –ò–≥—Ä–∞ –ø–æ–¥–∫–ª—é—á–∏–ª–∞—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É ‚Üí –º—ã –≤–∏–¥–∏–º endpoint ‚Üí —Ç–µ—Å—Ç–∏—Ä—É–µ–º –µ–≥–æ
- –ò–≥—Ä–∞ –ù–ï –ø–æ–¥–∫–ª—é—á–∏–ª–∞—Å—å ‚Üí —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Ö–∞—Ä–¥–∫–æ–¥ endpoints (Launcher CDN, AWS, Vivox)

---

### ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï: WinDivert Sniffer

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
ISP_Audit (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)
‚îÇ
‚îú‚îÄ‚îÄ –†–µ–∂–∏–º 1: üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (WinDivert)
‚îÇ   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä EXE –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ –°–Ω–∏—Ñ–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞ 60-120 —Å–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è endpoints (CDN/Game/Voice/API)
‚îÇ   ‚îú‚îÄ‚îÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ endpoint
‚îÇ   ‚îî‚îÄ‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
‚îÇ
‚îú‚îÄ‚îÄ –†–µ–∂–∏–º 2: üåê –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Ö–æ—Å—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ –í–≤–æ–¥ hostname/IP
‚îÇ   ‚îú‚îÄ‚îÄ DNS + TCP + HTTPS + Traceroute
‚îÇ   ‚îî‚îÄ‚îÄ –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
‚îÇ
‚îî‚îÄ‚îÄ –†–µ–∂–∏–º 3: üìã –ü—Ä–µ—Å–µ—Ç—ã (community profiles)
    ‚îú‚îÄ‚îÄ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ (Star Citizen, MSFS)
    ‚îú‚îÄ‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ —Å GitHub
    ‚îî‚îÄ‚îÄ –ò–º–ø–æ—Ä—Ç —Å–≤–æ–µ–≥–æ JSON
```

---

## –†–µ–∂–∏–º 1: –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–µ—Ç–∞–ª—å–Ω–æ)

### GUI Mock:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üîç –ê–ù–ê–õ–ò–ó –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                      ‚îÇ
‚îÇ  –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚ö™ –í—ã–±—Ä–∞—Ç—å EXE —Ñ–∞–π–ª                          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    [üìÅ –û–±–∑–æ—Ä...] –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚ö™ –£–∫–∞–∑–∞—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    [StarCitizen.exe ‚ñº] (–∞–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ)    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚ö™ –í–≤–µ—Å—Ç–∏ —Ö–æ—Å—Ç –≤—Ä—É—á–Ω—É—é (–±–µ–∑ —Å–Ω–∏—Ñ–∏–Ω–≥–∞)        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    [youtube.com              ]  [+]         ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  –ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ—Å–µ—Ç:                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ üöÄ Star Citizen      ‚úàÔ∏è  Microsoft Flight    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ üéØ Call of Duty      üéÆ Apex Legends         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ üì∫ YouTube           üé¨ Netflix              ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–Ω–∏—Ñ–∏–Ω–≥–∞:                                 ‚îÇ
‚îÇ  –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: [60 ‚ñº] —Å–µ–∫—É–Ω–¥                        ‚îÇ
‚îÇ  ‚òë –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ               ‚îÇ
‚îÇ  ‚òë –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å endpoints                       ‚îÇ
‚îÇ  ‚òë –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ —Å–Ω–∏—Ñ–∏–Ω–≥–∞                    ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  [üîç –ù–ê–ß–ê–¢–¨ –ê–ù–ê–õ–ò–ó]                                 ‚îÇ
‚îÇ                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–æ—Ü–µ—Å—Å —Å–Ω–∏—Ñ–∏–Ω–≥–∞:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üîç –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞: StarCitizen.exe                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                      ‚îÇ
‚îÇ  –°—Ç–∞—Ç—É—Å: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö... [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë] 45/60 —Å–µ–∫      ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ endpoints: 23                            ‚îÇ
‚îÇ  ‚îú‚îÄ CDN: 3                                          ‚îÇ
‚îÇ  ‚îú‚îÄ Game Servers: 12                                ‚îÇ
‚îÇ  ‚îú‚îÄ Voice Chat: 2                                   ‚îÇ
‚îÇ  ‚îî‚îÄ Unknown: 6                                      ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ:                             ‚îÇ
‚îÇ  ‚Ä¢ 3.21.45.67:8000 (TCP, 234 –ø–∞–∫–µ—Ç–æ–≤, 1.2 MB)      ‚îÇ
‚îÇ  ‚Ä¢ 3.21.45.67:8001 (TCP, 189 –ø–∞–∫–µ—Ç–æ–≤, 890 KB)      ‚îÇ
‚îÇ  ‚Ä¢ 52.123.45.78:3478 (UDP, 456 –ø–∞–∫–µ—Ç–æ–≤, 234 KB)    ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  [‚è∏ –ü–ê–£–ó–ê]  [‚èπ –û–°–¢–ê–ù–û–í–ò–¢–¨]                         ‚îÇ
‚îÇ                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–Ω–∏—Ñ–∏–Ω–≥–∞:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω                                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                      ‚îÇ
‚îÇ  –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 23 endpoints –∑–∞ 60 —Å–µ–∫—É–Ω–¥                ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  üì¶ CDN (3):                                         ‚îÇ
‚îÇ  ‚úÖ install.robertsspaceindustries.com (151.101.2.3) ‚îÇ
‚îÇ     TCP:443 - 1234 –ø–∞–∫–µ—Ç–æ–≤, 5.6 MB                  ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  üéÆ Game Servers (12):                               ‚îÇ
‚îÇ  ‚úÖ 3.21.45.67:8000 - 234 –ø–∞–∫–µ—Ç–æ–≤, 1.2 MB           ‚îÇ
‚îÇ  ‚úÖ 3.21.45.67:8001 - 189 –ø–∞–∫–µ—Ç–æ–≤, 890 KB           ‚îÇ
‚îÇ  ‚úÖ 3.21.45.68:8000 - 456 –ø–∞–∫–µ—Ç–æ–≤, 2.3 MB           ‚îÇ
‚îÇ  ... (–ø–æ–∫–∞–∑–∞—Ç—å –µ—â—ë 9)                               ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  üéôÔ∏è Voice Chat (2):                                 ‚îÇ
‚îÇ  ‚úÖ 52.123.45.78:3478 (UDP STUN)                    ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  ‚ùì Unknown (6):                                     ‚îÇ
‚îÇ  ‚ö†Ô∏è  8.8.8.8:53 (DNS)                               ‚îÇ
‚îÇ  ... (–ø–æ–∫–∞–∑–∞—Ç—å –µ—â—ë 5)                               ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  [üß™ –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨ –í–°–ï]  [üíæ –°–û–•–†–ê–ù–ò–¢–¨ –ü–†–û–§–ò–õ–¨]   ‚îÇ
‚îÇ  [üì§ –≠–ö–°–ü–û–†–¢ JSON]        [üîÑ –ü–û–í–¢–û–†–ò–¢–¨ –ê–ù–ê–õ–ò–ó]    ‚îÇ
‚îÇ                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:

**1. Utils/TrafficSniffer.cs** - WinDivert wrapper
```csharp
public class TrafficSniffer
{
    public async Task<List<DiscoveredEndpoint>> SniffProcess(
        int processId, 
        int durationSeconds,
        IProgress<SniffProgress> progress)
    {
        // WinDivert —Ñ–∏–ª—å—Ç—Ä: —Ç–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç—ã –æ—Ç –Ω–∞—à–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
        var filter = $"outbound and processId == {processId}";
        
        using var handle = WinDivertNative.Open(
            filter,
            WinDivertNative.Layer.Network,
            0,
            WinDivertNative.OpenFlags.Sniff);
        
        var endpoints = new ConcurrentDictionary<string, DiscoveredEndpoint>();
        var cts = new CancellationTokenSource(TimeSpan.FromSeconds(durationSeconds));
        
        while (!cts.Token.IsCancellationRequested)
        {
            var packet = new byte[WinDivertNative.MaxPacketSize];
            var addr = new WinDivertNative.Address();
            
            if (!WinDivertNative.WinDivertRecv(handle, packet, (uint)packet.Length, ref addr, out var readLen))
                continue;
            
            var (ip, port, protocol, sni) = ParsePacket(packet, (int)readLen);
            var key = $"{protocol}:{ip}:{port}";
            
            endpoints.AddOrUpdate(key, 
                _ => new DiscoveredEndpoint { IP = ip, Port = port, Protocol = protocol, SNI = sni },
                (_, existing) => { existing.PacketCount++; existing.BytesTransferred += readLen; return existing; });
            
            progress?.Report(new SniffProgress { 
                ElapsedSeconds = (durationSeconds - (int)cts.Token.GetRemainingTime().TotalSeconds),
                EndpointsFound = endpoints.Count 
            });
        }
        
        return endpoints.Values.ToList();
    }
}
```

**2. Utils/EndpointClassifier.cs** - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è endpoints
```csharp
public enum EndpointType
{
    Unknown,
    CDN,           // Launcher/Update servers
    GameServer,    // Game traffic
    VoiceChat,     // Vivox/Teamspeak
    API,           // REST APIs
    Analytics,     // Telemetry
    DNS            // DNS queries
}

public class EndpointClassifier
{
    public EndpointType Classify(string ip, int port, string protocol, string? sni)
    {
        // CDN detection
        if (sni?.Contains("install.") == true || sni?.Contains("cdn.") == true)
            return EndpointType.CDN;
        
        // Game server ports
        if (port >= 8000 && port <= 8020)
            return EndpointType.GameServer;
        if (port >= 64090 && port <= 64094)
            return EndpointType.GameServer;
        
        // Voice chat
        if (port == 3478 || port == 5060 || port == 5061)
            return EndpointType.VoiceChat;
        
        // DNS
        if (port == 53)
            return EndpointType.DNS;
        
        // API (–æ–±—ã—á–Ω–æ HTTPS)
        if (port == 443 && sni?.Contains("api.") == true)
            return EndpointType.API;
        
        return EndpointType.Unknown;
    }
}
```

**3. Utils/ProfileManager.cs** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π
```csharp
public class ProfileManager
{
    public void SaveProfile(string name, List<DiscoveredEndpoint> endpoints)
    {
        var profile = new GameProfile
        {
            Name = name,
            Version = "1.0",
            Updated = DateTime.UtcNow,
            Author = Environment.UserName,
            Targets = endpoints.Select(e => new ProfileTarget
            {
                Name = $"{e.Type} - {e.IP}:{e.Port}",
                IPs = new[] { e.IP },
                TcpPorts = e.Protocol == "TCP" ? new[] { e.Port } : null,
                UdpPorts = e.Protocol == "UDP" ? new[] { e.Port } : null,
                Critical = e.Type == EndpointType.GameServer || e.Type == EndpointType.CDN,
                Type = e.Type.ToString()
            }).ToList()
        };
        
        File.WriteAllText($"Profiles/{name}.json", JsonSerializer.Serialize(profile));
    }
}
```

**4. Wpf/SnifferWindow.xaml** - GUI –¥–ª—è —Å–Ω–∏—Ñ–∏–Ω–≥–∞
```xml
<Window x:Class="IspAudit.Wpf.SnifferWindow"
        Title="–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" Width="600" Height="500">
    <!-- GUI –∏–∑ –º–æ–∫–∞–ø–∞ –≤—ã—à–µ -->
</Window>
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏

–ü–æ—Å–ª–µ —Å–Ω–∏—Ñ–∏–Ω–≥–∞ endpoints ‚Üí —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∏—Ö –æ–±—ã—á–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏:
1. **DnsTest** - –ø—Ä–æ–≤–µ—Ä—è–µ–º DNS —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ —Ö–æ—Å—Ç–æ–≤
2. **TcpTest** - –ø—Ä–æ–≤–µ—Ä—è–µ–º TCP connectivity –∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º –ø–æ—Ä—Ç–∞–º
3. **UdpTest** - –ø—Ä–æ–≤–µ—Ä—è–µ–º UDP endpoints
4. **TracerouteTest** - –º–∞—Ä—à—Ä—É—Ç –¥–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `Utils/TrafficSniffer.cs`
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `Utils/EndpointClassifier.cs`
3. ‚úÖ –°–æ–∑–¥–∞—Ç—å `Utils/ProfileManager.cs`
4. ‚úÖ –°–æ–∑–¥–∞—Ç—å `Wpf/SnifferWindow.xaml` + code-behind
5. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ MainWindow (–∫–Ω–æ–ø–∫–∞ "–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è")
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ—Å–µ—Ç—ã (Star Citizen, MSFS, YouTube, Netflix)
7. ‚úÖ README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –¥–ª—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤

–ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é?

---

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ETW (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è):

**–ù–æ–≤—ã–π —Ñ–∞–π–ª: `Utils/EtwNetworkSniffer.cs`**

```csharp
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Microsoft-Windows-TCPIP ETW provider
// –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞, —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏!

public class EtwNetworkSniffer
{
    public async Task<List<DiscoveredEndpoint>> SniffWithEtw(
        string processName, 
        int durationSeconds = 60)
    {
        // 1. –ù–∞–π—Ç–∏ PID –ø—Ä–æ—Ü–µ—Å—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä "StarCitizen.exe")
        var process = Process.GetProcessesByName(processName).FirstOrDefault();
        if (process == null)
            throw new Exception($"–ü—Ä–æ—Ü–µ—Å—Å {processName} –Ω–µ –Ω–∞–π–¥–µ–Ω");
        
        // 2. –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ ETW events: TCP Connect, UDP Send
        using var session = new TraceEventSession("ISP_Audit_Sniffer");
        session.EnableProvider("Microsoft-Windows-TCPIP");
        
        var endpoints = new Dictionary<string, DiscoveredEndpoint>();
        
        session.Source.Dynamic.All += e =>
        {
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞—à –ø—Ä–æ—Ü–µ—Å—Å
            if (e.ProcessID != process.Id)
                return;
            
            // –ü–∞—Ä—Å–∏–º TCP Connect / UDP Send events
            if (e.EventName == "TcpConnect" || e.EventName == "UdpSend")
            {
                var ip = e.PayloadByName("DestAddress").ToString();
                var port = (int)e.PayloadByName("DestPort");
                var protocol = e.EventName.StartsWith("Tcp") ? "TCP" : "UDP";
                
                var key = $"{protocol}:{ip}:{port}";
                if (!endpoints.ContainsKey(key))
                {
                    endpoints[key] = new DiscoveredEndpoint
                    {
                        IP = ip,
                        Port = port,
                        Protocol = protocol,
                        Type = ClassifyEndpoint(ip, port, protocol)
                    };
                }
                
                endpoints[key].PacketCount++;
            }
        };
        
        // 3. –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ N —Å–µ–∫—É–Ω–¥
        var cts = new CancellationTokenSource(TimeSpan.FromSeconds(durationSeconds));
        await Task.Run(() => session.Source.Process(), cts.Token);
        
        return endpoints.Values.ToList();
    }
}
```

**Nuget –ø–∞–∫–µ—Ç:** `Microsoft.Diagnostics.Tracing.TraceEvent`

‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ETW:**
- –í—Å—Ç—Ä–æ–µ–Ω–æ –≤ Windows (Vista+)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
- –ù–µ —Ä—É–≥–∞–µ—Ç—Å—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å
- –¢—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞ (–∫–∞–∫ –∏ WinDivert)
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è endpoints

‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ ETW:**
- –ù–µ—Ç SNI –∏–∑ TLS handshake (–Ω–æ –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ –ø–æ—Ä—Ç–∞–º)
- –ù–µ—Ç payload (–Ω–æ –Ω–∞–º –∏ –Ω–µ –Ω—É–∂–µ–Ω)
- –ß—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ –∫–æ–¥

---

### –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:

**–†–µ–∂–∏–º 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π): ETW Sniffer**
- –ö–Ω–æ–ø–∫–∞: "üîç –ê–ù–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨ –¢–†–ê–§–ò–ö"
- –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º: ETW (–±–µ–∑ –¥—Ä–∞–π–≤–µ—Ä–∞)
- –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏

**–†–µ–∂–∏–º 2 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π): WinDivert**
- –ö–Ω–æ–ø–∫–∞: "üî¨ –†–ê–°–®–ò–†–ï–ù–ù–´–ô –ê–ù–ê–õ–ò–ó"
- Warning: –¢—Ä–µ–±—É–µ—Ç –¥—Ä–∞–π–≤–µ—Ä, –º–æ–∂–µ—Ç —Ä—É–≥–∞—Ç—å—Å—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å
- –î–∞—ë—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (SNI, timing, payload size)

**–†–µ–∂–∏–º 3 (fallback): netstat**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ—Å–ª–∏ ETW –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ—Å—Ç–æ –æ–ø—Ä–æ—Å –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

–ß—Ç–æ —Å–∫–∞–∂–µ—à—å?

---

---

## üéØ –ë–ê–ó–û–í–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)

### –ü–†–ò–û–†–ò–¢–ï–¢ 1: –í—ã–ª–µ—á–∏—Ç—å DNS üî•
**–ü—Ä–æ–±–ª–µ–º–∞:** DNS - –∫–æ—Ä–µ–Ω—å 80% –ø—Ä–æ–±–ª–µ–º —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é
**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ –£–ø—Ä–æ—Å—Ç–∏—Ç—å DnsTest (—É–±—Ä–∞—Ç—å DoH –∏–∑ –ª–æ–≥–∏–∫–∏)
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "FIX DNS" (1 –∫–ª–∏–∫ ‚Üí Cloudflare 1.1.1.1)
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "ROLLBACK DNS" (–≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ –±—ã–ª–æ)
4. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (VPN - –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ!)

**–§–∞–π–ª—ã:**
- `Tests/DnsTest.cs` - —É–ø—Ä–æ—Å—Ç–∏—Ç—å
- `MainWindow.xaml` - –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
- `MainWindow.xaml.cs` - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Fix/Rollback

---

### –ü–†–ò–û–†–ò–¢–ï–¢ 2: –£–±—Ä–∞—Ç—å —Ç–µ—Å—Ç—ã "—Ö—Ä–µ–Ω –ø–æ–π–º–∏ —á–µ–≥–æ" üóëÔ∏è
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–µ —Ç–æ —á—Ç–æ –Ω—É–∂–Ω–æ
**–†–µ—à–µ–Ω–∏–µ:**
- ‚ùå **–£–ë–†–ê–¢–¨ FirewallTest** - Windows Firewall –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏–≥—Ä—ã (—Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç)
- ‚ùå **–£–ë–†–ê–¢–¨ IspTest** - —á—Ç–æ —ç—Ç–æ –≤–æ–æ–±—â–µ? –ù–µ–ø–æ–Ω—è—Ç–Ω—ã–π —Ç–µ—Å—Ç
- ‚ùå **–£–ë–†–ê–¢–¨ RouterTest** - —Ä–æ—É—Ç–µ—Ä –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏–≥—Ä—ã (–ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç)
- ‚ùå **–£–ë–†–ê–¢–¨ SoftwareTest** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ñ—Ç–∞ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å–µ—Ç–∏
- ‚úÖ **–û–°–¢–ê–í–ò–¢–¨ TcpTest** - –Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ü–†–ê–í–ò–õ–¨–ù–´–ï endpoints (launcher/AWS/Vivox)
- ‚úÖ **–û–°–¢–ê–í–ò–¢–¨ UdpProbeRunner** - UDP –ø–æ—Ä—Ç—ã –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –∏–≥—Ä—ã
- ‚úÖ **–û–°–¢–ê–í–ò–¢–¨ TracerouteTest** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–¥–µ –ø–∞–∫–µ—Ç—ã —Ç–µ—Ä—è—é—Ç—Å—è
- ‚úÖ **–û–°–¢–ê–í–ò–¢–¨ RstHeuristic** - –¥–µ—Ç–µ–∫—Ç–∏—Ç RST injection –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- ‚ö†Ô∏è **HttpTest** - –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º (–Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è DPI –¥–µ—Ç–µ–∫—Ü–∏–∏ TLS)

**–ò—Ç–æ–≥–æ: 5 —Ç–µ—Å—Ç–æ–≤ —É–±—Ä–∞—Ç—å, 4-5 –æ—Å—Ç–∞–≤–∏—Ç—å**

---

### –ü–†–ò–û–†–ò–¢–ï–¢ 3: –î–æ–±–∞–≤–∏—Ç—å —Å–Ω–∏—Ñ–µ—Ä üîç
**–ü—Ä–æ–±–ª–µ–º–∞:** –•–∞—Ä–¥–∫–æ–¥ —Ö–æ—Å—Ç–æ–≤ —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç, –Ω–µ –≤–∏–¥–∏–º —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ê–ù–ê–õ–ò–ó –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø"
- ‚úÖ WinDivert —Å–Ω–∏—Ñ—Ñ–µ—Ä (60 —Å–µ–∫ ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç endpoints ‚Üí —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∏—Ö)
- ‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è endpoints (CDN, Game, Voice, API)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—Ñ–∏–ª—è (JSON –¥–ª—è community)
- ‚úÖ Disclaimer –ø—Ä–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã (open source, –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫)

**–§–∞–π–ª—ã:**
- `Utils/TrafficSniffer.cs` - WinDivert wrapper
- `Utils/EndpointClassifier.cs` - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
- `Utils/ProfileManager.cs` - save/load profiles
- `Wpf/SnifferWindow.xaml` - GUI

---

## –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):

### –®–ê–ì 1: DNS Fix (–±—ã—Å—Ç—Ä–æ, –∫—Ä–∏—Ç–∏—á–Ω–æ) ‚ö°
**–í—Ä–µ–º—è:** 2-3 —á–∞—Å–∞
**–§–∞–π–ª—ã:**
1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å `Tests/DnsTest.cs`
2. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ `MainWindow.xaml`
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `FixDnsButton_Click` –≤ `MainWindow.xaml.cs`
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `ResetDnsButton_Click` –≤ `MainWindow.xaml.cs`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1 –∫–ª–∏–∫–æ–º —Ñ–∏–∫—Å–∏—Ç DNS ‚Üí 80% –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω—ã

---

### –®–ê–ì 2: –ó–∞—á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞ (–±—ã—Å—Ç—Ä–æ, —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥) üóëÔ∏è
**–í—Ä–µ–º—è:** 1-2 —á–∞—Å–∞
**–§–∞–π–ª—ã:**
1. –£–¥–∞–ª–∏—Ç—å `Tests/FirewallTest.cs`
2. –£–¥–∞–ª–∏—Ç—å `Tests/IspTest.cs`
3. –£–¥–∞–ª–∏—Ç—å `Tests/RouterTest.cs`
4. –£–¥–∞–ª–∏—Ç—å `Tests/SoftwareTest.cs`
5. –£–±—Ä–∞—Ç—å –∏—Ö –∏–∑ `AuditRunner.cs`
6. –£–±—Ä–∞—Ç—å –∏—Ö –∏–∑ GUI

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ–¥ –ø—Ä–æ—â–µ, —Ç–µ—Å—Ç—ã –ø–æ–Ω—è—Ç–Ω–µ–µ, –Ω–µ—Ç "—à—É–º–∞"

---

### –®–ê–ì 3: –ò—Å–ø—Ä–∞–≤–∏—Ç—å TcpTest (–∫—Ä–∏—Ç–∏—á–Ω–æ) üéØ
**–í—Ä–µ–º—è:** 2-3 —á–∞—Å–∞
**–§–∞–π–ª—ã:**
1. –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å `star_citizen_targets.json` (—É–±—Ä–∞—Ç—å –ø–æ—Ä—Ç–∞–ª, –¥–æ–±–∞–≤–∏—Ç—å launcher/AWS/Vivox)
2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `critical: bool` –≤ `TargetModels.cs`
3. –£–±—Ä–∞—Ç—å early-exit –¥–ª—è critical –≤ `AuditRunner.cs`
4. –£—á–∏—Ç—ã–≤–∞—Ç—å `critical` –≤ `ReportWriter.cs` (playable verdict)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ—Å—Ç–∏—Ä—É–µ–º –¢–û —á—Ç–æ –Ω—É–∂–Ω–æ –∏–≥—Ä–µ, –∞ –Ω–µ –ø–æ—Ä—Ç–∞–ª

---

### –®–ê–ì 4: –î–æ–±–∞–≤–∏—Ç—å —Å–Ω–∏—Ñ—Ñ–µ—Ä (–¥–æ–ª–≥–æ, –Ω–æ –º–æ—â–Ω–æ) üîç
**–í—Ä–µ–º—è:** 8-10 —á–∞—Å–æ–≤
**–§–∞–π–ª—ã:**
1. –°–æ–∑–¥–∞—Ç—å `Utils/TrafficSniffer.cs`
2. –°–æ–∑–¥–∞—Ç—å `Utils/EndpointClassifier.cs`
3. –°–æ–∑–¥–∞—Ç—å `Utils/ProfileManager.cs`
4. –°–æ–∑–¥–∞—Ç—å `Wpf/SnifferWindow.xaml` + code-behind
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `MainWindow` (–∫–Ω–æ–ø–∫–∞ "–ê–Ω–∞–ª–∏–∑")
6. –î–æ–±–∞–≤–∏—Ç—å disclaimer –ø—Ä–æ WinDivert/–∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ª—é–±–æ–π –∏–≥—Ä—ã/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## –û–ü–¶–ò–û–ù–ê–õ–¨–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–ø–æ—Ç–æ–º):

- üìã Community profiles (GitHub releases)
- üåê –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Ö–æ—Å—Ç–∞ (–±–µ–∑ —Å–Ω–∏—Ñ–∏–Ω–≥–∞)
- üéÆ –ü—Ä–µ—Å–µ—Ç—ã –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–≥—Ä (MSFS, Warzone, etc)
- üî¨ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (payload, timing)

---

## –°–¢–ê–¢–£–°:

‚úÖ **–û–±—Å—É–∂–¥–µ–Ω–æ –∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:**
- DnsTest: —É–ø—Ä–æ—Å—Ç–∏—Ç—å + Fix DNS button
- TcpTest: –ø—Ä–æ–≤–µ—Ä—è—Ç—å game endpoints –Ω–µ portal
- –£–±—Ä–∞—Ç—å: FirewallTest, IspTest, RouterTest, SoftwareTest
- –î–æ–±–∞–≤–∏—Ç—å: WinDivert —Å–Ω–∏—Ñ—Ñ–µ—Ä

‚ùå **–ï—â—ë –Ω–µ –æ–±—Å—É–¥–∏–ª–∏:**
- HttpTest - –Ω—É–∂–µ–Ω –ª–∏? (—Ç–æ–ª—å–∫–æ –¥–ª—è DPI –¥–µ—Ç–µ–∫—Ü–∏–∏ TLS?)
- UdpProbeRunner - –ø–æ—Ä—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ?
- TracerouteTest - –º–∞—Ä—à—Ä—É—Ç –∫ —á–µ–º—É?
- RstHeuristic - —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏?

**–í–û–ü–†–û–°:** –ù–∞—á–∏–Ω–∞–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –®–ê–ì 1 (DNS Fix) –∏–ª–∏ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–∫–æ–Ω—á–∏–º –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ç–µ—Å—Ç–æ–≤?

---

## üöÄ –ì–û–¢–û–í–û –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

–í—Å–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.
–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Coding Agent —á–µ—Ä–µ–∑ –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç—Å–∫—É—é —Å—Ö–µ–º—É.

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:**
```powershell
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
.\agents\new_task.ps1
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –≤ `agents/runs/` —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏ –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤.

---

