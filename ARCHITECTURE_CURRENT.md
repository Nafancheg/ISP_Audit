# ISP_Audit ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ü–ª–∞–Ω –†–∞–±–æ—Ç

**–î–∞—Ç–∞:** 01.12.2025  
**–¶–µ–ª—å:** –û–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (DPI, DNS-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, TCP RST injection)  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ ‚Äî bypass –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –¥–µ—Ç–µ–∫—Ü–∏—è –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–∞—è

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

### –ß–∞—Å—Ç—å I: –ß–¢–û –ß–ò–ù–ò–¢–¨ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)
1. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã](#1-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã)
2. [–ü–ª–∞–Ω —Ä–∞–±–æ—Ç (–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)](#2-–ø–ª–∞–Ω-—Ä–∞–±–æ—Ç)
3. [–ü—Ä–∏–Ω—è—Ç—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è](#3-–ø—Ä–∏–Ω—è—Ç—ã–µ-—Ä–µ—à–µ–Ω–∏—è)

### –ß–∞—Å—Ç—å II: –ö–ê–ö –£–°–¢–†–û–ï–ù–û (–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
4. [–û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#4-–æ–±—â–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
5. [Bypass —Å–∏—Å—Ç–µ–º–∞](#5-bypass-—Å–∏—Å—Ç–µ–º–∞)
6. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–µ—Ç–µ–∫—Ü–∏—è](#6-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–¥–µ—Ç–µ–∫—Ü–∏—è)
7. [UI –∏ ViewModel](#7-ui-–∏-viewmodel)
8. [–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥](#8-—Ñ–∞–π–ª–æ–≤–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

---

# –ß–∞—Å—Ç—å I: –ß–¢–û –ß–ò–ù–ò–¢–¨

## 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ü–†–û–ë–õ–ï–ú–ê #1: Bypass –ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏

**–°—É—Ç—å:** Pipeline —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç —Ö–æ—Å—Ç—ã, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –í–´–ë–ò–†–ê–ï–¢ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é... –Ω–æ –ù–ï –ü–†–ò–ú–ï–ù–Ø–ï–¢ –µ—ë!

```
–¢–µ–∫—É—â–∏–π flow:
HostDiscovered ‚Üí TesterWorker ‚Üí ClassifierWorker ‚Üí UiWorker ‚Üí "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: TLS_FRAGMENT"
                                                              ‚Üë
                                                    –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è!
```

**–ö–æ–¥ –ø—Ä–æ–±–ª–µ–º—ã (LiveTestingPipeline.cs):**
```csharp
// –°–æ–∑–¥–∞—ë—Ç—Å—è, –Ω–æ –ù–ò–ö–û–ì–î–ê –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:
_bypassEnforcer = new WinDivertBypassEnforcer(_bypassManager, _tester, progress);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ï—Å–ª–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤–∫–ª—é—á—ë–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (Fragment + DROP_RST) –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ ‚Äî —Å–∞–π—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Disorder", –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

**–†–µ—à–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `BypassCoordinator` (—Å–º. –ü–ª–∞–Ω —Ä–∞–±–æ—Ç #1)

---

### üî¥ –ü–†–û–ë–õ–ï–ú–ê #2: –î–µ—Ç–µ–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ ‚Äî –ù–ê –ê–í–û–°–¨

**–°—É—Ç—å:** ISP_Audit –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∞—è –≥–ª–∞–≤–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã DPI.

| –ú–µ—Ç–æ–¥ –¥–µ—Ç–µ–∫—Ü–∏–∏ | ISP_Audit | Zapret | –í–∞–∂–Ω–æ—Å—Ç—å |
|----------------|-----------|--------|----------|
| **TCP Retransmissions** | ‚ùå | ‚úÖ | üî¥ **–ì–õ–ê–í–ù–´–ô** |
| **HTTP redirect detect** | ‚ùå | ‚úÖ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **RST packet inspection** | ‚ùå | ‚úÖ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **Fail counter + time window** | ‚ùå | ‚úÖ | üü° –°—Ä–µ–¥–Ω—è—è |
| TCP RST (socket error) | ‚úÖ | ‚úÖ | ‚úÖ |
| TLS handshake fail | ‚úÖ | ‚úÖ | ‚úÖ |

**–ö–∞–∫ ISP_Audit –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç (StandardHostTester.cs):**
```csharp
// –¢–æ–ª—å–∫–æ socket exceptions –∏ fixed timeout 3—Å–µ–∫
catch (SocketException ex) {
    if (ex.SocketErrorCode == ConnectionReset) blockageType = "TCP_RST";
}
var completedTask = await Task.WhenAny(connectTask, Task.Delay(3000));
```

**–ö–∞–∫ Zapret –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç (–≥–ª–∞–≤–Ω–æ–µ):**
```c
// Retransmissions ‚Äî –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å = DPI –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª
if (ctrack->req_retrans_counter >= threshold) auto_hostlist_failed(hostname);
// HTTP redirect –Ω–∞ –¥—Ä—É–≥–æ–π –¥–æ–º–µ–Ω = DPI –∑–∞–≥–ª—É—à–∫–∞
if (HttpReplyLooksLikeDPIRedirect(payload, hostname)) bFail = true;
```

**–†–µ—à–µ–Ω–∏–µ:** –°–º. –ü–ª–∞–Ω —Ä–∞–±–æ—Ç #3

---

### üî¥ –ü–†–û–ë–õ–ï–ú–ê #3: –ú–µ—Ç–æ–¥—ã –æ–±—Ö–æ–¥–∞ ‚Äî 20% –æ—Ç Zapret

**–°—É—Ç—å:** ISP_Audit —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–∏–Ω–∏–º—É–º –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ö–æ–¥–∞.

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | ISP_Audit | GoodbyeDPI/Zapret |
|-----------|-----------|-------------------|
| TCP RST drop | ‚úÖ | ‚úÖ |
| TLS Fragment/Disorder | ‚úÖ | ‚úÖ |
| Fake TTL | ‚úÖ –±–∞–∑–æ–≤–æ | ‚úÖ —Å autottl |
| Bad checksum/seq | ‚ùå | ‚úÖ |
| HTTP Host tricks | ‚ùå | ‚úÖ |
| QUIC obfuscation | ‚ùå | ‚úÖ |
| Hostlist —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è | ‚ùå | ‚úÖ |
| Auto-hostlist | ‚ùå | ‚úÖ |

**–†–µ—à–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GoodbyeDPI/Zapret –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ WinDivertBypassManager (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Äî —Å–Ω–∞—á–∞–ª–∞ –ø–æ—á–∏–Ω–∏—Ç—å —Ç–æ —á—Ç–æ –µ—Å—Ç—å)

---

### üü° –ü–†–û–ë–õ–ï–ú–ê #4: –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥ (~30% –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|--------|----------|
| `BypassCoordinator` | –ù–∞–ø–∏—Å–∞–Ω, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | **–ò–ù–¢–ï–ì–†–ò–†–û–í–ê–¢–¨** |
| `WinDivertBypassEnforcer` | –°–æ–∑–¥–∞—ë—Ç—Å—è, –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | **–ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨** |
| `FixHistory` + UI –æ—Ç–∫–∞—Ç | UI —É–¥–∞–ª—ë–Ω, –∫–æ–¥ –æ—Å—Ç–∞–ª—Å—è | **–£–î–ê–õ–ò–¢–¨** |
| `GameProfile` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ | –°–æ–∑–¥–∞—ë—Ç—Å—è, –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è | **–£–î–ê–õ–ò–¢–¨** |
| CLI –∫–æ–¥ (AuditRunner, Config.ParseArgs) | Legacy | **–£–î–ê–õ–ò–¢–¨** |
| `Output/` –ø–∞–ø–∫–∞ | CLI –æ—Ç—á—ë—Ç—ã | **–£–î–ê–õ–ò–¢–¨** |
| Flow/Socket WinDivert layers | –ú—ë—Ä—Ç–≤—ã–π –ø—Ä–∏ AutoBypass=true | **–í–ö–õ–Æ–ß–ò–¢–¨ Socket** |

---

## 2. –ü–ª–∞–Ω —Ä–∞–±–æ—Ç

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–ë–õ–û–ö–ï–†)

#### #1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è BypassCoordinator ‚è±Ô∏è 4-6—á
**–¶–µ–ª—å:** Bypass –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ó–∞–¥–∞—á–∏:**
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `LiveTestingPipeline` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `BypassCoordinator`
- [ ] –ü–æ—Å–ª–µ `ClassifierWorker` –≤—ã–∑—ã–≤–∞—Ç—å `BypassCoordinator.AutoFixAsync(host, testResult)`
- [ ] –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø—Ä–æ–±—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –∫–µ—à–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç–∞—é—â–∏–µ
- [ ] –¢–µ—Å—Ç—ã: YouTube, Discord, rutracker

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Ü–µ–ª–µ–≤–∞—è):**
```
TrafficAnalyzer ‚îÄ‚îÄ‚ñ∂ BypassCoordinator ‚îÄ‚îÄ‚ñ∂ UI/Progress
    (—Å–±–æ—Ä)              (–ú–û–ó–ì)
                          ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚ñº                ‚ñº                ‚ñº
   HostTester      Classifier      BypassManager
   (TCP/TLS)      (—Ç–∏–ø –±–ª–æ–∫-–∫–∏)    (WinDivert)
```

---

#### #2 –£–¥–∞–ª–µ–Ω–∏–µ –º—ë—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞ ‚è±Ô∏è 2—á
**–¶–µ–ª—å:** –ß–∏—Å—Ç–∞—è –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞, –º–µ–Ω—å—à–µ –ø—É—Ç–∞–Ω–∏—Ü—ã

**–£–¥–∞–ª–∏—Ç—å:**
- [ ] `Models/FixHistory.cs` ‚Äî –≤–µ—Å—å —Ñ–∞–π–ª
- [ ] –í `MainViewModel.cs`: `ActiveFixes`, `HasActiveFixes`, `RollbackFixCommand`, `RollbackAllCommand`, `LoadFixHistory()`, `RollbackFixAsync()`, `RollbackAllFixesAsync()`
- [ ] `AuditRunner.cs` ‚Äî –≤–µ—Å—å —Ñ–∞–π–ª
- [ ] `Config.ParseArgs()` –∏ CLI-related –∫–æ–¥
- [ ] `Output/` –ø–∞–ø–∫–∞ ‚Äî –≤—Å—è
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `GameProfile` –≤ `Profiles/{exeName}_{timestamp}.json`
- [ ] –£–¥–∞–ª–∏—Ç—å `RunCliAsync()` –∏–∑ `Program.cs`

---

#### #3 –í–∫–ª—é—á–∏—Ç—å Socket Layer –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚è±Ô∏è 1-2—á
**–¶–µ–ª—å:** –°–æ–±—ã—Ç–∏–π–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–º–µ—Å—Ç–æ polling (—Ç–æ—á–Ω–µ–µ + –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ü—Ä–∏ `AutoBypass=true` (—É–º–æ–ª—á–∞–Ω–∏–µ) FlowMonitor –í–°–ï–ì–î–ê –≤ Watcher (polling) —Ä–µ–∂–∏–º–µ. Flow/Socket WinDivert layers –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è. –ù–û: `Sniff` —Ñ–ª–∞–≥ –ù–ï –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å bypass `None` —Ñ–ª–∞–≥–æ–º!

**–ó–∞–¥–∞—á–∏:**
- [ ] –¢–µ—Å—Ç: –≤–∫–ª—é—á–∏—Ç—å Socket Layer –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å bypass, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç
- [ ] –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Socket –≤–º–µ—Å—Ç–æ polling
- [ ] –£–¥–∞–ª–∏—Ç—å Flow Layer –∫–æ–¥ (`RunMonitorLoop`) ‚Äî –∏–∑–±—ã—Ç–æ—á–µ–Ω –ø—Ä–∏ Socket
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `UseWatcherMode` –ª–æ–≥–∏–∫—É

---

### –§–∞–∑–∞ 2: –£–ª—É—á—à–µ–Ω–∏–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–í–ê–ñ–ù–û)

#### #4 Retransmission tracking ‚è±Ô∏è 4-6—á
**–¶–µ–ª—å:** –ì–ª–∞–≤–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä DPI ‚Äî –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

**–ó–∞–¥–∞—á–∏:**
- [ ] –ß–µ—Ä–µ–∑ WinDivert Sniff layer –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å TCP seq numbers
- [ ] –°—á—ë—Ç—á–∏–∫ —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–π per-host
- [ ] –ü–æ—Ä–æ–≥ (3 —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏) ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `StandardBlockageClassifier`

---

#### #5 HTTP redirect detection ‚è±Ô∏è 2-3—á
**–¶–µ–ª—å:** –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å DPI –∑–∞–≥–ª—É—à–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

**–ó–∞–¥–∞—á–∏:**
- [ ] –ê–Ω–∞–ª–∏–∑ HTTP –æ—Ç–≤–µ—Ç–æ–≤ (Location header)
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º
- [ ] –ï—Å–ª–∏ SLD –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è ‚Üí DPI redirect
- [ ] BlockageType = "HTTP_REDIRECT"

---

#### #6 Fail counter —Å time window ‚è±Ô∏è 1—á
**–¶–µ–ª—å:** –ó–∞—â–∏—Ç–∞ –æ—Ç false positives

**–ó–∞–¥–∞—á–∏:**
- [ ] N —Ñ–µ–π–ª–æ–≤ –∑–∞ M —Å–µ–∫—É–Ω–¥ = –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (default: 3/60)
- [ ] –°–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–∞ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

---

### –§–∞–∑–∞ 3: UX –∏ polish (–ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

#### #7 UI –∏–Ω–¥–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫ bypass ‚è±Ô∏è 1—á
- [ ] –°–æ—Å—Ç–æ—è–Ω–∏–µ `Faulted` –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ UI (–∫—Ä–∞—Å–Ω—ã–π –±–µ–π–¥–∂)
- [ ] Tooltip —Å –ø—Ä–∏—á–∏–Ω–æ–π –æ—à–∏–±–∫–∏

#### #8 OutputType=WinExe ‚è±Ô∏è 5–º–∏–Ω
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –≤ `.csproj` ‚Äî —É–±—Ä–∞—Ç—å –º–µ–ª—å–∫–∞–Ω–∏–µ –∫–æ–Ω—Å–æ–ª–∏

#### #9 Global exception handler ‚è±Ô∏è 30–º–∏–Ω
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ `App.xaml.cs`
- [ ] MessageBox —Å –æ—à–∏–±–∫–æ–π –≤–º–µ—Å—Ç–æ –∫—Ä—ç—à–∞

#### #10 –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –±–µ–∑ –∞–¥–º–∏–Ω –ø—Ä–∞–≤ ‚è±Ô∏è 30–º–∏–Ω
- [ ] –Ø–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"

---

## 3. –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è

### ‚úÖ –†–ï–®–ï–ù–ò–ï: Flow/Socket –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
**–í–∞—Ä–∏–∞–Ω—Ç C: –í–∫–ª—é—á–∏—Ç—å Socket Layer –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å bypass**
- Socket Layer (Sniff+RecvOnly) –ù–ï –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å BypassManager (None)
- –°–æ–±—ã—Ç–∏–π–Ω–∞—è –º–æ–¥–µ–ª—å —Ç–æ—á–Ω–µ–µ polling
- Flow Layer —É–¥–∞–ª–∏—Ç—å ‚Äî –∏–∑–±—ã—Ç–æ—á–µ–Ω –ø—Ä–∏ Socket

### ‚úÖ –†–ï–®–ï–ù–ò–ï: GameProfile
**–£–¥–∞–ª–∏—Ç—å** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥

### ‚úÖ –†–ï–®–ï–ù–ò–ï: BypassCoordinator
**–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å** ‚Äî —É–∂–µ –Ω–∞–ø–∏—Å–∞–Ω, —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É:
- –ü—Ä–æ–±—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏
- –ö–µ—à–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –¥–ª—è —Ö–æ—Å—Ç–æ–≤
- –†–µ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### ‚úÖ –†–ï–®–ï–ù–ò–ï: LiveTestingPipeline
**–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å** ‚Äî —É–±—Ä–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ pipeline –≤–Ω—É—Ç—Ä–∏ TrafficAnalyzer:
- TrafficAnalyzer ‚Üí —Ç–æ–ª—å–∫–æ `IAsyncEnumerable<HostDiscovered>`
- BypassCoordinator –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç
- Pipeline —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è helper –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

# –ß–∞—Å—Ç—å II: –ö–ê–ö –£–°–¢–†–û–ï–ù–û (–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫)

## 4. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```
Program.Main()
‚îú‚îÄ‚îÄ GUI Mode (args.Length == 0)
‚îÇ   ‚îú‚îÄ‚îÄ TryHideConsoleWindow()  ‚Üê –£–î–ê–õ–ò–¢–¨ –ø–æ—Å–ª–µ OutputType=WinExe
‚îÇ   ‚îî‚îÄ‚îÄ new App().Run() ‚Üí MainWindow ‚Üí MainViewModel
‚îÇ
‚îî‚îÄ‚îÄ CLI Mode ‚Üê –£–î–ê–õ–ò–¢–¨ –≤–µ—Å—å CLI –∫–æ–¥
```

### –û—Å–Ω–æ–≤–Ω–æ–π flow –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
```
MainViewModel.RunLivePipelineAsync()
‚îÇ
‚îú‚îÄ‚îÄ 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞
‚îú‚îÄ‚îÄ 2. ScreenState = "running"
‚îú‚îÄ‚îÄ 3. DNS flush
‚îú‚îÄ‚îÄ 4. –°–æ–∑–¥–∞–Ω–∏–µ OverlayWindow
‚îú‚îÄ‚îÄ 5. –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (FlowMonitor, NetworkMonitor, DnsParser, PidTracker)
‚îú‚îÄ‚îÄ 6. –ó–∞–ø—É—Å–∫ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
‚îú‚îÄ‚îÄ 7. Bypass –≤–∫–ª—é—á–µ–Ω–∏–µ (–µ—Å–ª–∏ admin)
‚îú‚îÄ‚îÄ 8. TrafficAnalyzer.AnalyzeProcessTrafficAsync() ‚Üê –ë–õ–û–ö–ò–†–£–Æ–©–ò–ô
‚îú‚îÄ‚îÄ 9. –ó–∞–∫—Ä—ã—Ç–∏–µ overlay
‚îî‚îÄ‚îÄ 10. ScreenState = "done"
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è UI
```
"start"   ‚Üí –Ω–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
"running" ‚Üí –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏–¥—ë—Ç (+ OverlayWindow)
"done"    ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

---

## 5. Bypass —Å–∏—Å—Ç–µ–º–∞

### WinDivertBypassManager

**–°–æ—Å—Ç–æ—è–Ω–∏—è:** `Disabled ‚Üí Enabling ‚Üí Enabled ‚Üí Disabling ‚Üí Disabled` (+ `Faulted`)

**TLS —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
| –°—Ç—Ä–∞—Ç–µ–≥–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| Fragment | –§—Ä–∞–≥–º–µ–Ω—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ 1‚Üí2 |
| Disorder | –§—Ä–∞–≥–º–µ–Ω—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ 2‚Üí1 (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ) |
| Fake | Fake –ø–∞–∫–µ—Ç —Å –∫–æ—Ä–æ—Ç–∫–∏–º TTL |
| FakeFragment | Fake + Fragment |
| FakeDisorder | Fake + Disorder |

**Worker'—ã:**
| Worker | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|--------|-----------|------------|
| RstBlocker | 0 (–≤—ã—Å–æ–∫–∏–π) | –î—Ä–æ–ø–∞–µ—Ç TCP RST –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ |
| TlsFragmenter | 200 (–Ω–∏–∑–∫–∏–π) | –§—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä—É–µ—Ç TLS ClientHello |

**–§–∏–ª—å—Ç—Ä:** –°–µ–π—á–∞—Å –≥–ª–æ–±–∞–ª—å–Ω—ã–π `tcp.DstPort == 443` ‚Äî –≤–ª–∏—è–µ—Ç –Ω–∞ –í–°–ï HTTPS.

### BypassCoordinator (–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø ‚Üí –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–¢–¨)

–£–º–µ–µ—Ç:
- –ü—Ä–æ–±–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏
- –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –¥–ª—è —Ö–æ—Å—Ç–æ–≤
- –†–µ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### WinDivertBypassEnforcer (–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø ‚Üí –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨)

–£–º–µ–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å —Ä–µ—Ç–µ—Å—Ç–æ–º.

---

## 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–µ—Ç–µ–∫—Ü–∏—è

### WinDivert Layers

| Layer | Flags | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|-------|------------|
| Network + Sniff | –¢–æ–ª—å–∫–æ –∫–æ–ø–∏—Ä—É–µ—Ç | DNS –∑–∞—Ö–≤–∞—Ç (NetworkMonitor) |
| Flow + Sniff+RecvOnly | –¢–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç | –°–æ–±—ã—Ç–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø) |
| Socket + Sniff+RecvOnly | –¢–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç | –°–æ–±—ã—Ç–∏—è connect (–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø) |
| Network + None | –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç | RST blocker, TLS fragmenter |

**–ö–ª—é—á–µ–≤–æ–µ:** `Sniff` –ù–ï –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å `None` ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!

### FlowMonitorService

**–î–≤–∞ —Ä–µ–∂–∏–º–∞:**
1. **WinDivert (Socket/Flow)** ‚Äî —Å–æ–±—ã—Ç–∏–π–Ω—ã–π, —Ç–æ—á–Ω—ã–π
2. **IP Helper API polling** ‚Äî –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É, –º–µ–Ω–µ–µ —Ç–æ—á–Ω—ã–π

**–¢–µ–∫—É—â–µ–µ:** –ü—Ä–∏ `AutoBypass=true` (—É–º–æ–ª—á–∞–Ω–∏–µ) –í–°–ï–ì–î–ê polling. WinDivert —Ä–µ–∂–∏–º ‚Äî –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥.

### –î–µ—Ç–µ–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (StandardHostTester + StandardBlockageClassifier)

**BlockageType:**
- `TCP_RST` ‚Äî SocketError.ConnectionReset
- `TCP_TIMEOUT` ‚Äî Task.Delay(3000) –≤—ã–∏–≥—Ä–∞–ª
- `TLS_DPI` ‚Äî AuthenticationException
- `PORT_CLOSED` ‚Äî SocketError.ConnectionRefused
- `FAKE_IP` ‚Äî IP –≤ 198.18.x.x –¥–∏–∞–ø–∞–∑–æ–Ω–µ

**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ (StrategyMapping):**
```
DNS_FILTERED/DNS_BOGUS ‚Üí DOH (—Ä—É—á–Ω–æ–µ)
TcpOk && !TlsOk ‚Üí DROP_RST, TLS_FRAGMENT, TLS_FAKE
!TcpOk && –±—ã—Å—Ç—Ä–æ (<200ms) ‚Üí DROP_RST (RST injection)
!TcpOk && –º–µ–¥–ª–µ–Ω–Ω–æ (>2000ms) ‚Üí PROXY (—Ä—É—á–Ω–æ–µ)
```

---

## 7. UI –∏ ViewModel

### MainViewModel (~2400 —Å—Ç—Ä–æ–∫)

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```csharp
MainViewModel()
‚îú‚îÄ‚îÄ InitializeTestResults()
‚îú‚îÄ‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ LoadFixHistory()  ‚Üê –£–î–ê–õ–ò–¢–¨ (–º—ë—Ä—Ç–≤—ã–π –∫–æ–¥)
‚îú‚îÄ‚îÄ InitializeBypassOnStartupAsync()  // –ê–≤—Ç–æ-–≤–∫–ª—é—á–µ–Ω–∏–µ bypass
‚îî‚îÄ‚îÄ CheckVpnStatus()
```

**–ê–≤—Ç–æ-bypass –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (—Å –∞–¥–º–∏–Ω –ø—Ä–∞–≤–∞–º–∏):**
```csharp
_isFragmentEnabled = true;
_isDropRstEnabled = true;
_isDoHEnabled = true;
await ApplyBypassOptionsAsync();
```

### Bypass Control Panel

| –ö–Ω–æ–ø–∫–∞ | –°–≤–æ–π—Å—Ç–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| Fragment | IsFragmentEnabled | TLS —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è 1‚Üí2 |
| Disorder | IsDisorderEnabled | TLS —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è 2‚Üí1 |
| Fake | IsFakeEnabled | Fake TTL –ø–∞–∫–µ—Ç |
| DROP RST | IsDropRstEnabled | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ TCP RST |
| DoH | IsDoHEnabled | DNS-over-HTTPS |

**Fragment –∏ Disorder –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ** ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç –¥—Ä—É–≥–æ–µ.

---

## 8. –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –¢–µ–∫—É—â–∞—è (—Å –ø–æ–º–µ—Ç–∫–∞–º–∏)
```
ISP_Audit/
‚îú‚îÄ‚îÄ Program.cs                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ App.xaml(.cs)                 # WPF Application
‚îú‚îÄ‚îÄ MainWindow.xaml(.cs)          # –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
‚îú‚îÄ‚îÄ Config.cs                     # ‚ùå –£–î–ê–õ–ò–¢–¨ (CLI legacy)
‚îú‚îÄ‚îÄ AuditRunner.cs                # ‚ùå –£–î–ê–õ–ò–¢–¨ (CLI legacy)
‚îÇ
‚îú‚îÄ‚îÄ ViewModels/
‚îÇ   ‚îî‚îÄ‚îÄ MainViewModel.cs          # –ì–ª–∞–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ
‚îú‚îÄ‚îÄ Bypass/
‚îÇ   ‚îú‚îÄ‚îÄ WinDivertBypassManager.cs # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WinDivert
‚îÇ   ‚îú‚îÄ‚îÄ BypassProfile.cs          # –ü—Ä–æ—Ñ–∏–ª—å bypass
‚îÇ   ‚îú‚îÄ‚îÄ BypassCoordinator.cs      # ‚ö†Ô∏è –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–¢–¨
‚îÇ   ‚îú‚îÄ‚îÄ StrategyMapping.cs        # –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ WinDivertNative.cs        # P/Invoke
‚îÇ
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ Interfaces/
‚îÇ   ‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îî‚îÄ‚îÄ Modules/
‚îÇ       ‚îú‚îÄ‚îÄ StandardHostTester.cs
‚îÇ       ‚îú‚îÄ‚îÄ StandardBlockageClassifier.cs
‚îÇ       ‚îî‚îÄ‚îÄ WinDivertBypassEnforcer.cs  # ‚ö†Ô∏è –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨
‚îÇ
‚îú‚îÄ‚îÄ Utils/
‚îÇ   ‚îú‚îÄ‚îÄ TrafficAnalyzer.cs        # ‚ö†Ô∏è –†–ï–§–ê–ö–¢–û–†–ò–ù–ì (—É–±—Ä–∞—Ç—å pipeline)
‚îÇ   ‚îú‚îÄ‚îÄ LiveTestingPipeline.cs    # ‚ö†Ô∏è –†–ï–§–ê–ö–¢–û–†–ò–ù–ì
‚îÇ   ‚îú‚îÄ‚îÄ FlowMonitorService.cs     # ‚ö†Ô∏è –í–∫–ª—é—á–∏—Ç—å Socket Layer
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îî‚îÄ‚îÄ FixHistory.cs             # ‚ùå –£–î–ê–õ–ò–¢–¨ (–º—ë—Ä—Ç–≤—ã–π –∫–æ–¥)
‚îÇ
‚îú‚îÄ‚îÄ Output/                       # ‚ùå –£–î–ê–õ–ò–¢–¨ (CLI legacy)
‚îÇ
‚îú‚îÄ‚îÄ Profiles/
‚îÇ   ‚îî‚îÄ‚îÄ Default.json              # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ BasicTestTargets.json
‚îÇ
‚îú‚îÄ‚îÄ native/
‚îÇ   ‚îú‚îÄ‚îÄ WinDivert64.sys
‚îÇ   ‚îî‚îÄ‚îÄ WinDivert.dll
‚îÇ
‚îî‚îÄ‚îÄ TestNetworkApp/               # ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
```

### –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏
```
ISP_Audit/
‚îú‚îÄ‚îÄ Program.cs
‚îú‚îÄ‚îÄ App.xaml(.cs)
‚îú‚îÄ‚îÄ MainWindow.xaml(.cs)
‚îÇ
‚îú‚îÄ‚îÄ ViewModels/
‚îÇ   ‚îî‚îÄ‚îÄ MainViewModel.cs
‚îÇ
‚îú‚îÄ‚îÄ Bypass/
‚îÇ   ‚îú‚îÄ‚îÄ WinDivertBypassManager.cs
‚îÇ   ‚îú‚îÄ‚îÄ BypassCoordinator.cs      # ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
‚îÇ   ‚îú‚îÄ‚îÄ BypassProfile.cs
‚îÇ   ‚îú‚îÄ‚îÄ StrategyMapping.cs
‚îÇ   ‚îî‚îÄ‚îÄ WinDivertNative.cs
‚îÇ
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ Interfaces/
‚îÇ   ‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îî‚îÄ‚îÄ Modules/
‚îÇ       ‚îú‚îÄ‚îÄ StandardHostTester.cs
‚îÇ       ‚îú‚îÄ‚îÄ StandardBlockageClassifier.cs
‚îÇ       ‚îî‚îÄ‚îÄ WinDivertBypassEnforcer.cs  # ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
‚îÇ
‚îú‚îÄ‚îÄ Utils/
‚îÇ   ‚îú‚îÄ‚îÄ TrafficAnalyzer.cs        # ‚úÖ –¢–æ–ª—å–∫–æ —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ FlowMonitorService.cs     # ‚úÖ Socket Layer
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ Models/                       # –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å Core/Models?
‚îÇ
‚îú‚îÄ‚îÄ Profiles/
‚îÇ   ‚îî‚îÄ‚îÄ BasicTestTargets.json
‚îÇ
‚îú‚îÄ‚îÄ native/
‚îÇ
‚îî‚îÄ‚îÄ TestNetworkApp/
```

---

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- **–¢—Ä–µ–±—É—é—Ç—Å—è** ‚Äî `app.manifest` —Å–æ–¥–µ—Ä–∂–∏—Ç `requireAdministrator`
- WinDivert –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∞–¥–º–∏–Ω –ø—Ä–∞–≤
- –ë–µ–∑ –∞–¥–º–∏–Ω–∞: bypass –æ—Ç–∫–ª—é—á—ë–Ω, –∫–Ω–æ–ø–∫–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã

### VPN –¥–µ—Ç–µ–∫—Ü–∏—è
```csharp
// NetUtils.LikelyVpnActive() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
// - TAP/TUN –∞–¥–∞–ø—Ç–µ—Ä—ã
// - WireGuard, OpenVPN, IKEv2
// - –ò–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ "vpn"
```

### WinDivert
- –î—Ä–∞–π–≤–µ—Ä `WinDivert64.sys` –≤ `native/`
- –£–¥–∞–ª–µ–Ω–∏–µ: `sc delete WinDivert`

---

## Changelog –¥–æ–∫—É–º–µ–Ω—Ç–∞

| –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| 01.12.2025 | –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –Ω–∞—á–∞–ª–æ, –ø–ª–∞–Ω —Ä–∞–±–æ—Ç, –ø—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è |
| 27.11.2025 | –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å Zapret |
| 27.11.2025 | –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ bypass –º–µ—Ç–æ–¥–æ–≤ —Å GoodbyeDPI/Zapret |
| 27.11.2025 | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã |
