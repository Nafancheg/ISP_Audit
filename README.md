# ISP Audit

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∏–≥—Ä –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**

Windows-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (DPI, DNS, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ TCP-—Å–µ—Å—Å–∏–∏) –∏ –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è. –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º ‚Äî –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏—Ç–µ .exe —Ñ–∞–π–ª.

![.NET 9](https://img.shields.io/badge/.NET-9.0-purple)
![Windows](https://img.shields.io/badge/Windows-10%2F11-blue)
![WinDivert](https://img.shields.io/badge/WinDivert-2.2-orange)
![License](https://img.shields.io/badge/License-MIT-green)

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–í—ã–±–∏—Ä–∞–µ—Ç–µ .exe** –∏–≥—Ä—ã –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. **–ó–∞–ø—É—Å–∫–∞–µ—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É** ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–ù–∞–±–ª—é–¥–∞–µ—Ç–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
4. **–ü–æ–ª—É—á–∞–µ—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç** ‚Äî –∫–∞–∫–∏–µ —Ö–æ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –ø–æ—á–µ–º—É

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

![ISP Audit - –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ](docs/ssh0t.png)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### Live Testing Pipeline
- **–ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞** —á–µ—Ä–µ–∑ WinDivert (Socket + Network layer)
- **SNI-–ø–∞—Ä—Å–∏–Ω–≥** ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –∏–∑ TLS ClientHello
- **DNS-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî –∑–∞—Ö–≤–∞—Ç DNS-–∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ—Å—Ç–æ–≤ –ø–æ –º–µ—Ä–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
- **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è**:
  - **HTTP Redirect** ‚Äî –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ "–∑–∞–≥–ª—É—à–µ–∫" –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
  - **RST Inspection** ‚Äî –∞–Ω–∞–ª–∏–∑ TTL –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è DPI-–∏–Ω–∂–µ–∫—Ç–æ–≤
  - **TCP Retransmissions** ‚Äî –ø–æ–¥—Å—á–µ—Ç –ø–æ—Ç–µ—Ä—å –ø–∞–∫–µ—Ç–æ–≤
  - **Fail Counters** ‚Äî –∞–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º**: `DNS_FILTERED`, `TLS_AUTH_FAILURE` (legacy: `TLS_DPI`), `TCP_CONNECTION_RESET` (legacy: `TCP_RST`), `TCP_CONNECT_TIMEOUT` (legacy: `TCP_TIMEOUT`), `HTTP_REDIRECT_DPI`

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **TrafficEngine 2.0** ‚Äî –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –±–∞–∑–µ Chain of Responsibility
- **Performance Monitoring** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–¥–µ—Ä–∂–µ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ (<0.5ms)
- **TLS Fragmentation** ‚Äî —Ä–∞–∑–±–∏–µ–Ω–∏–µ ClientHello –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **TLS Disorder** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (—É–ª—É—á—à–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- **TLS Fake** ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **RST Drop** ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö TCP RST –ø–∞–∫–µ—Ç–æ–≤
- **DoH (DNS-over-HTTPS)** ‚Äî –∑–∞—â–∏—â—ë–Ω–Ω—ã–π DNS —á–µ—Ä–µ–∑ Cloudflare/Google/Quad9

### –û—Ç—á—ë—Ç–Ω–æ—Å—Ç—å
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (JSON)
- –ü–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –≤ `Logs/isp_audit_*.log`
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —Ö–æ—Å—Ç—ã ‚úì/‚ùå, –∑–∞–¥–µ—Ä–∂–∫–∏, —Ç–∏–ø—ã –ø—Ä–æ–±–ª–µ–º

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ì–æ—Ç–æ–≤—ã–π exe (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –°–∫–∞—á–∞–π—Ç–µ `ISP_Audit.exe` –∏–∑ [Releases](https://github.com/Nafancheg/ISP_Audit/releases)
2. –°–∫–∞—á–∞–π—Ç–µ [WinDivert 2.2](https://github.com/basil00/Divert/releases) –∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ `WinDivert64.sys` –∏ `WinDivert.dll` —Ä—è–¥–æ–º —Å exe
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ **–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è WinDivert)

### –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

```powershell
# –¢—Ä–µ–±—É–µ—Ç—Å—è .NET 9 SDK
git clone https://github.com/Nafancheg/ISP_Audit.git
cd ISP_Audit

# –°–∫–∞—á–∞–π—Ç–µ WinDivert 2.2 –∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ –≤ native/
# - native/WinDivert64.sys
# - native/WinDivert.dll

# –°–æ–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω—É–∂–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
cd TestNetworkApp
dotnet publish -c Release -r win-x64 --self-contained false -o bin/Publish
cd ..

# Debug
dotnet build

# Release single-file
dotnet publish -c Release -r win-x64 /p:PublishSingleFile=true /p:SelfContained=true -o ./publish
```

### TestNetworkApp (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
–¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã ISP Audit:
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ 7 –∏–∑–≤–µ—Å—Ç–Ω—ã–º —Ö–æ—Å—Ç–∞–º (Google, YouTube, Discord, GitHub –∏ –¥—Ä.)
- –†–∞–±–æ—Ç–∞–µ—Ç 60 —Å–µ–∫—É–Ω–¥ —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞

```powershell
# –°–±–æ—Ä–∫–∞
cd TestNetworkApp
dotnet publish -c Release -r win-x64 --self-contained false -o bin/Publish

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –≤ ISP Audit –≤—ã–±–µ—Ä–∏—Ç–µ TestNetworkApp\bin\Publish\TestNetworkApp.exe
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### GUI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```powershell
# –ó–∞–ø—É—Å–∫ GUI
.\ISP_Audit.exe

# –∏–ª–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
dotnet run
```

1. –ù–∞–∂–º–∏—Ç–µ **–û–±–∑–æ—Ä** –∏ –≤—ã–±–µ—Ä–∏—Ç–µ .exe —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ù–∞–∂–º–∏—Ç–µ **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É**
3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ ‚Äî ISP Audit –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –≤ —Ñ–æ–Ω–µ
5. –ó–∞–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ **–°—Ç–æ–ø** ‚Äî –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### Overlay (–º–∏–Ω–∏-–æ–∫–Ω–æ)
–í–æ –≤—Ä–µ–º—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω:
- –í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ö–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
- –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `Profiles/{AppName}_{timestamp}.json`
- –õ–æ–≥ —Å–µ—Å—Å–∏–∏ –≤ `Logs/isp_audit_vm_{timestamp}.log`

## –¢–∏–ø—ã –ø—Ä–æ–±–ª–µ–º

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –†–µ—à–µ–Ω–∏–µ |
|--------|----------|--------|
| `TLS_AUTH_FAILURE` (legacy: `TLS_DPI`) | –û—à–∏–±–∫–∞ TLS —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è (AuthenticationException) | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è (–ø—Ä–æ–∫—Å–∏/–∞–Ω—Ç–∏–≤–∏—Ä—É—Å/—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è); —á–∞—Å—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç VPN |
| `TLS_HANDSHAKE_TIMEOUT` (legacy: `TLS_TIMEOUT`) | TLS —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ —Ç–∞–π–º–∞—É—Ç | VPN / –ø—Ä–æ–∫—Å–∏ |
| `TCP_CONNECTION_RESET` (legacy: `TCP_RST`) | –°–±—Ä–æ—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (TCP reset) | DROP_RST |
| `TCP_CONNECT_TIMEOUT` (legacy: `TCP_TIMEOUT`) | TCP connect –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ —Ç–∞–π–º–∞—É—Ç | VPN / –ø—Ä–æ–∫—Å–∏ |
| `DNS_FILTERED` | DNS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç | DoH |
| `DNS_BOGUS` | DNS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π IP | DoH |
| `HTTP_REDIRECT_DPI` | –ü–æ–¥–º–µ–Ω–∞ HTTP-–æ—Ç–≤–µ—Ç–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º | VPN / TTL Trick |
| `TCP_RETRY_HEAVY` | –í—ã—Å–æ–∫–∏–π % —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–π –ø–∞–∫–µ—Ç–æ–≤ | VPN / –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–Ω–∞–ª–∞ |

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph TB
    subgraph UI["üñ•Ô∏è UI Layer"]
        MainVM[MainViewModel]
        BypassCtrl[BypassController]
        TestResults[TestResultsManager]
    end
    
    subgraph Orchestration["üé≠ Orchestration"]
        Orchestrator[DiagnosticOrchestrator]
        Pipeline[LiveTestingPipeline<br/>Channels]
    end
    
    subgraph Core["‚öôÔ∏è Core Logic"]
        Collector[TrafficCollector<br/>Smart Sniffer]
        Filters[NoiseFilter +<br/>UnifiedFilter]
        Tester[StandardHostTester<br/>DNS/TCP/TLS]
        Classifier[Blockage<br/>Classifier]
        StateStore[BlockageStateStore]
    end
    
    subgraph Inspection["üîç Inspection"]
        Inspectors[RST/UDP/Retrans/<br/>Redirect Detectors]
    end
    
    subgraph Network["üåê Network"]
        WinDivert[WinDivert Driver]
        Services[ConnectionMonitor<br/>DnsParser<br/>PidTracker]
        TrafficEngine[TrafficEngine +<br/>BypassFilter]
    end
    
    %% Main Flow
    MainVM --> Orchestrator
    Orchestrator --> Pipeline
    Orchestrator --> Collector
    
    Pipeline -.->|Queue| Tester
    Pipeline -.->|Queue| Classifier
    
    Collector --> Filters
    Filters --> Pipeline
    Tester --> Classifier
    Classifier --> StateStore
    StateStore --> Inspectors
    StateStore --> TestResults
    
    %% Network Layer
    Services --> Collector
    Services --> WinDivert
    Tester -.-> WinDivert
    
    %% Bypass
    BypassCtrl --> TrafficEngine
    TrafficEngine --> WinDivert
    Classifier -.->|Recommendations| BypassCtrl
    
    %% Styling
    classDef ui fill:#1976d2,stroke:#0d47a1,color:#fff
    classDef core fill:#7b1fa2,stroke:#4a148c,color:#fff
    classDef network fill:#388e3c,stroke:#1b5e20,color:#fff
    classDef inspect fill:#f57c00,stroke:#e65100,color:#fff
    
    class MainVM,BypassCtrl,TestResults ui
    class Collector,Filters,Tester,Classifier,StateStore core
    class WinDivert,Services,TrafficEngine network
    class Inspectors inspect
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### üñ•Ô∏è UI Layer
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------|
| MainViewModel | `ViewModels/MainViewModelRefactored.cs` | –ö–æ—Ä–Ω–µ–≤–∞—è ViewModel, —Å–≤—è–∑—ã–≤–∞–µ—Ç UI –∏ –ª–æ–≥–∏–∫—É |
| BypassController | `ViewModels/BypassController.cs` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ –æ–±—Ö–æ–¥–∞ (Bypass) |
| TestResultsManager | `ViewModels/TestResultsManager.cs` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ |

#### üé≠ Orchestration
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------|
| DiagnosticOrchestrator | `ViewModels/DiagnosticOrchestrator.cs` | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ |
| LiveTestingPipeline | `Utils/LiveTestingPipeline.cs` | –ö–æ–Ω–≤–µ–π–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏: Sniffer ‚Üí Tester ‚Üí Classifier |

#### ‚öôÔ∏è Core Logic
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------|
| TrafficCollector | `Utils/TrafficCollector.cs` | –°–±–æ—Ä —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ |
| UnifiedTrafficFilter | `Utils/UnifiedTrafficFilter.cs` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —à—É–º–∞ –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è |
| StandardHostTester | `Core/Modules/StandardHostTester.cs` | –ê–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö–æ—Å—Ç–æ–≤ (DNS, TCP, TLS) |
| BlockageClassifier | `Core/Modules/StandardBlockageClassifier.cs` | –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |
| BlockageStateStore | `Core/Modules/InMemoryBlockageStateStore.cs` | –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –∏—Å—Ç–æ—Ä–∏–∏ |

#### üîç Inspection
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------|
| RstInspectionService | `Core/Modules/RstInspectionService.cs` | –ê–Ω–∞–ª–∏–∑ TCP RST –ø–∞–∫–µ—Ç–æ–≤ (TTL, Flags) |
| HttpRedirectDetector | `Core/Modules/HttpRedirectDetector.cs` | –î–µ—Ç–µ–∫—Ü–∏—è HTTP-–∑–∞–≥–ª—É—à–µ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ |
| TcpRetransmissionTracker | `Core/Modules/TcpRetransmissionTracker.cs` | –ü–æ–¥—Å—á–µ—Ç –ø–æ—Ç–µ—Ä—å –ø–∞–∫–µ—Ç–æ–≤ (Retransmissions) |
| UdpInspectionService | `Core/Modules/UdpInspectionService.cs` | –ê–Ω–∞–ª–∏–∑ UDP —Ç—Ä–∞—Ñ–∏–∫–∞ (QUIC/DTLS) |

#### üåê Network
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------|
| TrafficEngine | `Core/Traffic/TrafficEngine.cs` | –î–≤–∏–∂–æ–∫ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤ (WinDivert wrapper) |
| BypassFilter | `Core/Traffic/Filters/BypassFilter.cs` | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–±—Ö–æ–¥–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞–∫–µ—Ç–æ–≤ |
| ConnectionMonitor | `Utils/ConnectionMonitorService.cs` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–∫–µ—Ç–æ–≤ (WinDivert/IP Helper) |
| DnsParser | `Utils/DnsSnifferService.cs` | –ü–∞—Ä—Å–∏–Ω–≥ DNS-–ø–∞–∫–µ—Ç–æ–≤ –∏ SNI |
| PidTracker | `Utils/PidTrackerService.cs` | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ |

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Windows 10/11 (x64)
- **–ü—Ä–∞–≤–∞**: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–¥–ª—è WinDivert)
- **.NET**: 9.0 (–≤–∫–ª—é—á—ë–Ω –≤ single-file exe)

## FAQ

**Q: –ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞?**  
A: WinDivert ‚Äî —ç—Ç–æ kernel driver –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤. –ë–µ–∑ –∞–¥–º–∏–Ω-–ø—Ä–∞–≤ –æ–Ω –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.

**Q: –í–ª–∏—è–µ—Ç –ª–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?**  
A: –ù–µ—Ç. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ PID).

**Q: –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —ç—Ç–æ?**  
A: –î–∞. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- –ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ ISP Audit

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ "0 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π"?**  
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ `ipconfig /flushdns` –ø–µ—Ä–µ–¥ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π

**Q: Hostname –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–º–µ–Ω–∞ (1e100.net)?**  
A: –≠—Ç–æ reverse-DNS –æ—Ç Google CDN. SNI-–ø–∞—Ä—Å–∏–Ω–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã, –µ—Å–ª–∏ –æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ TLS ClientHello.

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License. –°–º. [LICENSE](LICENSE).

## –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [WinDivert](https://github.com/basil00/Divert) ‚Äî –ø–µ—Ä–µ—Ö–≤–∞—Ç –ø–∞–∫–µ—Ç–æ–≤
- [MaterialDesignInXaml](https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit) ‚Äî UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

